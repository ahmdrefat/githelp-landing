/*
* Main entry file of the application
*/
"use strict";angular.module("GitHelpApp",["templates","Controllers","Services"]).config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0),e.when("/",{templateUrl:"/templates/landing/landing-show.html","public":!0,"private":!1}),e.when("/dashboard",{templateUrl:"/templates/dashboard/dashboard-show.html","public":!1,"private":!0}),e.when("/channels/:permalink",{templateUrl:"/templates/channels/channel-show.html","public":!1,"private":!0}),e.when("/channels",{templateUrl:"/templates/channels/channels-index.html","public":!1,"private":!0}),e.when("/channels/:permalink/:tab_index",{templateUrl:"/templates/channels/channel-show.html","public":!1,"private":!0}),e.when("/channels/:permalink/help_requests/new",{templateUrl:"/templates/help-requests/help-request-new.html","public":!1,"private":!0}),e.when("/channels/:permalink/help_requests/new/:request_type",{templateUrl:"/templates/help-requests/help-request-new.html","public":!1,"private":!0}),e.when("/channels/:permalink/help_requests/:request_number",{templateUrl:"/templates/help-requests/help-request-show.html","public":!1,"private":!0}),e.when("/hackers/:username",{templateUrl:"/templates/hackers/hacker-show.html","public":!0,"private":!0}),e.when("/projects/:fname/:lname",{templateUrl:"/templates/dependencies/dependency-show.html","public":!0,"private":!0}),e.when("/orgs",{templateUrl:"/templates/orgs/orgs-index.html","public":!1,"private":!0}),e.when("/orgs/:permalink",{templateUrl:"/templates/orgs/orgs-show.html","public":!0,"private":!0}),e.when("/orgs/:permalink/support-plans",{templateUrl:"/templates/orgs/support-plans-show.html","public":!0,"private":!0}),e.when("/orgs/:permalink/manager",{templateUrl:"/templates/orgs/manager/org-manager-show.html","public":!1,"private":!0,reloadOnSearch:!1}),e.when("/orgs/:permalink/incoming-requests",{templateUrl:"/templates/orgs/incoming-requests.html","public":!1,"private":!0}),e.when("/explore",{templateUrl:"/templates/pages/explore.html","public":!0,"private":!0}),e.when("/demo-request",{templateUrl:"/templates/pages/demo-request.html","public":!0,"private":!0}),e.when("/configs",{templateUrl:"/templates/configs/configs-show.html","public":!1,"private":!0}),e.when("/contact",{templateUrl:"/templates/pages/contact.html","public":!0,"private":!0}),e.when("/manifesto",{templateUrl:"/templates/pages/manifesto.html","public":!0,"private":!0}),e.when("/terms",{templateUrl:"/templates/pages/terms.html","public":!0,"private":!0}),e.when("/privacy",{templateUrl:"/templates/pages/privacy.html","public":!0,"private":!0}),e.when("/get-support",{templateUrl:"/templates/pages/get-support.html","public":!0,"private":!0}),e.when("/features",{templateUrl:"/templates/pages/features.html","public":!0,"private":!0}),e.when("/admin",{templateUrl:"/templates/admin/admin-dashboard.html","public":!1,"private":!0}),e.when("/admin/help_requests",{templateUrl:"/templates/admin/admin-help-requests.html","public":!1,"private":!0}),e.when("/admin/hackers",{templateUrl:"/templates/admin/admin-hackers.html","public":!1,"private":!0}),e.when("/admin/users",{templateUrl:"/templates/admin/admin-users.html","public":!1,"private":!0}),e.when("/getshirt",{templateUrl:"/templates/pages/t-shirt.html","public":!0,"private":!0}),e.when("/about",{templateUrl:"/templates/pages/about.html","public":!0,"private":!0}),e.when("/cli",{templateUrl:"/templates/pages/cli.html","public":!0,"private":!0}),e.when("/how",{templateUrl:"/templates/pages/how-it-works.html","public":!0,"private":!0}),e.when("/404",{templateUrl:"/templates/pages/404.html"}),e.when("/500",{templateUrl:"/templates/pages/500.html"}),e.otherwise({templateUrl:"/templates/pages/404.html"})}]).config(["$authProvider","CONFIGS",function(e,t){var n=t();e.tokenPrefix="githelp",e.github({url:"/api/sessions",requiredUrlParams:["scope"],redirectUri:n.LOGIN_APP_GITHUB_REDIRECTURI,scope:["user:email"],scopeDelimiter:" ",clientId:n.LOGIN_APP_GITHUB_CLIENT_ID})}]).config(["$httpProvider",function(e){e.interceptors.push(["$rootScope","$q","$location",function(e,t,n){return{request:function(t){return e.loadingTrigger=!0,t},requestError:function(e){return e},response:function(t){return e.loadingTrigger=!1,t},responseError:function(o){return e.loadingTrigger=!1,404==o.status&&n.path("/404").replace(),403==o.status&&e.showCustomToast("This is an unauthorized action, try to login first!"),401==o.status&&(delete localStorage.githelp_token,e.$broadcast("userLoggedOut"),"/api/user"!==o.config.url&&n.path("/")),500==o.status&&n.path("/500").replace(),t.reject(o)}}}])}]).run(["$rootScope","blinkingElement","auth","$location","$mdToast","$routeParams","$window","$mdDialog",function(e,t,n,o,s,a,r,i){e.loadingTrigger=!1,$("#app-loader").css("opacity","0"),setTimeout(function(){$("#app-loader").remove()},500),t.trigger("#cursor"),e.goBack=function(){o.path("/dashboard")},e.isAuthenticated=function(){return n.isAuthenticated()},e.starText="Join now for FREE!",e.clicked=!1,e.authenticate=function(t){var s={};e.starText="Starting...",e.clicked=!0;var r=setTimeout(function(){e.starText="Still starting, please hold on"},3e3);void 0!==a.uuiid&&(s={uuiid:a.uuiid}),n.authenticate(t,s).then(function(t){clearTimeout(r),t.data.hasOwnProperty("error")?(e.starText="Oops! Sorry. Start again!",e.clicked=!1):(o.$$search={},e.$broadcast("userAuthenticated",t),o.path("/dashboard"),e.starText="Join now for FREE!",e.clicked=!1)})},e.$on("$routeChangeStart",function(e,t){var s=n.isAuthenticated();i.hide(),!t["private"]||t["public"]||s?!t["private"]&&t["public"]&&s&&o.path("/dashboard"):o.path("/")}),$("body").flowtype({minimum:500,maximum:1200,minFont:12,maxFont:16,fontRatio:30}),e.toastPosition={bottom:!1,top:!0,left:!0,right:!0},e.getToastPosition=function(){return"top right"},e.showCustomToast=function(t){var n=arguments.length<=1||void 0===arguments[1]?"info":arguments[1];e.toastMessage=t,e.toastType=n,s.show({controller:"ToastCtrl",templateUrl:"/templates/partials/toast.html",hideDelay:8e3,position:e.getToastPosition()})},Mousetrap.bind("?",function(){alert("new request?")})}]),angular.module("Services",["satellizer"]),angular.module("Controllers",["angularMoment","ngRoute","ngMaterial","ngMessages","chart.js","720kb.socialshare","pikaday","firebase","notification",function(){Chart.defaults.global.colours=["#373737","#fe7a15","#4183c4","#46BFBD","#FDB45C","#949FB1","#4D5360"]}]),angular.module("Controllers").controller("LandingCtrl",["$document","$scope","$mdDialog","$templateCache",function(e,t,n,o){e[0].title="GitHelp - Ask the authors",window.scrollTo(0,0),window.onresize||(window.onresize=function(){});var s={showCursor:!0,cursorChar:"_",typeSpeed:100,backSpeed:20,backDelay:500,loop:!0},a={strings:["Googling","IRC","Mailing lists","Code Snippets","Emails"]};$("#tools-wording").typed(_.merge(a,s)),t.scrollMainSection=function(){$.smoothScroll({scrollTarget:"#manifesto",speed:1e3})},t.showVideo=function(e){n.show({template:o.get("/templates/dashboard/partials/video-demo.html"),parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(){$rootScope.selectedFilePath=null},function(){$rootScope.selectedFilePath=null})}}]),angular.module("Controllers").controller("ExploreCtrl",["$document",function(e){e[0].title="Explore - GitHelp"}]),angular.module("Controllers").controller("TShirtCtrl",["$document","$scope","$http","auth",function(e,t,n,o){e[0].title="Get your T-shirt - GitHelp",o.currentUser().then(function(e){t.requested_tshirt=e.requested_tshirt,t.user={shipping_address:{full_name:e.display_name}}}),t.getTshirt=function(e){e?o.currentUser().then(function(e){n.put("/api/users/"+e.id,{user:t.user}).success(function(){t.requested_tshirt=!0})}):t.formSubmitted=!0}}]),angular.module("Controllers").controller("HowCtrl",["$document",function(e){window.scrollTo(0,0),e[0].title="How GitHelp Works - GitHelp"}]),angular.module("Controllers").controller("ConfigsShowCtrl",["$scope","$document","auth","$routeParams","$location",function(e,t,n,o,s){t[0].title="Configs - GitHelp",window.scrollTo(0,0),e.configsTabs=[{text:"General",icon:"fa-cog",templateURL:"/templates/configs/tabs/general-tab.html",isActive:!o.tab||"general"===o.tab},{text:"Syncing",icon:"fa-refresh",templateURL:"/templates/configs/tabs/sync-tab.html",isActive:"syncing"===o.tab},{text:"Private Repos",icon:"fa-lock",templateURL:"/templates/configs/tabs/private-repos-tab.html",isActive:"private_repos"===o.tab}],e.activateConfigsTab=function(t){if(!t.isActive){var n=_.filter(e.configsTabs,function(e){return e.isActive})[0];n.isActive=!1,t.isActive=!0,s.search("tab",t.text.toLowerCase().replace(" ","_"))}},n.currentUser().then(function(t){e.currentUser=t})}]),angular.module("Controllers").controller("ConfigsGeneralTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){s.permalink;r.currentUser().then(function(e){n.currentUser=e}),n.updateCurrentUser=function(t){if(n.actionSubmitted=!0,t&&n.currentUser){var s={display_name:n.currentUser.display_name,email:n.currentUser.email,avatar_url:n.currentUser.avatar_url};o.put("/api/user/",{user:s}).success(function(t){n.actionSubmitted=!1,e.showCustomToast("You've successfully updated your organization info!"),r.currentUser(!0),a.path("/dashboard")}).error(function(t){"Forbidden"===t.error?(e.showCustomToast("You need admin permission for that action."),n.actionSubmitted=!0):(e.showCustomToast("Something went wrong"),n.actionSubmitted=!1)})}else n.actionSubmitted=!1},n.cancelUpdate=function(){a.path("/dashboard")}}]),angular.module("Controllers").controller("ConfigsSyncTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){s.permalink;n.syncChannels=function(e){o.put("/api/configs/sync_channels",{type:e}).success(function(e){a.path("/channels")}).error(function(e){})}}]),angular.module("Controllers").controller("ConfigsPrivateReposTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){s.permalink;n.repoName,n.actionSubmitted=!1,n.submitRepoName=function(t){n.repoName&&2===n.repoName.split("/").length?(n.actionSubmitted=!0,o.post("/api/channels/",{repo_full_name:n.repoName}).success(function(t){a.path("/channels"),e.showCustomToast("You have successfully added a new private repo","success"),n.actionSubmitted=!1}).error(function(t){e.showCustomToast(t.message,"error"),n.actionSubmitted=!1})):e.showCustomToast("You need to enter a valid full repo name!","error")}}]),angular.module("Controllers").controller("AdminHelpRequestsCtrl",["$rootScope","$document","$scope","$http","auth",function(e,t,n,o,s){t[0].title="Admin - GitHelp",s.currentUser().then(function(e){-1!==["ahmdrefat","Azzurrio"].indexOf(e.username)?n.hasPermission=!0:location.href="/"}),o.get("/api/admin/help_requests/").success(function(e){n.helpRequests=e.results})}]),angular.module("Controllers").controller("AdminDashboardCtrl",["$rootScope","$document","$scope","$http","auth",function(e,t,n,o,s){t[0].title="Admin - GitHelp",n.hasPermission=!1,s.currentUser().then(function(e){-1!==["ahmdrefat","Azzurrio"].indexOf(e.username)?n.hasPermission=!0:location.href="/"})}]),angular.module("Controllers").controller("AdminUsersCtrl",["$rootScope","$document","$scope","$http","auth",function(e,t,n,o,s){t[0].title="Admin - GitHelp",s.currentUser().then(function(e){-1!==["ahmdrefat","Azzurrio"].indexOf(e.username)?n.hasPermission=!0:location.href="/"}),o.get("/api/admin/users/").success(function(e){n.users=e.results})}]),angular.module("Controllers").controller("AdminHackersCtrl",["$rootScope","$document","$scope","$http","auth",function(e,t,n,o,s){t[0].title="Admin Hackers - GitHelp",n.hasPermission=!1,s.currentUser().then(function(e){-1!==["ahmdrefat","Azzurrio"].indexOf(e.username)?n.hasPermission=!0:location.href="/"}),o.get("/api/admin/hackers/").success(function(e){n.hackers=e.results})}]),angular.module("Controllers").controller("HackersTabCtrl",["$document","$scope","$http","$routeParams","$location","$timeout","Pages",function(e,t,n,o,s,a,r){function i(e){t.hackers=e,t.canLoadMore=c.canLoadMore(),t.remainingEntries=t.hackers.length+" of "+c.totalDataLength(),t.dataLoaded=!0,t.loading=!1}var l,c;t.hackers=[{name:"loading...",username:"loading...",avatar_url:"/images/logo-3b94897f.png",contributions:[{contrib_percentage:"100",color:"#000000",dependency_name:"loading..."}]},{name:"loading...",username:"loading...",avatar_url:"/images/logo-3b94897f.png",contributions:[{contrib_percentage:"100",color:"#000000",dependency_name:"loading..."}]},{name:"loading...",username:"loading...",avatar_url:"/images/logo-3b94897f.png",contributions:[{contrib_percentage:"100",color:"#000000",dependency_name:"loading..."}]},{name:"loading...",username:"loading...",avatar_url:"/images/logo-3b94897f.png",contributions:[{contrib_percentage:"100",color:"#000000",dependency_name:"loading..."}]}],l=o.permalink,c=r("/api/channels/"+l+"/hackers?"),t.loading=!1,t.dataLoaded=!1,t.canLoadMore=!0,t.searchViewActived=!1,t.remainingEntries="",t.$watch(function(){$('[data-toggle="tooltip"]').tooltip()}),c.getCurrentPages().then(i),t.loadMore=function(){t.loading=!0,t.canLoadMore=!1,c.loadMore().then(i)}}]),angular.module("Controllers").controller("HelpRequestsTabCtrl",["$document","$scope","$http","$routeParams","$location","$timeout","Pages",function(e,t,n,o,s,a,r){var i,l;i=o.permalink,l=r("/api/channels/"+i+"/help_requests"),t.dataLoaded=!1,t.searchViewActived=!1,t.canLoadMore=!1,l.getCurrentPages().then(function(e){t.helpRequests=e,_.each(t.helpRequests,function(e){if("live_session"==e.type){var t=new Date(e.live_session_time);e.sessionDate=t.toDateString()+" @ "+t.toLocaleTimeString()}}),t.canLoadMore=l.canLoadMore(),t.dataLoaded=!0}),t.loadMore=function(){t.loading=!0,t.canLoadMore=!1,0===t.channelTabs&&l.loadMore().then(function(e){t.helpRequests=e,t.canLoadMore=l.canLoadMore(),t.loading=!1})}}]),angular.module("Controllers").controller("LinksTabCtrl",[function(){}]),angular.module("Controllers").controller("ChannelsShowCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth",function(e,t,n,o,s,a,r){function i(){var e,t=arguments.length<=0||void 0===arguments[0]?null:arguments[0];e=t?"/api/channels/"+l+"?branch="+t:"/api/channels/"+l,o.get(e).success(function(e){n.channel=e,!!e.help_requests_count==!1&&(n.channelTabs=1),"Organization"===e.owner.type?n.ownerURL="/orgs/"+e.name.split("/")[0]:n.ownerURL="/channels",r.currentUser().then(function(e){mixpanel.track("Show channel",{username:e.username,channel:s.permalink,date:new Date}),-1!=n.channel.collaborators.indexOf(parseInt(e.id))&&(n.has_permission=!0)})})}var l;window.scrollTo(0,0),n.currentCtrl="channels",n.channelTabs=0,n.has_permission=!1,l=s.permalink,t[0].title=l+" - GitHelp",i(),n.changeBranch=function(e){i(e)},n.newRequest=function(e,t){a.path("/channels/"+e+"/help_requests/new/"+t)}}]),angular.module("Controllers").controller("ChannelsTabCtrl",["$rootScope","$scope","$location","Pages","$timeout","CONFIGS","$notification",function(e,t,n,o,s,a,r){function i(e){if(t.loadingMore=!1,t.dataLoaded=!0,t.channels=e,t.channelsStatus=e.full_data.channels_status,t.total_repos_count=e.full_data.total_repos_count,-1!==["syncing","initializing"].indexOf(t.channelsStatus)){t.$parent.channelsTabIndex;s(function(){l.forceReloadAllData().then(i)},5e3)}t.canLoadMore=l.canLoadMore(),t.remainingEntries=l.remainingEntriesFormatted()}var l;t.channels=[],t.loadingMore=!1,t.canLoadMore=!0,t.dataLoaded=!1,t.remainingEntries="",t.$watch(function(){$('[data-toggle="tooltip"]').tooltip()}),1===t.$parent.channelsTabIndex?(t.tabType="private",l=o("/api/channels?type=private")):(t.tabType="public",l=o("/api/channels?type=public")),l.getCurrentPages().then(i),t.loadMore=function(){t.loadingMore=!0,t.canLoadMore=!1,l.loadMore().then(i)},t.grantAccess=function(){var e,n;0===t.$parent.channelsTabIndex||(e=a().REPOS_APP_GITHUB_CLIENT_ID,n=a().REPOS_APP_GITHUB_REDIRECTURI+"?return_url=channels",location.href="https://github.com/login/oauth/authorize?client_id="+e+"&scope=repo,user&redirect_uri="+n)},t.publicGrantAccess=function(){}}]),angular.module("Controllers").controller("SearchChannelsTabCtrl",["$scope","$location","$timeout","Pages",function(e,t,n,o){function s(e){void 0!==e&&""!==e&&(i&&clearTimeout(i.$$timeoutId),i=n(function(){r=o("/api/channels?search="+e),r.getCurrentPages().then(a)},900))}function a(t){e.loadingMore=!1,e.dataLoaded=!0,e.channels=t,e.noChannels=null==t.total_repos_count,e.noResults=0===t.length,e.canLoadMore=r.canLoadMore(),e.totalDataLength=r.totalDataLength(),e.remainingEntries=r.remainingEntriesFormatted()}var r;e.channels=[],e.loadingMore=!1,e.canLoadMore=!0,e.dataLoaded=!1,e.remainingEntries="",e.$watch(function(){$('[data-toggle="tooltip"]').tooltip()}),s(e.$parent.searchChannelName),e.$parent.$watch("searchChannelName",s),e.loadMore=function(){e.loadingMore=!0,e.canLoadMore=!1,r.loadMore().then(a)};var i}]),angular.module("Controllers").controller("ChannelsIndexCtrl",["$rootScope","$scope","$http","$routeParams","$location","$timeout","Pages","auth","CONFIGS","$mdDialog","$document",function(e,t,n,o,s,a,r,i,l,c,u){window.scrollTo(0,0),u[0].title="Your channels - GitHelp",t.channelsTabIndex=1,t.public_repo_access_granted=!0;var p=["#FFFFFF","#F2F2F2"],d=0;setInterval(function(){var e=p[d];1>d?d+=1:d=0,$(".intro-trigger-box").css("background-color",e)},700);t.$watch(function(){$('[data-toggle="tooltip"]').tooltip()}),i.currentUser().then(function(e){t.currentUser=e});var m=null;t.$watch("searchChannelName",function(e){null===m&&(m=t.channelsTabIndex),void 0!==e&&""!==e?(t.searchViewActived=!0,t.channelsTabIndex=-1):""===e&&(t.searchViewActived=!1,t.channelsTabIndex=m,m=null)}),t.$watch("channelsTabIndex",function(e,n){-1===n&&(t.searchViewActived=!1)}),t.helpRequests=function(e){s.url("/channels/"+e)},t.newRequest=function(e,t){s.path("/channels/"+e+"/help_requests/new/"+t)}}]),angular.module("Controllers").controller("DashboardShowCtrl",["$document","$scope","auth","$http","$notification","$rootScope","$mdDialog","$location","$templateCache",function(e,t,n,o,s,a,r,i,l){e[0].title="Dashboard - GitHelp",window.scrollTo(0,0),n.currentUser().then(function(e){t.currentUser=e,t.subscriptions={},t.subscriptions.active=_.filter(e.subscriptions,function(e){return"active"===e.status}),t.subscriptions.pending=_.filter(e.subscriptions,function(e){return"pending"===e.status}),t.subscriptions.accepted=_.filter(e.subscriptions,function(e){return"accepted"===e.status}),t.subscriptions.archived=_.filter(e.subscriptions,function(e){return"archived"===e.status}),t.subscriptions.declined=_.filter(e.subscriptions,function(e){return"declined"===e.status}),t.private_repo_access_granted="not_authorized"!=e.private_channels_status,t.incomingRequestsForOrgs=_.filter(e.organizations,function(e){return e.provide_support})}),t.startTour=function(){introJs().start()},s.requestPermission().then(function(e){}),t.newRequest=function(e,t){i.path("/channels/"+e+"/help_requests/new/"+t)},t.helpRequest={title:""},t.channelsQuickAccess=function(e,n,o){a.selectedRequestType=n,a.orgSubscriber=o.permalink,t.helpRequest.title&&(a.requestTitle=t.helpRequest.title),r.show({template:l.get("/templates/dashboard/partials/channels-quick-access.html"),parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(){a.selectedRequestType=null},function(){a.selectedRequestType=null})}}]),angular.module("Controllers").controller("ChannelsQuickAccessCtrl",["$scope","$mdDialog","auth","$rootScope","$http","$location",function(e,t,n,o,s,a){e.publicLimit=e.privateLimit=7,o.channelsNames?e.channels=o.channelsNames:s.get("/api/organizations/"+o.orgSubscriber+"/channel_names").success(function(t){o.channelsNames=e.channels=t}).error(function(e){o.showCustomToast("Sorry, something went wrong!")}),e.selectedRequestType=o.selectedRequestType,e.newRequest=function(e){t.hide(),a.path("channels/"+e+"/help_requests/new/"+o.selectedRequestType)},e.showAll=function(t){"public"===t?e.publicLimit=e.channels["public"].length:e.privateLimit=e.channels["private"].length},e.hide=function(){t.hide()}}]),angular.module("Controllers").controller("DashboardHelpRequestsCtrl",["$document","$scope","$http","$routeParams","$location","$timeout","Pages",function(e,t,n,o,s,a,r){var i,l;window.scrollTo(0,0),i=o.permalink,l=r("/api/user/help_requests"),t.dataLoaded=!1,t.searchViewActived=!1,t.canLoadMore=!1,l.getCurrentPages().then(function(e){t.helpRequests=e,t.canLoadMore=l.canLoadMore(),t.dataLoaded=!0}),t.loadMore=function(){t.loading=!0,t.canLoadMore=!1,l.loadMore().then(function(e){t.helpRequests=e,t.canLoadMore=l.canLoadMore(),t.loading=!1})}}]),angular.module("Controllers").controller("HackerShowCtrl",["$rootScope","$document","$scope","$http","$routeParams",function(e,t,n,o,s){window.scrollTo(0,0);var a=s.username;t[0].title=a+" - GitHelp",o.get("/api/hackers/"+a).success(function(e){n.hacker=e})}]),angular.module("Controllers").controller("DependencyShowCtrl",["$rootScope","$document","$scope","$http","$routeParams",function(e,t,n,o,s){var a=s.fname+"___"+s.lname;window.scrollTo(0,0),t[0].title=a.charAt(0).toUpperCase()+a.substring(1)+" - GitHelp",n.dependencyTabs=0,o.get("/api/dependencies/"+a).success(function(e){n.dependency=e}).then(function(){});var r=function(){return Math.round(100*Math.random())},i={labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"StackoverFlow",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:[r(),r(),r(),r(),r(),r(),r()]},{label:"GitHub",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:[r(),r(),r(),r(),r(),r(),r()]},{label:"Email",fillColor:"rgba(15,87,5,0.2)",strokeColor:"rgba(15,87,5,1)",pointColor:"rgba(15,87,5,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(15,87,5,1)",data:[r(),r(),r(),r(),r(),r(),r()]},{label:"IRC",fillColor:"rgba(200,18,56,0.2)",strokeColor:"rgba(200,18,56,1)",pointColor:"rgba(200,18,56,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(200,18,56,1)",data:[r(),r(),r(),r(),r(),r(),r()]}]},l={labels:["StackoverFlow","GitHub","Email","IRC","Forum"],datasets:[{label:"My First dataset",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:[65,59,100,81,56]}]};window.onload=function(){var e=document.getElementById("number-of-requests").getContext("2d");window.myLine=new Chart(e).Line(i,{responsive:!0}),window.myRadar=new Chart(document.getElementById("response-time").getContext("2d")).Radar(l,{responsive:!0})}}]),angular.module("Controllers").controller("SupportRequestsCtrl",["$rootScope","$document","$scope","$http","$routeParams","Pages",function(e,t,n,o,s,a){var r,i;r=s.fname+"___"+s.lname,i=a("/api/dependencies/"+r+"/support_requests"),n.dataLoaded=!1,n.searchViewActived=!1,n.canLoadMore=!1,i.getCurrentPages().then(function(e){n.helpRequests=e,n.canLoadMore=i.canLoadMore(),n.dataLoaded=!0}),n.loadMore=function(){n.loading=!0,n.canLoadMore=!1,i.loadMore().then(function(e){n.helpRequests=e,n.canLoadMore=i.canLoadMore(),n.loading=!1})}}]),angular.module("Controllers").controller("HelpRequestNewCtrl",["$rootScope","$scope","$http","$routeParams","$location","$mdSidenav","$sce","$document","auth","$mdDialog","$templateCache",function(e,t,n,o,s,a,r,i,l,c,u){function p(e){var t,n,o;return n=e.split("/"),o=n.length,t=-1!==[1,2,3].indexOf(o)?e:n[0]+"/../"+n[n.length-2]+"/"+n[n.length-1]}function d(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0];arguments.length<=1||void 0===arguments[1]?null:arguments[1];t.channelLoaded=!1;var a;return a=e?"/api/channels/"+o.permalink+"?branch="+e:"/api/channels/"+o.permalink,n.get(a).success(function(e){t.channel=e,t.channelLoaded=!0,t.selectedBranch=e.current_branch.name,"Organization"===e.owner.type?t.ownerURL="/orgs/"+e.name.split("/")[0]:t.ownerURL="/channels",l.currentUser().then(function(n){t.subscriptions=_.filter(n.subscriptions,function(t){return delete t.selected,"active"!==t.status?!1:e.owner.id===t.subscriber.id?!0:e.fork&&-1!==[e.parent_repo.owner_id,e.source_repo.owner_id].indexOf(t.subscriber.id)?!0:void 0}),0===t.subscriptions.length&&(t.isInternal=!0),-1===t.channel.collaborators.indexOf(parseInt(n.id))&&s.path("/404").replace()})})}var m,h=new Showdown.converter;l.currentUser().then(function(e){if(o.request_type)var t="Start new "+_.capitalize(o.request_type.replace("_"," "));else var t="Start new help request";mixpanel.track(t,{username:e.username,channel:o.permalink,date:new Date})}),window.scrollTo(0,0),t.isInternal=!0,Mousetrap.bind("alt+1",function(){t.selectRequestOption(1),t.$apply()}),Mousetrap.bind("alt+2",function(){t.selectRequestOption(2),t.$apply()}),Mousetrap.bind("alt+3",function(){t.selectRequestOption(3),t.$apply()}),Mousetrap.bind(["command+enter","ctrl+enter"],function(){var e;e=(e=f+1)<6?f+1:0,t.activate_layer(e),t.$apply()}),i[0].title="New help request on Channel "+o.permalink+" GitHelp",t.helpRequest={},t.validationObj={},t.isAllValid=!1,t.selectedDependencies=[],t.previewToggled=!1,t.showAllFormBoxes=!1,e.requestTitle&&(t.helpRequest.title=e.requestTitle,e.requestTitle=null),t.$on("updateSelectedFiles",function(e,n){var o;o=n.length>12?n.splice(12,n.length):[],t.previewSharedFiles=_.map(n.concat(o),function(e){return{full_path:e,shortPath:p(e)}}),t.helpRequest.sharedFiles=n.concat(o),t.sharedFilesCount=t.helpRequest.sharedFiles.length,t.remainingFilesCount=o.length}),t.show_code=function(t,n){e.selectedFilePath=n,c.show({template:u.get("/templates/help-requests/partials/code-view.html"),parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(){},function(){})},t.$on("updateSelectedDependencies",function(e,n){t.selectedDependencies=n,t.helpRequest.dependenciesIds=_.map(n,function(e){return e.id})}),d(o.branch),t.selectedBranchChange=function(e){s.search("branch",e)},t.toggleLeft=function(){a("left").toggle()},t.toggleRight=function(){a("right").toggle()};var g=function(){return t.validationObj={tags:function(){return 0!==t.selectedDependencies.length}},t.isAllValid=_.reduce(t.validationObj,function(e,t){return e()&&t()}),t.isAllValid};t.createHelpRequest=function(a){if(a&&g()){t.formSubmitted=!0;var r={type:t.helpRequest.type,title:t.helpRequest.title,description:t.helpRequest.description,consumption:t.helpRequest.consumption,shared_paths:t.helpRequest.sharedFiles,subscription_id:t.helpRequest.subscriptionID,dependency_ids:t.helpRequest.dependenciesIds,live_session_time:t.helpRequest.sessionFullDate,branch_id:t.channel.current_branch.id};n.post("/api/channels/"+o.permalink+"/help_requests",{help_request:r}).success(function(e){if(o.request_type)var t="Create new "+_.capitalize(o.request_type.replace("_"," "));else var t="Create new help request";mixpanel.track(t,{channel:o.permalink,date:new Date}),s.path("/channels/"+o.permalink+"/help_requests/"+e.number)}).error(function(n){e.showCustomToast("Something went wrong, please try again later!","error"),t.formSubmitted=!1})}else a?e.showCustomToast("Select at least one dependency that related to your question scope!"):e.showCustomToast("Please fill the missing fields!","error")},t.parseDescription=function(){t.previewToggled&&(m=h.makeHtml(t.helpRequest.description||""))},t.togglePreview=function(){t.previewToggled=!t.previewToggled,t.parseDescription()},t.renderedDescription=function(){return r.trustAsHtml(m)},t.cancelNewRequest=function(){history.back()},t.layer_0_active=!0;var f=0,b=null;t.activate_layer=function(e){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1];b&&$(".content-container").length>0&&$("html,body").animate({scrollTop:$(".content-container").offset().top-80}),e!==f&&(t["layer_"+f+"_active"]=!1,t["layer_"+e+"_active"]=!0,f=e,b=n),null!==n&&t.showAllFormBoxes&&$(b)!==[]&&$("html,body").animate({scrollTop:$(n).offset().top-80})},t.switchToActiveLayer=function(){t.showAllFormBoxes&&$(b)!==[]&&setTimeout(function(){$("html,body").animate({scrollTop:$(b).offset().top-80})},200)},t.requestTypeSelected=!1;var v=null;if(t.selectRequestOption=function(e){switch(e=e.toString(),t.requestTypeSelected===!1&&(t.requestTypeSelected=!0),t["selectedRequestOption"+e]=!0,t["selectedRequestOption"+v]=!1,v=e,e){case"1":t.helpRequest.type="question",t.activate_layer(1,".hr-desc-layer");break;case"2":t.helpRequest.type="live_session",t.activate_layer(2,".hr-when-layer"),t.helpRequest.title||(t.helpRequest.title="[Requests For Live Session]");break;case"3":t.helpRequest.type="code_review",t.activate_layer(3,".hr-code-layer"),t.helpRequest.title||(t.helpRequest.title="[Requests For Code Review]")}},o.request_type){var w,C;w=["question","live_session","code_review"],-1!==(C=w.indexOf(o.request_type))&&t.selectRequestOption(C+1)}t.timePickerOptions={onClose:function(){var e=new Date(t.helpRequest.fullTime);t.time=e.toTimeString()}},t.datePickerOptions={onClose:function(){var e=new Date(t.helpRequest.fullDate);t.date=e.toDateString()}},t.switchInternal=function(e){e?(T.selected=!1,T={},t.helpRequest.subscriptionID=null):t.subscriptions.length>0&&t.selectSubscription(t.subscriptions[0])};var T={};t.selectSubscription=function(e){T.id===e.id?(T.selected=!1,e.selected=!1,t.helpRequest.subscriptionID=null,T={}):(T.selected=!1,e.selected=!0,t.helpRequest.subscriptionID=e.id,T=e)},t.updateDate=function(n){var o=new Date,s=new Date(n._d);return s.getFullYear()<=o.getFullYear()&&s.getMonth()<=o.getMonth()&&s.getDate()<o.getDate()?(e.showCustomToast("This is not a valid date!","error"),t.helpRequest.sessionFullDate=null,t.selectedDate=null,t.helpRequest.consumption=null,t.selectedHours=null,t.selectedMinutes=null,t.selectedDate=null,void(t.selectedTime=null)):(t.helpRequest.consumption||(t.helpRequest.consumption=15),t.helpRequest.sessionFullDate=s,t.helpRequest.sessionFullDate.setHours(22),t.helpRequest.sessionFullDate.setMinutes(0),t.helpRequest.sessionFullDate.setSeconds(0),t.selectedHours=t.helpRequest.sessionFullDate.getHours(),t.selectedMinutes=t.helpRequest.sessionFullDate.getMinutes(),t.selectedDate=t.helpRequest.sessionFullDate.toDateString(),void(t.selectedTime=t.helpRequest.sessionFullDate.toLocaleTimeString()))},t.updateHours=function(e){e&&(t.helpRequest.sessionFullDate.setHours(e),t.selectedMinutes=t.helpRequest.sessionFullDate.getMinutes(),t.selectedTime=t.helpRequest.sessionFullDate.toLocaleTimeString())},t.updateMinutes=function(e){e&&(t.helpRequest.sessionFullDate.setMinutes(e),t.selectedHours=t.helpRequest.sessionFullDate.getHours(),t.selectedTime=t.helpRequest.sessionFullDate.toLocaleTimeString())}}]),angular.module("Controllers").controller("HelpRequestShowCtrl",["$document","$scope","$http","$routeParams","$mdSidenav","$sce","$mdDialog","$rootScope","auth","$location","$interval","$templateCache",function(e,t,n,o,s,a,r,i,l,c,u,p){function d(){return o.permalink&&o.request_number?n.get("/api/channels/"+o.permalink+"/help_requests/"+o.request_number):void 0}function m(){var e=_.select(t.helpRequest.selectedFiles,function(e){var n=_.select(t.helpRequest.selectedFiles,function(t){return t.path!=e.path&&-1!==t.path.indexOf(e.path)?!0:!1});return 0===n.length?!0:!1});t.previewSharedFiles=_.sortByOrder(_.map(e,function(e){return{loc:e.loc||0,full_path:e.path,commentsCount:e.comments_count,shortPath:h(e.path)}}),"loc","desc")}function h(e){var t,n,o;return n=e.split("/"),o=n.length,t=-1!==[1,2,3].indexOf(o)?e:n[0]+"/../"+n[n.length-2]+"/"+n[n.length-1]}function g(){$("#show-help-request-container #code-tree").jstree({plugins:["search","types"],
types:{file:{icon:"fa fa-file-o"},folder:{icon:"fa fa-folder-o"}},animation:0,core:{themes:{dots:!1},data:t.helpRequest.shared_tree}})}var f=new Showdown.converter;window.scrollTo(0,0),t.helpRequestShowView=!0,e[0].title="Request #"+o.request_number+" on "+o.permalink+" - GitHelp",t.channelPermalink=o.permalink,t.helpTabIndex=0,t.dataLoaded=!1,t.has_permission=!1,t.helpRequestPromise=d().then(function(e){var n=e.data.collaborators_ids;l.currentUser().then(function(e){t.currentUser=e;var s=parseInt(e.id);mixpanel.track("Show help request",{username:e.username,channel:o.permalink,date:new Date}),(-1!=n.indexOf(s)||e.is_hacker)&&(t.has_permission=!0)}),t.helpRequest=e.data;var s=new Date(e.data.live_session_time);if(t.helpRequest.sessionDate=s.toDateString()+" @ "+s.toLocaleTimeString(),i.currentHelpRequest=e.data,"code_review"===e.data.type&&null===e.data.consumption)var r=u(function(){var e=d();e?e.success(function(e){return null!==e.consumption&&(t.helpRequest=e,m(),u.cancel(r)),e}).error(function(){u.cancel(r)}):u.cancel(r)},2e3);else"question"===e.data.type&&null===e.data.help_response_count&&(t.helpTabIndex=1);var c=new Date(e.data.live_session_time);return t.liveSessionTime=c.toLocaleTimeString(),t.sessionDatePassed=(new Date).getTime()>c.getTime(),g(),e.data.description&&(t.descriptionParsed=a.trustAsHtml(f.makeHtml(e.data.description))),m(),t.dataLoaded=!0,e.data}),t.show_code=function(e,t){i.selectedFilePath=t,r.show({template:p.get("/templates/help-requests/partials/code-view.html"),parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(){i.selectedFilePath=null},function(){i.selectedFilePath=null})},t.toggleLeft=function(){s("left").toggle()},t.close=function(){s("left").close().then(function(){})},t.normalWidth=!1,t.wideWidth=!0,t.resize=function(){t.wideWidth=!t.wideWidth,t.normalWidth=!t.normalWidth},t.launchSessionEnv=function(){r.show({template:p.get("/templates/session-env/session-show.html"),parent:angular.element(document.body),clickOutsideToClose:!1}),i.sessionDialog=r.hide},o.session_env&&t.launchSessionEnv()}]),angular.module("Controllers").controller("HackerResponseCtrl",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(){t.hide()}}]),angular.module("Controllers").controller("CodeViewCtrl",["$rootScope","$scope","$mdDialog","$http","$routeParams","$compile","auth",function(e,t,n,o,s,a,r){function i(e){var n;n='<div class="new-comments-form bg-white border ml p1 col-md-7 col-xs-7">               <textarea class="col-md-12 mb1  pm border2 br3 pl1 pr1 black br3 text-box-shadow" columns="5" name="newComment" ng-model="newComment" placeholder="Leave a comment">               </textarea>               <div class="col-md-12 p0 mtm">                 <button class="md-raised md-black  right m0 md-button" ng-click="hideCommentForm()">                   <i class="fa fa-times"></i>&nbsp;Hide                 </button>                 <button class="md-raised md-primary right mr1 m0 md-button" ng-click="submitComment('+(e+1)+')">                   <i class="fa fa-check"></i>&nbsp;Submit                 </button>               </div>             </div>',g=p.addLineWidget(e,a(n)(t)[0],{insertAt:0,noHScroll:!0,coverGutter:!0})}function l(e,t,n,o){var s=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],a='         <div class="help-response-card bg-white p0  border mll mbs col-md-7 col-xs-7">           <div class="help-response-body">            <div class="text-left p0">               <h5 class="pm border-bottom bg-gray1 pl1 m0">                 <span class="opacity05 mrl right fsi  inline-block ps pointer delete-file-comment" data-id="'+t.id+'" data-line="'+t.line_number+'"><i class="fa fa-times"></i></span>                 <span class="opacity05 mrl right fsi  inline-block ps">#'+(n+1)+'</span>                 <img src="'+t.creator.avatar_url+'" class="small-profile-img">                 <span class="inline-block pl1">                   <span class="fwb">'+t.creator.name+' - </span>                   <span class="fsi opacity05">'+moment(t.created_at).fromNow()+'</span>                 </span>               </h5>               <div class="pm m0">                 <div class="pll">'+t.body+"</div>               </div>             </div>           </div>         </div>";if(o.widget)s?o.widget.node.innerHTML=a+o.widget.node.innerHTML:o.widget.node.innerHTML=o.widget.node.innerHTML+a;else{var r=document.createElement("div");r.innerHTML=a,o.widget=p.addLineWidget(e,r,{noHScroll:!0,coverGutter:!0})}}function c(){var n="/api/help_requests/"+e.currentHelpRequest.id+"/help_responses/",s={file_path:t.file.full_path};return o({method:"GET",url:n,params:s}).success(function(e){_.forEach(e.results,function(e,n){var o=parseInt(_.keys(e)[0]-1);t["helpResponsesOn"+o]=e[_.keys(e)[0]],_.each(t["helpResponsesOn"+o],function(e,n){e.rendered||(l(o,e,n,t["helpResponsesOn"+o]),e.rendered=!0)})})})}t.file=e.selectedFilePath,t.dataLoaded=!1,t.helpResponses=[];var u,p,d=s.permalink,m=s.request_number,h={file_path:t.file.full_path},g=null;u=s.branch?"/api/channels/"+d+"/help_requests/"+m+"/file_content?branch="+s.branch:"/api/channels/"+d+"/help_requests/"+m+"/file_content",o({method:"GET",url:u,params:h}).success(function(o){t.dataLoaded=!0;var s=o.decoded_content.replace(/\s/g,"");if(t.file_content=window.atob(s),!o.found)return e.showCustomToast("This file was deleted on GitHub!","error"),n.hide(),void(e.selectedFilePath=null);if(p=CodeMirror($(".codemirror")[0],{value:t.file_content,tabSize:2,readOnly:"nocursor",gutters:["CodeMirror-linenumbers","comments-number"],fixedGutter:!0,lineWrapping:!0,theme:"ttcn",lineNumbers:!0}),m)var a=setInterval(function(){$(".CodeMirror-gutters")[0]&&(clearInterval(a),c(),p.operation(function(){for(var e=0;e<=p.lineCount();e++){var t=document.createElement("i");t.className="fa fa-plus opacity00 add-comments-button",p.setGutterMarker(e,"comments-number",t)}}))},100);p.on("gutterClick",function(n,o,s,a){if(m){var l=e.currentHelpRequest.collaborators_ids;r.currentUser().then(function(n){t.currentUser=n;var s=parseInt(n.id);-1!=l.indexOf(s)||n.is_hacker?(t.has_permission=!0,p.operation(function(){null===g?i(o):(t.newComment=null,p.removeLineWidget(g),i(o))})):e.showCustomToast("You don't have permission to add comment on this request!")})}})}).error(function(){e.showCustomToast("Something went wrong!"),e.selectedFilePath=null,n.hide()}),$(document).off("click",".delete-file-comment"),$(document).on("click",".delete-file-comment",function(){var n=this;$(this).parents(".help-response-card").hide(),o["delete"]("/api/help_requests/"+e.currentHelpRequest.id+"/help_responses/"+$(this).data("id")).success(function(e){if(1===$(n).parents(".CodeMirror-linewidget").find(".help-response-card").length){$(n).parents(".help-response-card").remove();var o=$(n).data("line")?$(n).data("line")-1:0;p.removeLineWidget(t["helpResponsesOn"+o].widget),$(n).parents(".CodeMirror-linewidget").remove()}else $(n).parents(".help-response-card").remove()}).error(function(t){$(this).parents(".help-response-card").show(),e.showCustomToast("Sorry, Something went wrong!")})}),t.hideCommentForm=function(){g&&(t.newComment=null,p.removeLineWidget(g))},t.submitComment=function(n){if(s.request_number&&(!t.newComment||0!==t.newComment.length)){var a="/api/help_requests/"+e.currentHelpRequest.id+"/help_responses/",r={help_response:{body:t.newComment,line_number:n,file_path:t.file.full_path}};t.actionSubmitted=!0,o.post(a,r).success(function(e){t.actionSubmitted=!1;var n=e.line_number-1;if(t["helpResponsesOn"+n]){t["helpResponsesOn"+n].unshift(e);var o=t["helpResponsesOn"+n].length-1;e.rendered=!0,l(n,e,o,t["helpResponsesOn"+n],!0)}else t["helpResponsesOn"+n]=[e],e.rendered=!0,l(n,e,0,t["helpResponsesOn"+n]);t.hideCommentForm()}).error(function(n){t.actionSubmitted=!1,e.showCustomToast("Sorry, something went wrong!")})}},t.hide=function(){n.hide()},t.cancel=function(){n.cancel()}}]),angular.module("Controllers").controller("CodeTreeCtrl",["$rootScope","$scope","$http","$routeParams","$location","$mdSidenav",function(e,t,n,o,s,a){function r(){$("#new-help-request-container #code-tree").jstree({plugins:["checkbox","search","types"],types:{file:{icon:"fa fa-file-o"},folder:{icon:"fa fa-folder-o"}},animation:0,core:{themes:{dots:!1},data:t.codeTree}}),$("#new-help-request-container #code-tree").on("changed.jstree",function(e,n){var o=_.select(n.selected,function(e){if("/"===e)return!1;var t=_.select(n.selected,function(t){return t!=e&&-1!==t.indexOf(e)?!0:!1});return 0===t.length?!0:!1});t.$emit("updateSelectedFiles",o)})}t.codeTree=[],t.selecttedNode=[];var i;o.branch?(i="api/channels/"+o.permalink+"/tree?branch="+o.branch,t.branchName=o.branch):i="api/channels/"+o.permalink+"/tree",0===t.codeTree.length&&n.get(i).then(function(e){t.codeTree=e.data,r()}),t.close=function(){a("left").close().then(function(){})}}]),angular.module("Controllers").controller("HelpRequestResourcesCtrl",["$rootScope","$scope","$http","$sce",function(e,t,n,o){function s(){n.get("/api/google_results?help_request_id="+this.id).success(function(e){"ready"==e.google_results_status&&(clearInterval(a),t.resources_status=e.google_results_status),t.resources=_.map(e.results,function(e){return e.trusted_html_snippet=o.trustAsHtml(e.html_snippet),e})})}var a;t.resources=[],t.resources_status="initializing",t.noResourcesAvailable=!1,t.$parent.helpRequestPromise.then(function(e){return"question"!==e.type?void(t.noResourcesAvailable=!0):void(a=setInterval(s.bind(e),1e3))})}]),angular.module("Controllers").controller("DependenciesSelectorCtrl",["$rootScope","$scope","$http","$routeParams",function(e,t,n,o){function s(){var e=_.map(t.selectedDependencies,function(e){return e.hackers_count});t.totalHackersCount=_.reduce(e,function(e,t){return e+t}),t.maxHackersToNotify=t.totalHackersCount,t.hackersToNotify=Math.ceil((t.totalHackersCount||2)/2),0===t.totalHackersCount&&(t.hackersToNotify=0)}t.dependenciesLimit=15,t.showAllDependencies=!1,t.selectedDependencies=[],t.selectedDependenciesCount=0,t.selectionLimitOut=!1,t.totalHackersCount=0,t.maxHackersToNotify=0,t.minHackersToNotify=0,t.hackersToNotify=0,t.pingInterval=20,t.showConfigs=!1;var a;a=o.branch?"api/channels/"+o.permalink+"/dependencies?branch="+o.branch:"api/channels/"+o.permalink+"/dependencies",n.get(a).then(function(e){t.allDependenciesCount=e.data.total_result_count,t.allDependencies=e.data.results}),t.selectDependency=function(n){if(t.selectedDependenciesCount<5){t.selectedDependencies.push(n),t.$emit("updateSelectedDependencies",t.selectedDependencies);var o=_.select(t.allDependencies,function(e){return e.name==n.name});_.remove(t.allDependencies,o[0]),t.selectedDependenciesCount=Object.keys(t.selectedDependencies).length}else t.selectionLimitOut=!0,e.showCustomToast("The limit for selected tags is 5","error");s()},t.deselectDependency=function(e){t.allDependencies.push(e);var n=_.select(t.selectedDependencies,function(t){return t.name==e.name});_.remove(t.selectedDependencies,n[0]),t.$emit("updateSelectedDependencies",t.selectedDependencies),t.selectedDependenciesCount=Object.keys(t.selectedDependencies).length,t.selectedDependenciesCount<5&&(t.selectionLimitOut=!1),s()},t.toggleConfigs=function(){t.showConfigs=!t.showConfigs},t.toggleShowDependencies=function(){t.showAllDependencies=!t.showAllDependencies,15!=t.dependenciesLimit?t.dependenciesLimit=15:t.dependenciesLimit=t.allDependencies.length}}]),angular.module("Controllers").controller("ResponseFormCtrl",["$document","$scope","$http","$routeParams","$mdSidenav","$sce","$mdDialog","$rootScope","auth","$location","$firebaseObject",function(e,t,n,o,s,a,r,i,l,c,u){function p(e){var s="/api/channels/"+o.permalink+"/help_requests/"+o.request_number;n.put(s,{help_request:e}).success(function(e){t.helpRequest=e,c.path("/channels/"+o.permalink),i.showCustomToast("You've marked a help request as closed"),t.closeSubmitted=!1})}var d,m,h,g=new Showdown.converter;t.channelPermalink=o.permalink,t.has_permission=!1,t.dataLoaded=!1,t.newRequest=!!o.request_number,t.newRequest&&(t.$parent.helpRequestPromise.then(function(e){t.isHelpRequestClosed="closed"===e.status,m=e.collaborators_ids,l.currentUser().then(function(e){var n=parseInt(e.id);(-1!=m.indexOf(n)||e.is_hacker)&&(t.has_permission=!0)}),t.helpRespons={body:null},t.responseSubmitted=!1,t.createHelpResponse=function(s){s.$valid?(t.responseSubmitted=!0,h="/api/help_requests/"+e.id+"/help_responses/",mixpanel.track("Create new response",{channel:o.permalink,date:new Date}),n.post(h,{help_response:t.helpResponse}).success(function(e){e.renderedBody=a.trustAsHtml(g.makeHtml(e.body||"")),i.selectedFilePath?i.$broadcast("newHelpResponseOnFile",e):i.$broadcast("newHelpResponse",e),t.helpResponse={},d="",s.$setPristine(),s.$setUntouched(),t.responseSubmitted=!1}).error(function(e){t.responseSubmitted=!1})):t.formSubmitted=!0},t.previewToggled=!1,t.parseHelpResponse=function(){t.previewToggled&&(d=g.makeHtml(t.helpResponse.body||""))},t.togglePreview=function(){t.previewToggled=!t.previewToggled,t.parseHelpResponse()},t.renderedHelpResponse=function(){return a.trustAsHtml(d)},t.dataLoaded=!0}),t.closeRequest=function(){t.closeSubmitted=!0;var e={status:"closed"};if("live_session"===t.helpRequest.type){e.type="live_session";var n="https://githelpdev.firebaseio.com/sessions/helpRequests/"+t.helpRequest.id+"/videoChat/",o=new Firebase(n);t.sessionObject=u(o),t.sessionObject.$loaded().then(function(n){t.sessionObject.timeConsumed?e.consumption=parseInt(t.sessionObject.timeConsumed.split(":")[1]):e.consumption=0,p(e)})}else p(e)})}]),angular.module("Controllers").controller("HelpResponsesIndexCtrl",["$document","$scope","$http","$routeParams","$mdSidenav","$sce","$mdDialog","$rootScope","auth","$location",function(e,t,n,o,s,a,r,i,l,c){var u,p,d,m=new Showdown.converter;t.channelName=o.permalink,t.requestNumber=o.request_number,t.responsesLoaded=!1,t.$parent.helpRequestPromise&&t.$parent.helpRequestPromise.then(function(e){i.selectedFilePath?(p={file_path:i.selectedFilePath.full_path},d=!0):d=!1,u="/api/help_requests/"+e.id+"/help_responses/",n({method:"GET",url:u,params:p}).success(function(e){t.helpResponses=_.map(e.results,function(e){return e.renderedBody=a.trustAsHtml(m.makeHtml(e.body||"")),e}),t.responsesLoaded=!0,o.response_id&&setTimeout(function(){var e=$("#helpResponse"+o.response_id);$("html,body").animate({scrollTop:e.offset().top-70}),setTimeout(function(){e.fadeOut(700).fadeIn(700).fadeOut(300).fadeIn(300)},100)},700)}),d?i.$on("newHelpResponseOnFile",function(e,n){t.helpResponses.push(n)}):i.$on("newHelpResponse",function(e,n){t.helpResponses.push(n)})})}]),angular.module("Controllers").controller("OrgsShowCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){var l;window.scrollTo(0,0),n.currentCtrl="orgs",n.orgTabs=0,n.has_permission_as_admin=!1,n.has_permission_as_member=!1,n.dataLoaded=!1,l=s.permalink,t[0].title=l+" - GitHelp",o.get("/api/organizations/"+l).success(function(e){n.org=e,t[0].title=e.name+" - GitHelp",r.currentUser().then(function(t){mixpanel.track("Show organization",{username:t.username,channel:s.permalink,date:new Date}),-1!==e.admin_ids.indexOf(t.id)?(n.has_permission_as_admin=!0,n.has_permission_as_member=!0):-1!==e.member_ids.indexOf(t.id)&&(n.has_permission_as_member=!0),n.dataLoaded=!0})}),n.managerOrg=function(){a.path("/orgs/"+l+"/manager")}}]),angular.module("Controllers").controller("OrgsIndexCtrl",["$scope","auth","$http","$rootScope","$location","$document","CONFIGS",function(e,t,n,o,s,a,r){window.scrollTo(0,0),a[0].title="Organizations - GitHelp",e.dataLoaded=!1,t.currentUser().then(function(t){e.currentUser=t,e.privateAccessRequired="not_authorized"===t.private_channels_status,e.dataLoaded=!0}),e.createOrg=function(a){e.actionSubmitted=!0,a&&(e.org.permalink=e.org.name.replace(/[&\/\\#,+()$~%.'":*?<>{} ]/g,"_").toLowerCase(),n.post("/api/organizations/",{organization:e.org}).success(function(n){e.actionSubmitted=!1,o.showCustomToast("You've successfully created new organization!"),s.path("/orgs/"+n.permalink),t.currentUser(!0).then(function(e){o.currentUser=e})}).error(function(t){"Forbidden"===t.error?(o.showCustomToast("You need admin permission for that action."),e.actionSubmitted=!0):(o.showCustomToast("Something went wrong"),e.actionSubmitted=!1)}))},e.activate=function(){var t=arguments.length<=0||void 0===arguments[0]?null:arguments[0];if(e.privateAccessRequired){var o=r().REPOS_APP_GITHUB_CLIENT_ID,a=r().REPOS_APP_GITHUB_REDIRECTURI+"?return_url=orgs";location.href="https://github.com/login/oauth/authorize?client_id="+o+"&scope=repo,user&redirect_uri="+a}else n.put("/api/organizations/"+t.permalink+"/activate").success(function(e){}),s.path("/orgs/"+t.permalink)}}]),angular.module("Controllers").controller("OrgsTeamTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){var l;l=s.permalink,o.get("/api/organizations/"+l+"/org_members").success(function(e){n.members=e.members.concat(e.admins)})}]),angular.module("Controllers").controller("OrgsChannelsTabCtrl",["$rootScope","$scope","$location","Pages","$timeout","CONFIGS","$notification","$routeParams",function(e,t,n,o,s,a,r,i){function l(e){if(t.loadingMore=!1,t.dataLoaded=!0,t.channels=e,t.channelsStatus=e.full_data.channels_status,t.total_repos_count=e.full_data.total_repos_count,-1!==["syncing","initializing"].indexOf(t.channelsStatus)){t.$parent.channelsTabIndex;s(function(){c.forceReloadAllData().then(l)},5e3)}t.canLoadMore=c.canLoadMore(),t.remainingEntries=c.remainingEntriesFormatted()}var c;t.channels=[],t.loadingMore=!1,t.canLoadMore=!0,t.dataLoaded=!1,t.remainingEntries="",t.$watch(function(){$('[data-toggle="tooltip"]').tooltip()});var u=i.permalink;c=o("/api/organizations/"+u+"/channels"),c.getCurrentPages().then(l),t.loadMore=function(){t.loadingMore=!0,t.canLoadMore=!1,c.loadMore().then(l)},t.grantAccess=function(){var e,n;0===t.$parent.channelsTabIndex?(e=a().REPOS_APP_GITHUB_CLIENT_ID,n=a().REPOS_APP_GITHUB_REDIRECTURI+"?access=public",location.href="https://github.com/login/oauth/authorize?client_id="+e+"&scope=public_repo&redirect_uri="+n):(e=a().REPOS_APP_GITHUB_CLIENT_ID,location.href="https://github.com/login/oauth/authorize?client_id="+e+"&scope=repo,user")},t.helpRequests=function(e){n.url("/channels/"+e+"/help_requests")},t.newRequest=function(e,t){n.path("/channels/"+e+"/help_requests/new/"+t)}}]),angular.module("Controllers").controller("OrgsHelpRequestsTabCtrl",["$document","$scope","$http","$routeParams","$location","$timeout","Pages",function(e,t,n,o,s,a,r){var i,l;i=o.permalink,l=r("/api/organizations/"+i+"/help_requests"),t.dataLoaded=!1,t.searchViewActived=!1,t.canLoadMore=!1,l.getCurrentPages().then(function(e){t.helpRequests=e,t.canLoadMore=l.canLoadMore(),t.dataLoaded=!0}),t.loadMore=function(){t.loading=!0,t.canLoadMore=!1,0===t.channelTabs&&l.loadMore().then(function(e){t.helpRequests=e,t.canLoadMore=l.canLoadMore(),t.loading=!1})}}]),angular.module("Controllers").controller("SupportPlansShowCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){var l,c=i.defer();window.scrollTo(0,0),n.support_plans=c.promise,l=s.permalink,t[0].title=l+" - GitHelp",o.get("/api/organizations/"+l).success(function(e){n.org=e}),o.get("/api/organizations/"+l+"/support_plans").success(function(e){n.support_plans=e,c.resolve(e)})}]),angular.module("Controllers").controller("OrgsIncomingRequestsCtrl",["$document","$scope","$http","$routeParams","$location","$timeout","Pages","auth","$rootScope","$mdDialog","$templateCache",function(e,t,n,o,s,a,r,i,l,c,u){function p(e,o){n.put("/api/channels/"+e.channel.permalink+"/help_requests/"+e.number+"/assign",{assignee_id:o.id}).success(function(e){m.forceReloadAllData().then(function(e){t.helpRequests=e,t.currentUser.id===o.id?l.showCustomToast("You've successfully assigned this request to yourself","success"):l.showCustomToast("You've successfully assigned this request to "+o.name,"success")})}).error(function(e){e.assignee_id?l.showCustomToast(e.assignee_id[0],"error"):l.showCustomToast("Sorry, something went wrong!")})}var d,m;window.scrollTo(0,0),t.permalink=d=o.permalink,t.incomingRequestsView=!0,m=r("/api/organizations/"+d+"/incoming_help_requests"),t.dataLoaded=!1,t.searchViewActived=!1,t.canLoadMore=!1,i.currentUser().then(function(e){t.currentUser=e,t.orgAdmin=1===_.filter(e.organizations,function(e){return e.permalink===d&&e.admin}).length,m.getCurrentPages().then(function(e){t.helpRequests=e,_.each(t.helpRequests,function(e){if("live_session"==e.type){var t=new Date(e.live_session_time);e.sessionDate=t.toDateString()+" @ "+t.toLocaleTimeString()}}),t.canLoadMore=m.canLoadMore(),t.dataLoaded=!0})}),t.loadMore=function(){t.loading=!0,t.canLoadMore=!1,m.loadMore().then(function(e){t.helpRequests=e,t.canLoadMore=m.canLoadMore(),t.loading=!1})},t.assignHacker=function(e){var n=_.filter(e.support_team,function(e){return t.currentUser.username===e.username})[0];t.orgAdmin?(l.supportTeam=e.support_team,c.show({template:u.get("/templates/orgs/partials/assign-members.html"),parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(t){p(e,t)},function(){})):n.member?p(e,t.currentUser):l.showCustomToast("You're not member of the support team for this subscription!","error")}}]),angular.module("Controllers").controller("AssignSupportTeamCtrl",["$rootScope","$scope","$mdDialog","auth","$http","$routeParams",function(e,t,n,o,s,a){function r(){s.get("/api/organizations/"+l+"/support_teams").success(function(e){t.teams=e})}function i(e,n){var o="/api/organizations/"+l+"/subscriptions/"+e.id;s.put(o,n).success(function(e){t.actionSubmitted=!1})}var l=a.permalink;t.actionSubmitted=!1,o.currentUser().then(function(e){t.currentUser=e;var n=_.filter(e.organizations,function(e){return e.permalink===l&&e.admin});1===n.length&&(t.hasPermission=!0)}),r(),t.assignTeam=function(o){t.actionSubmitted=!0;var s={subscription:{support_team_id:o}};i(e.selectedSubscription,s),r(),n.hide(),e.showCustomToast("You've assigned a team to a subscription successfully")},t.hide=function(){e.selectedSubscription=null,n.hide()}}]),angular.module("Controllers").controller("AssignMembersCtrl",["$scope","$mdDialog","auth","$rootScope","$http","$routeParams",function(e,t,n,o,s,a){e.supportTeam=o.supportTeam,e.cancel=function(){o.supportTeam=null,t.cancel()},e.selectedMember=function(e){t.hide(e),o.supportTeam=null}}]),angular.module("Controllers").controller("PlansShowCtrl",["$rootScope","$document","$scope","$http","$routeParams","$mdDialog","auth","$templateCache",function(e,t,n,o,s,a,r,i){var l=s.permalink;n.support_plans=null,n.noPlansAvailable=!1,n.planDataLoaded=!1,n.$parent&&n.$parent.support_plans?n.$parent.support_plans.then(function(e){n.support_plans=e,n.planDataLoaded=!0}):(o.get("/api/organizations/"+l+"/support_plans").success(function(e){n.support_plans=e}),n.planDataLoaded=!0),n.showAdvanced=function(t,o){e.selectedPlan=o,a.show({template:i.get("/templates/orgs/partials/subscription-new.html"),parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(e){n.alert='You said the information was "'+e+'".'},function(){n.alert="You cancelled the dialog."})}}]),angular.module("Controllers").controller("SubscriptionNewCtrl",["$scope","$mdDialog","auth","$rootScope","$http","$routeParams",function(e,t,n,o,s,a){e.selectedPlan=o.selectedPlan,n.currentUser().then(function(t){e.currentUser=t,e.orgsWhereAdmin=_.filter(t.organizations,function(t){return t.admin&&e.selectedPlan.organization.permalink!==t.permalink})}),e.newSubscription={};var r=null;e.selectSubscriptionOption=function(t,n,o){e.subscriberType=n,t.selected=!0,r&&(r.selected=!1),r=t,e.newSubscription={support_plan_id:e.selectedPlan.id,payment_system:"Yearly"}},e.cancel=function(){r&&(r.selected=!1,r=null),e.subscriberType=null,e.newSubscription={},t.cancel()},e.subscribe=function(){var a;"User"===e.subscriberType?a="/api/users/"+r.username+"/subscriptions":"Organization"===e.subscriberType&&(a="/api/organizations/"+r.permalink+"/subscriptions"),a?s.post(a,{subscription:e.newSubscription}).success(function(e){n.currentUser(!0),o.showCustomToast("Your subscriptions have been submitted successfully!"),t.hide()}).error(function(e){e.subscriber_id?o.showCustomToast(e.subscriber_id[0]):o.showCustomToast("Sorry, something went wrong!")}):o.showCustomToast("You should select an organization first!","error")}}]),angular.module("Controllers").controller("OrgManagerShowCtrl",["$scope","$document","$http","$routeParams","auth","$location",function(e,t,n,o,s,a){var r,i=o.permalink;t[0].title=i+" - GitHelp",e.orgDataLoaded=!1,window.scrollTo(0,0),e.configsTabs=[{text:"General",icon:"fa-cog",templateURL:"/templates/orgs/manager/tabs/general-tab.html",isActive:!o.tab||"general"===o.tab},{text:"Members",icon:"fa-users",templateURL:"/templates/orgs/manager/tabs/members-tab.html",isActive:"members"===o.tab},{text:"Subscriptions",icon:"fa-life-ring",templateURL:"/templates/orgs/manager/tabs/subscription-tab.html",isActive:"subscriptions"===o.tab},{text:"Support Teams",icon:"fa-users",templateURL:"/templates/orgs/manager/tabs/teams-tab.html",isActive:"support_teams"===o.tab},{text:"Plans",icon:"fa-suitcase",templateURL:"/templates/orgs/manager/tabs/plans-tab.html",isActive:"plans"===o.tab},{text:"Payment",icon:"fa-credit-card",templateURL:"/templates/orgs/manager/tabs/payment-tab.html",isActive:"payment"===o.tab}],e.activateConfigsTab=function(t){if(!t.isActive){var n=_.filter(e.configsTabs,function(e){return e.isActive})[0];n.isActive=!1,t.isActive=!0,a.search("tab",t.text.toLowerCase().replace(" ","_"))}},e.hasPermission=!1,(r=e.getOrg=function(){n.get("/api/organizations/"+i).success(function(t){e.org=t,s.currentUser().then(function(n){var o=_.filter(n.organizations,function(e){return e.permalink===i&&e.admin});1===o.length&&(e.hasPermission=!0),-1!==t.member_ids.indexOf(n.id)&&a.path("/404").replace(),e.orgDataLoaded=!0})})})()}]),angular.module("Controllers").controller("OrgsManagerMembersTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){function l(){o.get("/api/organizations/"+p+"/org_members").success(function(e){n.members=e.members,n.membersCount=e.members_count,n.pendingMembers=e.pending_members,n.pendingMembersCount=e.pending_members_count,n.admins=e.admins,n.adminsCount=e.admins_count,n.actionSubmitted=!1})}function c(t,s){o.put("/api/organizations/"+p+"/org_members/"+t,{admin:s}).success(function(e){l(),n.$parent.getOrg()}).error(function(t){"Forbidden"===t.error?(e.showCustomToast("You need admin permission for that action."),n.actionSubmitted=!0):(e.showCustomToast("Something went wrong"),n.actionSubmitted=!1)})}function u(t,s){o["delete"]("/api/organizations/"+p+"/org_members/"+t+"?member_type="+s).success(function(e){l(),n.$parent.getOrg()}).error(function(t){"Forbidden"===t.error?(e.showCustomToast("You need admin permission for that action."),n.actionSubmitted=!0):t.base[0]?(e.showCustomToast(t.base[0]),n.actionSubmitted=!1):(e.showCustomToast("Something went wrong"),n.actionSubmitted=!1)})}var p,l;p=s.permalink,n.actionSubmitted=!1,r.currentUser().then(function(e){n.currentUser=e;var t=_.filter(e.organizations,function(e){return e.permalink===p&&e.admin});1===t.length&&(n.hasPermission=!0)}),l(),n.$watch("newMembersString",function(){n.newMembersString?n.newMembersArray=n.newMembersString.split(","):n.newMembersArray=[]}),n.newMembersArray=[],n.addToAdmins=function(e){if(n.$parent.org){n.actionSubmitted=!0;_.filter(n.$parent.org.member_ids,function(t){return n.actionSubmitted=!1,e!==t}),n.$parent.org.admin_ids.concat(e);c(e,!0)}},n.removeFromAdmins=function(t){if(n.$parent.org){if(n.actionSubmitted=!0,1===n.$parent.org.admin_ids.length)return e.showCustomToast("You need to have at least one Admin!"),void(n.actionSubmitted=!1);if(n.currentUser.id===t)return e.showCustomToast("You can not remove yourself from the admins!"),void(n.actionSubmitted=!1);_.filter(n.$parent.org.admin_ids,function(e){return t!==e}),n.$parent.org.member_ids.concat(t);c(t,!1)}},n.removeFromMembers=function(t){if(n.$parent.org){if(n.actionSubmitted=!0,n.currentUser.id===t)return e.showCustomToast("You can not remove yourself from the members!"),void(n.actionSubmitted=!1);_.filter(n.$parent.org.member_ids,function(e){return t!==e}),n.$parent.org.admins_ids;u(t,"member")}},n.removeFromPending=function(e){if(n.$parent.org){n.actionSubmitted=!0;_.filter(n.pendingMembers,function(t){return e!==t.id});u(e,"pending_member")}}}]),angular.module("Controllers").controller("OrgsManagerGeneralTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){var l,c=s.permalink;l=n.getOrg=function(){o.get("/api/organizations/"+c).success(function(e){n.org=e})},l(),n.updateOrgInfo=function(t){if(n.actionSubmitted=!0,t){var s={name:n.org.name,description:n.org.description,logo_url:n.org.logo_url};o.put("/api/organizations/"+c,{organization:s}).success(function(t){n.actionSubmitted=!1,e.showCustomToast("You've successfully updated your organization info!"),a.path("/orgs/"+t.permalink)}).error(function(t){"Forbidden"===t.error?(e.showCustomToast("You need admin permission for that action."),n.actionSubmitted=!0):(e.showCustomToast("Something went wrong"),n.actionSubmitted=!1)})}else n.actionSubmitted=!1},n.cancelUpdate=function(){a.path("/orgs/"+n.org.permalink)}}]),angular.module("Controllers").controller("OrgsManagerTeamsTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q",function(e,t,n,o,s,a,r,i){function l(){o.get("/api/organizations/"+u+"/support_teams").success(function(e){n.teams=e,c()})}function c(){o.get("/api/organizations/"+u+"/org_members").success(function(e){n.allMembers=e.members.concat(e.admins)})}var c,u=s.permalink;n.teams=[],n.newTeamMembers=[],n.noMembersSelected=!0,l(),n.addToNewTeam=function(t){var o=_.filter(n.newTeamMembers,function(e){return t.id===e.id});0===o.length?n.newTeamMembers.push(t):e.showCustomToast("You have added this member already!"),n.newTeamMembers.length>0&&(n.noMembersSelected=!1)},n.removeFromNewTeam=function(e){n.newTeamMembers=_.filter(n.newTeamMembers,function(t){return t.id!==e.id}),0===n.newTeamMembers.length&&(n.noMembersSelected=!0)},n.createTeam=function(){if(n.noMembersSelected=!0,0!=n.newTeamMembers.length){var t=_.map(n.newTeamMembers,function(e){return e.id}),s={support_team:{name:"Team"+(n.teams.length+1),member_ids:t}};o.post("/api/organizations/"+u+"/support_teams",s).success(function(e){l(),n.newTeamMembers=[],n.noMembersSelected=!1,n.newMembersFormToggle=!1}).error(function(t){n.newMembersFormToggle=!1,e.showCustomToast("Something went wrong")})}},n.removeTeam=function(t){if(n.actionSubmitted=!0,t.subscription_ids.length>0)return e.showCustomToast("You can not remove team assigned to an active subscription!"),void(n.actionSubmitted=!1);var s="/api/organizations/"+u+"/support_teams/"+t.id;o["delete"](s).success(function(e){l(),n.actionSubmitted=!1}).error(function(t){e.showCustomToast("Something went wrong")})}}]),angular.module("Controllers").controller("OrgsManagerSubscriptionsTabCtrl",["$rootScope","$document","$scope","$http","$routeParams","$location","auth","$q","$mdDialog","$templateCache",function(e,t,n,o,s,a,r,i,l,c){function u(){o.get("/api/organizations/"+m+"/subscriptions/incoming").success(function(e){n.incomingSubscriptions=e})}function p(){o.get("/api/organizations/"+m+"/subscriptions").success(function(e){n.outcomingSubscriptions=e})}function d(t,s){var a="/api/organizations/"+m+"/subscriptions/"+t.id;o.put(a,s).success(function(e){u(),n.actionSubmitted=!1}).error(function(t){e.showCustomToast("Sorry, something went wrong!"),
n.actionSubmitted=!1})}var m=s.permalink;r.currentUser().then(function(e){n.currentUser=e;var t=_.filter(e.organizations,function(e){return e.permalink===m&&e.admin});1===t.length&&(n.hasPermission=!0)}),p(),u(),n.actionSubmitted=!1,n.updateReverseSubscriptionStatus=function(e,t){n.actionSubmitted=!0;var o={subscription:{status:t}};d(e,o)},n.assignSupportTeam=function(t,o){e.selectedSubscription=o,l.show({template:c.get("/templates/orgs/partials/assign-support-team.html"),parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(e){u()},function(){n.alert="You canceled the dialog."})}}]),angular.module("Controllers").controller("SessionShowCtrl",["$rootScope","$scope","$mdDialog","$http","$routeParams","$firebaseArray","$firebaseObject","$notification","$interval","$timeout","$window","auth","$location",function(e,t,n,o,s,a,r,i,l,c,u,p,d){function m(n){C=new Firebase(n),t.messages=a(C),t.messages.$loaded().then(function(e){t.chatHistoryLoaded=!0,c(function(){$(".chat-msgs-content")[0]&&$(".chat-msgs-content").animate({scrollTop:$(".chat-msgs-content")[0].scrollHeight})},100),t.messages.$watch(function(e){$(".chat-msgs-content")[0]&&$(".chat-msgs-content").animate({scrollTop:$(".chat-msgs-content")[0].scrollHeight})})})["catch"](function(t){e.showCustomToast("Something went wrong")})}function h(e){var t=new Firebase(e);q=ace.edit("firepad-container"),q.setTheme("ace/theme/monokai"),q.getSession().setTabSize(2),k=q.getSession(),k.setUseWrapMode(!0),k.setUseWorker(!1),k.setMode("ace/mode/ruby");Firepad.fromACE(t,q,{defaultText:"# Hello World!"})}function g(e){T=new Firebase(e),t.sessionObject=r(T),t.sessionObject.$loaded().then(function(e){void 0===t.sessionObject.creator||void 0===t.sessionObject.assignee?(void 0===t.sessionObject.creator&&(t.sessionObject.creator={username:t.helpRequest.creator.username,peerID:t.helpRequest.creator.username+w(),avatar_url:t.helpRequest.creator.avatar_url,last_seen:Date.now()}),void 0===t.sessionObject.assignee&&t.helpRequest.assignee&&(t.sessionObject.assignee={username:t.helpRequest.assignee.username,peerID:t.helpRequest.assignee.username+w(),avatar_url:t.helpRequest.assignee.avatar_url,last_seen:Date.now()}),void 0===t.sessionObject.timeConsumed&&(t.sessionObject.timeConsumed="00:00:00"),t.sessionObject.$save().then(function(e){y(),U()})):f().then(function(){y(),U()}),t.currentSessionTimeCount=t.sessionObject.timeConsumed,t.sessionObjectLoaded=!0})}function f(){var e=t.sessionObject.creator,n=t.sessionObject.assignee;t.currentUser;return e.username===t.currentUser.username&&(t.sessionObject.creator.last_seen=Date.now()),t.helpRequest.assignee?n.username!==t.helpRequest.assignee.username?t.sessionObject.assignee={username:t.helpRequest.assignee.username,peerID:t.helpRequest.assignee.username+w(),avatar_url:t.helpRequest.assignee.avatar_url,last_seen:Date.now()}:n.username===t.currentUser.username&&(n.last_seen=Date.now()):delete t.sessionObject.assignee,t.sessionObject.$save()}function b(){u.localStream.active&&(u.localStreamTracks[0].stop(),u.localStreamTracks[1].stop())}function v(){var e,n,o;return e=t.sessionObject.creator,n=t.sessionObject.assignee,o=t.currentUser,e.username===o.username?t.sessionObject.creator.peerID:n&&n.username===o.username?t.sessionObject.assignee.peerID:void 0}function w(){return Math.ceil(1e4*Math.random(1))}function _(e){e.on("stream",function(e){$("#their-video").prop("src",URL.createObjectURL(e)),$("#their-video").on("end",function(){}),P(),t.connectingToPeer=!1,t.callStarted=!0,t.stepTwoDone=!0}),u.existingCall=e,e.on("close",function(){L(),t.callStarted=!1,t.stepTwoDone=!1}),e.on("disconnected",function(){L(),S.reconnect()})}var C,T,S,R,q,k;s.permalink,s.request_number;t.helpRequestPromise=o.get("/api/channels/"+s.permalink+"/help_requests/"+s.request_number).then(function(e){t.helpRequest=e.data,void 0===e.data.assignee&&(t.noExpertAssigned=!0),p.currentUser().then(function(n){t.currentUser=n,m("https://githelpdev.firebaseio.com/sessions/helpRequests/"+e.data.id+"/textChat/"),h("https://githelpdev.firebaseio.com/sessions/helpRequests/"+e.data.id+"/textEditor/"),g("https://githelpdev.firebaseio.com/sessions/helpRequests/"+e.data.id+"/videoChat/")})}),t.chatHistoryLoaded=!1,t.addMessage=function(){if(t.messages.newMessage&&t.currentUser){var e=Date.now();t.messages.$add({text:t.messages.newMessage,username:t.currentUser.username,avatar_url:t.currentUser.avatar_url,timestamp:e,modifed:!1,deleted:!1}).then(function(e){$(".chat-msgs-content").animate({scrollTop:$(".chat-msgs-content")[0].scrollHeight})}),t.messages.newMessage=null}},t.editorLang="ruby",$(".powered-by-firepad").remove(),t.setEditorLang=function(e){k.setMode("ace/mode/"+e),t.editorLang=e,t.showLangChoices=!1},t.sessionObjectLoaded=!1,t.notAllowedToJoin=!1;var y=function(){var n,o;if(n=t.sessionObject.creator.username,t.sessionObject.assignee&&(o=t.sessionObject.assignee.username),-1===[n,o].indexOf(t.currentUser.username))return void(t.notAllowedToJoin=!0);u.navigator.getUserMedia=u.navigator.getUserMedia||u.navigator.webkitGetUserMedia||u.navigator.mozGetUserMedia;var s=v();S=new Peer(s,{host:"/",port:8e3,path:"/",debug:3,key:"githelp"}),S.on("open",function(){t.initCurrentUserVideo()}),S.on("call",function(e){e.answer(u.localStream),_(e)}),S.on("error",function(n){switch(t.connectingToPeer=!1,n.type){case"peer-unavailable":e.showCustomToast(n.message);break;case"unavailable-id":t.sessionOpenedAlready=!0;break;default:e.showCustomToast("Something went wrong, try again")}})};t.startCall=function(){var e,n,o,s;t.$apply(function(){t.connectingToPeer=!0}),n=t.currentUser,o=t.sessionObject.creator,s=t.sessionObject.assignee,e=o.username===n.username?S.call(s.peerID,u.localStream):S.call(o.peerID,u.localStream),_(e)},t.endCall=function(){L(),u.existingCall&&u.existingCall.close()},t.initCurrentUserVideo=function(){return t.helpRequest.consumption<=parseInt(t.sessionObject.timeConsumed.split(":")[1])?(t.endCall(),e.showCustomToast("The session time is up!","error"),void(t.sessionTimeout=!0)):void u.navigator.getUserMedia({audio:!0,video:!0},function(e){$("#my-video").prop("src",URL.createObjectURL(e)),$("#my-video").on("playing",function(){}),u.localStream=e,u.localStreamTracks=e.getTracks(),t.stepOneDone=!0,t.stepOneFailed=!1,t.$apply()},function(){t.stepOneFailed=!0,t.$apply()})};var P=function(){angular.isDefined(R)||(R=l(D,1e3))},D=function(){return U(),t.helpRequest.consumption===t.timeCounter.getMinutes()?(t.endCall(),e.showCustomToast("The session time is up!","error"),t.sessionTimeout=!0,void b()):(t.timeCounter.setSeconds(t.timeCounter.getSeconds()+1),t.currentSessionTimeCount=t.timeCounter.toTimeString().split(" ")[0],void(t.currentUser.username===t.sessionObject.creator.username&&(t.sessionObject.timeConsumed=t.currentSessionTimeCount,t.sessionObject.$save())))},L=function(){l.cancel(R),R=void 0},U=function(){var e=t.sessionObject.timeConsumed.split(":");t.timeCounter=new Date(0),t.timeCounter.setHours(parseInt(e[0])),t.timeCounter.setMinutes(parseInt(e[1])),t.timeCounter.setSeconds(parseInt(e[2]))};t.closeSessionEnv=function(){e.sessionDialog?e.sessionDialog():n.hide(),setTimeout(function(){$("body").hasClass("md-dialog-is-showing")&&$(".md-dialog-container").length>0&&($("body").removeClass("md-dialog-is-showing"),$(".md-dialog-container").remove(),$(".md-dialog-backdrop").remove(),$("body").css("overflow","visible"))},900),t.endCall(),S&&S.destroy(),b()}}]),angular.module("Controllers").controller("HistoryTabCtrl",["$scope","$routeParams","$http","$location","$rootScope","auth",function(e,t,n,o,s,a){var r;if(e.historyDataLoaded=!1,"channels"==e.$parent.currentCtrl)r="/api/channels/"+t.permalink+"/activities";else{if("orgs"!=e.$parent.currentCtrl)return void s.showCustomToast("Something went wrong!");r="/api/organizations/"+t.permalink+"/activities"}a.currentUser().then(function(t){n.get(r).success(function(t){e.logs=_.map(t.results,function(e){return"HelpResponse"===e.type&&(e.url=e.url+"?response_id="+e.loggable_obj.id),e}),e.totalNumberOflogs=t.total_result_count,e.historyDataLoaded=!0})})}]),angular.module("Controllers").controller("HeaderCtrl",["$scope","$http","auth","$window","$timeout","$rootScope",function(e,t,n,o,s,a){e.dataLoaded=!1,e.transHeader=!1,a.$on("userLoggedOut",function(){e.currentUser=null}),e.log_out=function(){e.currentUser=null,t["delete"]("/api/sessions").success(function(){n.logout()})},n.currentUser().then(function(t){e.dataLoaded=!0,e.currentUser=t}),a.$on("userAuthenticated",function(t,n){e.currentUser=n.data.user}),e.isLandingPage=function(){return"/"===location.pathname?!0:!1}}]),angular.module("Controllers").controller("ToastCtrl",["$rootScope","$scope","$mdToast",function(e,t,n){t.closeToast=function(){n.hide()}}]),angular.module("Controllers").controller("ShareButtonsCtrl",["$scope",function(e){e.twitterShare=function(){var e="https://GitHelp.io/",t="GitHelp.io - Built by hackers for hackers. It is a new way to communicate with great hackers.",n="GitHelpIO",o="http://twitter.com/share?url="+encodeURI(e)+"&via="+n+"&text="+t;window.open(o,"twitter-share-dialog","width=626,height=436")},e.googleShare=function(){var e="https://GitHelp.io/",t="https://plus.google.com/share?url="+encodeURI(e);window.open(t,"google-share-dialog","width=626,height=436")},e.redditShare=function(){var e="https://GitHelp.io/",t="Githelp.io - Ask the authors",n="https://www.reddit.com/submit?url="+encodeURI(e)+"&title="+t;window.open(n,"reddit-share-dialog","width=626,height=436")}}]),angular.module("GitHelpApp").constant("CONFIGS",function(){var e={development:{LOGIN_APP_GITHUB_REDIRECTURI:"http://localhost:9000/api/login_callback",LOGIN_APP_GITHUB_CLIENT_ID:"7d00b65c5f1e526b8a9c",REPOS_APP_GITHUB_REDIRECTURI:"http://localhost:9000/api/repos_access_callback",REPOS_APP_GITHUB_CLIENT_ID:"c53d19974d6135e488aa"},production:{LOGIN_APP_GITHUB_REDIRECTURI:"https://githelp.io/api/login_callback",LOGIN_APP_GITHUB_CLIENT_ID:"819c28e64bc19415da0a",REPOS_APP_GITHUB_REDIRECTURI:"https://githelp.io/api/repos_access_callback",REPOS_APP_GITHUB_CLIENT_ID:"5e6249c8fd28381db65a"},staging:{LOGIN_APP_GITHUB_REDIRECTURI:"https://stg.githelp.io/api/login_callback",LOGIN_APP_GITHUB_CLIENT_ID:"e48642fec60f6b775c7a",REPOS_APP_GITHUB_REDIRECTURI:"https://stg.githelp.io/api/repos_access_callback",REPOS_APP_GITHUB_CLIENT_ID:"2d889d8b8233442669d9"}};return-1==location.host.indexOf("githelp.io")?e.development:-1!=location.host.indexOf("stg.githelp")?e.staging:e.production});var utilityModule=angular.module("GitHelpApp.utilityServices",[]);utilityModule.service("utilService",["$timeout",function(e){this.showLoader=function(){e(function(){},2e3)},this.dismissProgress=function(){e(function(){},2e3)}}]),angular.module("GitHelpApp").directive("terminaltyping",function(){return function(e,t){var n,o,s;n=t.data("content-src"),o=n?n.split("|"):['--ask dhh --about rails --q "How to build a scalable architecture with Rails without microservices?"',"--talk-to tenderlove --about psych","--chat-with jashkenas --about backbone"],s={strings:o,showCursor:!0,cursorChar:"_",typeSpeed:30,backSpeed:0,backDelay:600},o.length>1&&(s.loop=!0,s.typeSpeed=7),t.typed(s)}}),angular.module("Services").service("blinkingElement",[function(){this.trigger=function(e){var t=function(){var t=$(e);t.css("transition","opacity 0.5s linear"),"1"===t.css("opacity")?t.css("opacity","0"):t.css("opacity","1")};setInterval(t,600)}}]),angular.module("Services").service("auth",["$rootScope","$auth","$http","$q",function(e,t,n,o){function s(e){window.Intercom("boot",{app_id:"b0ato923",email:e.email,user_id:e.id,created_at:e.created_at,widget:{activator:"#IntercomDefaultWidget"}})}return{login:function(e){return t.login(e)},signup:function(e){return t.signup(e)},authenticate:function(n,o){return t.authenticate(n,o).then(function(t){return t.data.hasOwnProperty("error")?delete localStorage.githelp_token:(e.currentUser=t.data.user,mixpanel.identify(t.data.user.username),mixpanel.people.set({$email:t.data.user.email,$created:t.data.user.created_at}),mixpanel.track("Authenticate User",{username:t.data.user,date:new Date}),s(t.data.user)),t})},logout:function(){return t.logout().then(function(t){return e.currentUser=null,Intercom("shutdown"),t})},isAuthenticated:function(){return t.isAuthenticated()},currentUser:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],a=o.defer();return e.currentUser&&!t?a.resolve(e.currentUser):n.get("/api/user").success(function(t){t.hasOwnProperty("error")?delete localStorage.githelp_token:(e.currentUser=t,s(t)),a.resolve(t)}).error(function(e){}),a.promise},link:function(e,n){return t.link(e,n)},unlink:function(e){return t.unlink(e)},getToken:function(){return t.getToken()},getPayload:function(){return t.getPayload()}}}]),angular.module("Services").service("Pages",["$http","$q",function(e,t){return function(n){var o,s,a,r=1;return s=n,o=[],a=o.length,{loadMore:function(){var n,a=this,i=t.defer();return r++,n=-1===s.indexOf("?")?s+"?skip="+o.length:s+"&skip="+o.length,e.get(n).then(function(e){a.updateDataStore(e.data),i.resolve(o)}),i.promise},getCurrentPages:function(){var e=t.defer();return 0===o.length?this.GETdata(e):e.resolve(o),e.promise},getFullData:function(){var e=t.defer();return void 0===o.full_data?this.GETdata(e):e.resolve(o.full_data),e.promise},GETdata:function(t){var n=this;return e.get(s).then(function(e){a=e.data.total_result_count,n.updateDataStore(e.data),t.resolve(o)})},forceReloadAllData:function(){var e=t.defer();return o=[],a=[],this.GETdata(e),e.promise},canLoadMore:function(){return o.length<a},updateDataStore:function(e){return o=o.concat(e.results),o.full_data=e,o},totalDataLength:function(){return a},remainingEntriesFormatted:function(){return o.length+" of "+a}}}}]),angular.module("Services").service("slowTyping",[function(){this.trigger=function(t){setTimeout(function(){t=$(t),_.each(t,function(t){e($(t))})},500)};var e=function(e){if("rolling"!=e.data("status")){e.data("status","rolling");var n=e.data("content"),o=n.split("<|>");t(e,n,o),o.length>1&&setInterval(function(){t(e,n,o)},150*n.length)}},t=function(e,t,n){_.each(n,function(n){setTimeout(function(){e.html(""),_.each(n,function(t,n){setTimeout(function(){e.html(e.html()+t)},150*n)})},150*(t.indexOf(n)+1))})}}]);