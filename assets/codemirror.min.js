(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{this.CodeMirror=a()}}})(function(){var co=/gecko\/\d/i.test(navigator.userAgent);var eL=/MSIE \d/.test(navigator.userAgent);var bJ=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var dL=eL||bJ;var k=dL&&(eL?document.documentMode||6:bJ[1]);var c0=/WebKit\//.test(navigator.userAgent);var dO=c0&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var dd=/Chrome\//.test(navigator.userAgent);var d4=/Opera\//.test(navigator.userAgent);var aC=/Apple Computer/.test(navigator.vendor);var c7=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var fv=/PhantomJS/.test(navigator.userAgent);var e2=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var eh=e2||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var b7=e2||/Mac/.test(navigator.platform);var aP=/win/i.test(navigator.platform);var aZ=d4&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(aZ){aZ=Number(aZ[1])}if(aZ&&aZ>=15){d4=false;c0=true}var bQ=b7&&(dO||d4&&(aZ==null||aZ<12.11));var gb=co||(dL&&k>=9);var ge=false,a7=false;function H(gl,gn){if(!(this instanceof H)){return new H(gl,gn)}this.options=gn=gn?aN(gn):{};aN(e4,gn,false);ce(gn);var gr=gn.value;if(typeof gr=="string"){gr=new at(gr,gn.mode,null,gn.lineSeparator)}this.doc=gr;var gm=new H.inputStyles[gn.inputStyle](this);var gq=this.display=new eJ(gl,gr,gm);gq.wrapper.CodeMirror=this;ed(this);cO(this);if(gn.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(gn.autofocus&&!eh){gq.input.focus()}aD(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,selectingText:false,draggingText:false,highlight:new gj(),keySeq:null,specialChars:null};var gk=this;if(dL&&k<11){setTimeout(function(){gk.display.input.reset(true)},20)}fR(this);bj();cI(this);this.curOp.forceUpdate=true;ec(this,gr);if((gn.autofocus&&!eh)||gk.hasFocus()){setTimeout(cv(cB,this),20)}else{aV(this)}for(var gp in bf){if(bf.hasOwnProperty(gp)){bf[gp](this,gn[gp],cc)}}d6(this);if(gn.finishInit){gn.finishInit(this)}for(var go=0;go<a8.length;++go){a8[go](this)}am(this);if(c0&&gn.lineWrapping&&getComputedStyle(gq.lineDiv).textRendering=="optimizelegibility"){gq.lineDiv.style.textRendering="auto"}}function eJ(gk,gm,gl){var gn=this;this.input=gl;gn.scrollbarFiller=f4("div",null,"CodeMirror-scrollbar-filler");gn.scrollbarFiller.setAttribute("cm-not-content","true");gn.gutterFiller=f4("div",null,"CodeMirror-gutter-filler");gn.gutterFiller.setAttribute("cm-not-content","true");gn.lineDiv=f4("div",null,"CodeMirror-code");gn.selectionDiv=f4("div",null,null,"position: relative; z-index: 1");gn.cursorDiv=f4("div",null,"CodeMirror-cursors");gn.measure=f4("div",null,"CodeMirror-measure");gn.lineMeasure=f4("div",null,"CodeMirror-measure");gn.lineSpace=f4("div",[gn.measure,gn.lineMeasure,gn.selectionDiv,gn.cursorDiv,gn.lineDiv],null,"position: relative; outline: none");gn.mover=f4("div",[f4("div",[gn.lineSpace],"CodeMirror-lines")],null,"position: relative");gn.sizer=f4("div",[gn.mover],"CodeMirror-sizer");gn.sizerWidth=null;gn.heightForcer=f4("div",null,null,"position: absolute; height: "+dK+"px; width: 1px;");gn.gutters=f4("div",null,"CodeMirror-gutters");gn.lineGutter=null;gn.scroller=f4("div",[gn.sizer,gn.heightForcer,gn.gutters],"CodeMirror-scroll");gn.scroller.setAttribute("tabIndex","-1");gn.wrapper=f4("div",[gn.scrollbarFiller,gn.gutterFiller,gn.scroller],"CodeMirror");if(dL&&k<8){gn.gutters.style.zIndex=-1;gn.scroller.style.paddingRight=0}if(!c0&&!(co&&eh)){gn.scroller.draggable=true}if(gk){if(gk.appendChild){gk.appendChild(gn.wrapper)}else{gk(gn.wrapper)}}gn.viewFrom=gn.viewTo=gm.first;gn.reportedViewFrom=gn.reportedViewTo=gm.first;gn.view=[];gn.renderedView=null;gn.externalMeasured=null;gn.viewOffset=0;gn.lastWrapHeight=gn.lastWrapWidth=0;gn.updateLineNumbers=null;gn.nativeBarWidth=gn.barHeight=gn.barWidth=0;gn.scrollbarsClipped=false;gn.lineNumWidth=gn.lineNumInnerWidth=gn.lineNumChars=null;gn.alignWidgets=false;gn.cachedCharWidth=gn.cachedTextHeight=gn.cachedPaddingH=null;gn.maxLine=null;gn.maxLineLength=0;gn.maxLineChanged=false;gn.wheelDX=gn.wheelDY=gn.wheelStartX=gn.wheelStartY=null;gn.shift=false;gn.selForContextMenu=null;gn.activeTouch=null;gl.init(gn)}function br(gk){gk.doc.mode=H.getMode(gk.options,gk.doc.modeOption);em(gk)}function em(gk){gk.doc.iter(function(gl){if(gl.stateAfter){gl.stateAfter=null}if(gl.styles){gl.styles=null}});gk.doc.frontier=gk.doc.first;eg(gk,100);gk.state.modeGen++;if(gk.curOp){ah(gk)}}function eH(gk){if(gk.options.lineWrapping){fB(gk.display.wrapper,"CodeMirror-wrap");gk.display.sizer.style.minWidth="";gk.display.sizerWidth=null}else{f(gk.display.wrapper,"CodeMirror-wrap");h(gk)}X(gk);ah(gk);ak(gk);setTimeout(function(){eZ(gk)},100)}function be(gk){var gm=aY(gk.display),gl=gk.options.lineWrapping;var gn=gl&&Math.max(5,gk.display.scroller.clientWidth/dE(gk.display)-3);return function(gp){if(fx(gk.doc,gp)){return 0}var go=0;if(gp.widgets){for(var gq=0;gq<gp.widgets.length;gq++){if(gp.widgets[gq].height){go+=gp.widgets[gq].height}}}if(gl){return go+(Math.ceil(gp.text.length/gn)||1)*gm}else{return go+gm}}}function X(gk){var gm=gk.doc,gl=be(gk);gm.iter(function(gn){var go=gl(gn);if(go!=gn.height){f7(gn,go)}})}function cO(gk){gk.display.wrapper.className=gk.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+gk.options.theme.replace(/(^|\s)\s*/g," cm-s-");ak(gk)}function dx(gk){ed(gk);ah(gk);setTimeout(function(){eF(gk)},20)}function ed(gk){var gl=gk.display.gutters,gp=gk.options.gutters;d2(gl);for(var gm=0;gm<gp.length;++gm){var gn=gp[gm];var go=gl.appendChild(f4("div",null,"CodeMirror-gutter "+gn));if(gn=="CodeMirror-linenumbers"){gk.display.lineGutter=go;go.style.width=(gk.display.lineNumWidth||1)+"px"}}gl.style.display=gm?"":"none";c4(gk)}function c4(gk){var gl=gk.display.gutters.offsetWidth;gk.display.sizer.style.marginLeft=gl+"px"}function eo(gm){if(gm.height==0){return 0}var gl=gm.text.length,gk,go=gm;while(gk=eP(go)){var gn=gk.find(0,true);go=gn.from.line;gl+=gn.from.ch-gn.to.ch}go=gm;while(gk=ex(go)){var gn=gk.find(0,true);gl-=go.text.length-gn.from.ch;go=gn.to.line;gl+=go.text.length-gn.to.ch}return gl}function h(gk){var gm=gk.display,gl=gk.doc;gm.maxLine=fg(gl,gl.first);gm.maxLineLength=eo(gm.maxLine);gm.maxLineChanged=true;gl.iter(function(go){var gn=eo(go);if(gn>gm.maxLineLength){gm.maxLineLength=gn;gm.maxLine=go}})}function ce(gk){var gl=di(gk.gutters,"CodeMirror-linenumbers");if(gl==-1&&gk.lineNumbers){gk.gutters=gk.gutters.concat(["CodeMirror-linenumbers"])}else{if(gl>-1&&!gk.lineNumbers){gk.gutters=gk.gutters.slice(0);gk.gutters.splice(gl,1)}}}function dB(gk){var gn=gk.display,gm=gn.gutters.offsetWidth;var gl=Math.round(gk.doc.height+bI(gk.display));return{clientHeight:gn.scroller.clientHeight,viewHeight:gn.wrapper.clientHeight,scrollWidth:gn.scroller.scrollWidth,clientWidth:gn.scroller.clientWidth,viewWidth:gn.wrapper.clientWidth,barLeft:gk.options.fixedGutter?gm:0,docHeight:gl,scrollHeight:gl+cT(gk)+gn.barHeight,nativeBarWidth:gn.nativeBarWidth,gutterWidth:gm}}function dl(gm,gl,gk){this.cm=gk;var gn=this.vert=f4("div",[f4("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var go=this.horiz=f4("div",[f4("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");gm(gn);gm(go);bX(gn,"scroll",function(){if(gn.clientHeight){gl(gn.scrollTop,"vertical")}});bX(go,"scroll",function(){if(go.clientWidth){gl(go.scrollLeft,"horizontal")}});this.checkedOverlay=false;if(dL&&k<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}}dl.prototype=aN({update:function(gn){var go=gn.scrollWidth>gn.clientWidth+1;var gm=gn.scrollHeight>gn.clientHeight+1;var gp=gn.nativeBarWidth;if(gm){this.vert.style.display="block";this.vert.style.bottom=go?gp+"px":"0";var gl=gn.viewHeight-(go?gp:0);this.vert.firstChild.style.height=Math.max(0,gn.scrollHeight-gn.clientHeight+gl)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(go){this.horiz.style.display="block";this.horiz.style.right=gm?gp+"px":"0";this.horiz.style.left=gn.barLeft+"px";var gk=gn.viewWidth-gn.barLeft-(gm?gp:0);this.horiz.firstChild.style.width=(gn.scrollWidth-gn.clientWidth+gk)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedOverlay&&gn.clientHeight>0){if(gp==0){this.overlayHack()}this.checkedOverlay=true}return{right:gm?gp:0,bottom:go?gp:0}},setScrollLeft:function(gk){if(this.horiz.scrollLeft!=gk){this.horiz.scrollLeft=gk}},setScrollTop:function(gk){if(this.vert.scrollTop!=gk){this.vert.scrollTop=gk}},overlayHack:function(){var gk=b7&&!c7?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=gk;var gl=this;var gm=function(gn){if(L(gn)!=gl.vert&&L(gn)!=gl.horiz){c2(gl.cm,ev)(gn)}};bX(this.vert,"mousedown",gm);bX(this.horiz,"mousedown",gm)},clear:function(){var gk=this.horiz.parentNode;gk.removeChild(this.horiz);gk.removeChild(this.vert)}},dl.prototype);function e5(){}e5.prototype=aN({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},e5.prototype);H.scrollbarModel={"native":dl,"null":e5};function aD(gk){if(gk.display.scrollbars){gk.display.scrollbars.clear();if(gk.display.scrollbars.addClass){f(gk.display.wrapper,gk.display.scrollbars.addClass)}}gk.display.scrollbars=new H.scrollbarModel[gk.options.scrollbarStyle](function(gl){gk.display.wrapper.insertBefore(gl,gk.display.scrollbarFiller);bX(gl,"mousedown",function(){if(gk.state.focused){setTimeout(function(){gk.display.input.focus()},0)}});gl.setAttribute("cm-not-content","true")},function(gm,gl){if(gl=="horizontal"){bE(gk,gm)}else{N(gk,gm)}},gk);if(gk.display.scrollbars.addClass){fB(gk.display.wrapper,gk.display.scrollbars.addClass)}}function eZ(gm,go){if(!go){go=dB(gm)}var gl=gm.display.barWidth,gk=gm.display.barHeight;aU(gm,go);for(var gn=0;gn<4&&gl!=gm.display.barWidth||gk!=gm.display.barHeight;gn++){if(gl!=gm.display.barWidth&&gm.options.lineWrapping){a9(gm)}aU(gm,dB(gm));gl=gm.display.barWidth;gk=gm.display.barHeight}}function aU(gk,gl){var gn=gk.display;var gm=gn.scrollbars.update(gl);gn.sizer.style.paddingRight=(gn.barWidth=gm.right)+"px";gn.sizer.style.paddingBottom=(gn.barHeight=gm.bottom)+"px";if(gm.right&&gm.bottom){gn.scrollbarFiller.style.display="block";gn.scrollbarFiller.style.height=gm.bottom+"px";gn.scrollbarFiller.style.width=gm.right+"px"}else{gn.scrollbarFiller.style.display=""}if(gm.bottom&&gk.options.coverGutterNextToScrollbar&&gk.options.fixedGutter){gn.gutterFiller.style.display="block";gn.gutterFiller.style.height=gm.bottom+"px";gn.gutterFiller.style.width=gl.gutterWidth+"px"}else{gn.gutterFiller.style.display=""}}function b6(gn,gr,gm){var go=gm&&gm.top!=null?Math.max(0,gm.top):gn.scroller.scrollTop;go=Math.floor(go-e9(gn));var gk=gm&&gm.bottom!=null?gm.bottom:go+gn.wrapper.clientHeight;var gp=bG(gr,go),gq=bG(gr,gk);if(gm&&gm.ensure){var gl=gm.ensure.from.line,gs=gm.ensure.to.line;if(gl<gp){gp=gl;gq=bG(gr,bM(fg(gr,gl))+gn.wrapper.clientHeight)}else{if(Math.min(gs,gr.lastLine())>=gq){gp=bG(gr,bM(fg(gr,gs))-gn.wrapper.clientHeight);gq=gs}}}return{from:gp,to:Math.max(gq,gp+1)}}function eF(gs){var gq=gs.display,gr=gq.view;if(!gq.alignWidgets&&(!gq.gutters.firstChild||!gs.options.fixedGutter)){return}var go=dY(gq)-gq.scroller.scrollLeft+gs.doc.scrollLeft;var gk=gq.gutters.offsetWidth,gl=go+"px";for(var gn=0;gn<gr.length;gn++){if(!gr[gn].hidden){if(gs.options.fixedGutter&&gr[gn].gutter){gr[gn].gutter.style.left=gl}var gp=gr[gn].alignable;if(gp){for(var gm=0;gm<gp.length;gm++){gp[gm].style.left=gl}}}}if(gs.options.fixedGutter){gq.gutters.style.left=(go+gk)+"px"}}function d6(gk){if(!gk.options.lineNumbers){return false}var gp=gk.doc,gl=et(gk.options,gp.first+gp.size-1),go=gk.display;if(gl.length!=go.lineNumChars){var gq=go.measure.appendChild(f4("div",[f4("div",gl)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var gm=gq.firstChild.offsetWidth,gn=gq.offsetWidth-gm;go.lineGutter.style.width="";go.lineNumInnerWidth=Math.max(gm,go.lineGutter.offsetWidth-gn)+1;go.lineNumWidth=go.lineNumInnerWidth+gn;go.lineNumChars=go.lineNumInnerWidth?gl.length:-1;go.lineGutter.style.width=go.lineNumWidth+"px";c4(gk);return true}return false}function et(gk,gl){return String(gk.lineNumberFormatter(gl+gk.firstLineNumber))}function dY(gk){return gk.scroller.getBoundingClientRect().left-gk.sizer.getBoundingClientRect().left}function aI(gl,gk,gm){var gn=gl.display;this.viewport=gk;this.visible=b6(gn,gl.doc,gk);this.editorIsHidden=!gn.wrapper.offsetWidth;this.wrapperHeight=gn.wrapper.clientHeight;this.wrapperWidth=gn.wrapper.clientWidth;this.oldDisplayWidth=dm(gl);this.force=gm;this.dims=fe(gl);this.events=[]}aI.prototype.signal=function(gl,gk){if(fj(gl,gk)){this.events.push(arguments)}};aI.prototype.finish=function(){for(var gk=0;gk<this.events.length;gk++){aE.apply(null,this.events[gk])}};function J(gk){var gl=gk.display;if(!gl.scrollbarsClipped&&gl.scroller.offsetWidth){gl.nativeBarWidth=gl.scroller.offsetWidth-gl.scroller.clientWidth;gl.heightForcer.style.height=cT(gk)+"px";gl.sizer.style.marginBottom=-gl.nativeBarWidth+"px";gl.sizer.style.borderRightWidth=cT(gk)+"px";gl.scrollbarsClipped=true}}function B(gt,gn){var go=gt.display,gs=gt.doc;if(gn.editorIsHidden){ey(gt);return false}if(!gn.force&&gn.visible.from>=go.viewFrom&&gn.visible.to<=go.viewTo&&(go.updateLineNumbers==null||go.updateLineNumbers>=go.viewTo)&&go.renderedView==go.view&&dc(gt)==0){return false}if(d6(gt)){ey(gt);gn.dims=fe(gt)}var gm=gs.first+gs.size;var gq=Math.max(gn.visible.from-gt.options.viewportMargin,gs.first);var gr=Math.min(gm,gn.visible.to+gt.options.viewportMargin);if(go.viewFrom<gq&&gq-go.viewFrom<20){gq=Math.max(gs.first,go.viewFrom)}if(go.viewTo>gr&&go.viewTo-gr<20){gr=Math.min(gm,go.viewTo)}if(a7){gq=aW(gt.doc,gq);gr=d3(gt.doc,gr)}var gl=gq!=go.viewFrom||gr!=go.viewTo||go.lastWrapHeight!=gn.wrapperHeight||go.lastWrapWidth!=gn.wrapperWidth;cR(gt,gq,gr);go.viewOffset=bM(fg(gt.doc,go.viewFrom));gt.display.mover.style.top=go.viewOffset+"px";var gk=dc(gt);if(!gl&&gk==0&&!gn.force&&go.renderedView==go.view&&(go.updateLineNumbers==null||go.updateLineNumbers>=go.viewTo)){return false}var gp=dP();if(gk>4){go.lineDiv.style.display="none"}cm(gt,go.updateLineNumbers,gn.dims);if(gk>4){go.lineDiv.style.display=""}go.renderedView=go.view;if(gp&&dP()!=gp&&gp.offsetHeight){gp.focus()}d2(go.cursorDiv);d2(go.selectionDiv);go.gutters.style.height=go.sizer.style.minHeight=0;if(gl){go.lastWrapHeight=gn.wrapperHeight;go.lastWrapWidth=gn.wrapperWidth;eg(gt,400)}go.updateLineNumbers=null;return true}function cj(gl,go){var gk=go.viewport;for(var gn=true;;gn=false){if(!gn||!gl.options.lineWrapping||go.oldDisplayWidth==dm(gl)){if(gk&&gk.top!=null){gk={top:Math.min(gl.doc.height+bI(gl.display)-cV(gl),gk.top)}}go.visible=b6(gl.display,gl.doc,gk);if(go.visible.from>=gl.display.viewFrom&&go.visible.to<=gl.display.viewTo){break}}if(!B(gl,go)){break}a9(gl);var gm=dB(gl);bC(gl);dA(gl,gm);eZ(gl,gm)}go.signal(gl,"update",gl);if(gl.display.viewFrom!=gl.display.reportedViewFrom||gl.display.viewTo!=gl.display.reportedViewTo){go.signal(gl,"viewportChange",gl,gl.display.viewFrom,gl.display.viewTo);gl.display.reportedViewFrom=gl.display.viewFrom;gl.display.reportedViewTo=gl.display.viewTo}}function dU(gl,gk){var gn=new aI(gl,gk);if(B(gl,gn)){a9(gl);cj(gl,gn);var gm=dB(gl);bC(gl);dA(gl,gm);eZ(gl,gm);gn.finish()}}function dA(gk,gl){gk.display.sizer.style.minHeight=gl.docHeight+"px";var gm=gl.docHeight+gk.display.barHeight;gk.display.heightForcer.style.top=gm+"px";gk.display.gutters.style.height=Math.max(gm+cT(gk),gl.clientHeight)+"px"}function a9(gr){var gp=gr.display;var gl=gp.lineDiv.offsetTop;for(var gm=0;gm<gp.view.length;gm++){var gs=gp.view[gm],gt;if(gs.hidden){continue}if(dL&&k<8){var go=gs.node.offsetTop+gs.node.offsetHeight;gt=go-gl;gl=go}else{var gn=gs.node.getBoundingClientRect();gt=gn.bottom-gn.top}var gq=gs.line.height-gt;if(gt<2){gt=aY(gp)}if(gq>0.001||gq<-0.001){f7(gs.line,gt);cb(gs.line);if(gs.rest){for(var gk=0;gk<gs.rest.length;gk++){cb(gs.rest[gk])}}}}}function cb(gk){if(gk.widgets){for(var gl=0;gl<gk.widgets.length;++gl){gk.widgets[gl].height=gk.widgets[gl].node.offsetHeight}}}function fe(gk){var gp=gk.display,gn={},gm={};var go=gp.gutters.clientLeft;for(var gq=gp.gutters.firstChild,gl=0;gq;gq=gq.nextSibling,++gl){gn[gk.options.gutters[gl]]=gq.offsetLeft+gq.clientLeft+go;gm[gk.options.gutters[gl]]=gq.clientWidth}return{fixedPos:dY(gp),gutterTotalWidth:gp.gutters.offsetWidth,gutterLeft:gn,gutterWidth:gm,wrapperWidth:gp.wrapper.clientWidth}}function cm(gv,gm,gu){var gr=gv.display,gx=gv.options.lineNumbers;var gk=gr.lineDiv,gw=gk.firstChild;function gq(gz){var gy=gz.nextSibling;if(c0&&b7&&gv.display.currentWheelTarget==gz){gz.style.display="none"}else{gz.parentNode.removeChild(gz)}return gy}var gs=gr.view,gp=gr.viewFrom;for(var gn=0;gn<gs.length;gn++){var go=gs[gn];if(go.hidden){}else{if(!go.node||go.node.parentNode!=gk){var gl=aF(gv,go,gp,gu);gk.insertBefore(gl,gw)}else{while(gw!=go.node){gw=gq(gw)}var gt=gx&&gm!=null&&gm<=gp&&go.lineNumber;if(go.changes){if(di(go.changes,"gutter")>-1){gt=false}ab(gv,go,gp,gu)}if(gt){d2(go.lineNumber);go.lineNumber.appendChild(document.createTextNode(et(gv.options,gp)))}gw=go.node.nextSibling}}gp+=go.size}while(gw){gw=gq(gw)}}function ab(gk,gm,go,gp){for(var gl=0;gl<gm.changes.length;gl++){var gn=gm.changes[gl];if(gn=="text"){fm(gk,gm)}else{if(gn=="gutter"){dg(gk,gm,go,gp)}else{if(gn=="class"){dH(gm)}else{if(gn=="widget"){ao(gk,gm,gp)}}}}}gm.changes=null}function fI(gk){if(gk.node==gk.text){gk.node=f4("div",null,null,"position: relative");if(gk.text.parentNode){gk.text.parentNode.replaceChild(gk.node,gk.text)}gk.node.appendChild(gk.text);if(dL&&k<8){gk.node.style.zIndex=2}}return gk.node}function ew(gl){var gk=gl.bgClass?gl.bgClass+" "+(gl.line.bgClass||""):gl.line.bgClass;if(gk){gk+=" CodeMirror-linebackground"}if(gl.background){if(gk){gl.background.className=gk}else{gl.background.parentNode.removeChild(gl.background);gl.background=null}}else{if(gk){var gm=fI(gl);gl.background=gm.insertBefore(f4("div",null,gk),gm.firstChild)}}}function dW(gk,gl){var gm=gk.display.externalMeasured;if(gm&&gm.line==gl.line){gk.display.externalMeasured=null;gl.measure=gm.measure;return gm.built}return eS(gk,gl)}function fm(gk,gn){var gl=gn.text.className;var gm=dW(gk,gn);if(gn.text==gn.node){gn.node=gm.pre}gn.text.parentNode.replaceChild(gm.pre,gn.text);gn.text=gm.pre;if(gm.bgClass!=gn.bgClass||gm.textClass!=gn.textClass){gn.bgClass=gm.bgClass;gn.textClass=gm.textClass;dH(gn)}else{if(gl){gn.text.className=gl}}}function dH(gl){ew(gl);if(gl.line.wrapClass){fI(gl).className=gl.line.wrapClass}else{if(gl.node!=gl.text){gl.node.className=""}}var gk=gl.textClass?gl.textClass+" "+(gl.line.textClass||""):gl.line.textClass;gl.text.className=gk||""}function dg(gs,gq,gp,gr){if(gq.gutter){gq.node.removeChild(gq.gutter);gq.gutter=null}if(gq.gutterBackground){gq.node.removeChild(gq.gutterBackground);gq.gutterBackground=null}if(gq.line.gutterClass){var gl=fI(gq);gq.gutterBackground=f4("div",null,"CodeMirror-gutter-background "+gq.line.gutterClass,"left: "+(gs.options.fixedGutter?gr.fixedPos:-gr.gutterTotalWidth)+"px; width: "+gr.gutterTotalWidth+"px");gl.insertBefore(gq.gutterBackground,gq.text)}var gn=gq.line.gutterMarkers;if(gs.options.lineNumbers||gn){var gl=fI(gq);var go=gq.gutter=f4("div",null,"CodeMirror-gutter-wrapper","left: "+(gs.options.fixedGutter?gr.fixedPos:-gr.gutterTotalWidth)+"px");gs.display.input.setUneditable(go);gl.insertBefore(go,gq.text);if(gq.line.gutterClass){go.className+=" "+gq.line.gutterClass}if(gs.options.lineNumbers&&(!gn||!gn["CodeMirror-linenumbers"])){gq.lineNumber=go.appendChild(f4("div",et(gs.options,gp),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+gr.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+gs.display.lineNumInnerWidth+"px"))}if(gn){for(var gm=0;gm<gs.options.gutters.length;++gm){var gk=gs.options.gutters[gm],gt=gn.hasOwnProperty(gk)&&gn[gk];if(gt){go.appendChild(f4("div",[gt],"CodeMirror-gutter-elt","left: "+gr.gutterLeft[gk]+"px; width: "+gr.gutterWidth[gk]+"px"))}}}}}function ao(gk,gl,go){if(gl.alignable){gl.alignable=null}for(var gn=gl.node.firstChild,gm;gn;gn=gm){var gm=gn.nextSibling;if(gn.className=="CodeMirror-linewidget"){gl.node.removeChild(gn)}}fu(gk,gl,go)}function aF(gk,gm,gn,go){var gl=dW(gk,gm);gm.text=gm.node=gl.pre;if(gl.bgClass){gm.bgClass=gl.bgClass}if(gl.textClass){gm.textClass=gl.textClass}dH(gm);dg(gk,gm,gn,go);fu(gk,gm,go);return gm.node}function fu(gk,gm,gn){f9(gk,gm.line,gm,gn,true);if(gm.rest){for(var gl=0;gl<gm.rest.length;gl++){f9(gk,gm.rest[gl],gm,gn,false)}}}function f9(gs,gt,gp,gr,gn){if(!gt.widgets){return}var gk=fI(gp);for(var gm=0,gq=gt.widgets;gm<gq.length;++gm){var go=gq[gm],gl=f4("div",[go.node],"CodeMirror-linewidget");if(!go.handleMouseEvents){gl.setAttribute("cm-ignore-events","true")}bF(go,gl,gp,gr);gs.display.input.setUneditable(gl);if(gn&&go.above){gk.insertBefore(gl,gp.gutter||gp.text)}else{gk.appendChild(gl)}ae(go,"redraw")}}function bF(gn,gm,gk,go){if(gn.noHScroll){(gk.alignable||(gk.alignable=[])).push(gm);var gl=go.wrapperWidth;gm.style.left=go.fixedPos+"px";if(!gn.coverGutter){gl-=go.gutterTotalWidth;gm.style.paddingLeft=go.gutterTotalWidth+"px"}gm.style.width=gl+"px"}if(gn.coverGutter){gm.style.zIndex=5;gm.style.position="relative";if(!gn.noHScroll){gm.style.marginLeft=-go.gutterTotalWidth+"px"}}}var W=H.Pos=function(gk,gl){if(!(this instanceof W)){return new W(gk,gl)}this.line=gk;this.ch=gl};var cf=H.cmpPos=function(gl,gk){return gl.line-gk.line||gl.ch-gk.ch};function ci(gk){return W(gk.line,gk.ch)}function bx(gl,gk){return cf(gl,gk)<0?gk:gl}function ar(gl,gk){return cf(gl,gk)<0?gl:gk}function r(gk){if(!gk.state.focused){gk.display.input.focus();cB(gk)}}function aj(gk){return gk.options.readOnly||gk.doc.cantEdit}var bm=null;function f0(gy,go,gm,gl,gx){var gw=gy.doc;gy.display.shift=false;if(!gl){gl=gw.sel}var gn=gy.state.pasteIncoming||gx=="paste";var gr=gw.splitLines(go),gk=null;if(gn&&gl.ranges.length>1){if(bm&&bm.join("\n")==go){if(gl.ranges.length%bm.length==0){gk=[];for(var gp=0;gp<bm.length;gp++){gk.push(gw.splitLines(bm[gp]))}}}else{if(gr.length==gl.ranges.length){gk=bS(gr,function(gz){return[gz]})}}}for(var gp=gl.ranges.length-1;gp>=0;gp--){var gq=gl.ranges[gp];var gv=gq.from(),gu=gq.to();if(gq.empty()){if(gm&&gm>0){gv=W(gv.line,gv.ch-gm)}else{if(gy.state.overwrite&&!gn){gu=W(gu.line,Math.min(fg(gw,gu.line).text.length,gu.ch+fH(gr).length))}}}var gs=gy.curOp.updateInput;var gt={from:gv,to:gu,text:gk?gk[gp%gk.length]:gr,origin:gx||(gn?"paste":gy.state.cutIncoming?"cut":"+input")};bg(gy.doc,gt);ae(gy,"inputRead",gy,gt)}if(go&&!gn){fX(gy,go)}fG(gy);gy.curOp.updateInput=gs;gy.curOp.typing=true;gy.state.pasteIncoming=gy.state.cutIncoming=false}function ba(gm,gk){var gl=gm.clipboardData&&gm.clipboardData.getData("text/plain");if(gl){gm.preventDefault();if(!aj(gk)&&!gk.options.disableInput){cM(gk,function(){f0(gk,gl,0,null,"paste")})}return true}}function fX(gk,go){if(!gk.options.electricChars||!gk.options.smartIndent){return}var gp=gk.doc.sel;for(var gn=gp.ranges.length-1;gn>=0;gn--){var gl=gp.ranges[gn];if(gl.head.ch>100||(gn&&gp.ranges[gn-1].head.line==gl.head.line)){continue}var gq=gk.getModeAt(gl.head);var gr=false;if(gq.electricChars){for(var gm=0;gm<gq.electricChars.length;gm++){if(go.indexOf(gq.electricChars.charAt(gm))>-1){gr=ad(gk,gl.head.line,"smart");break}}}else{if(gq.electricInput){if(gq.electricInput.test(fg(gk.doc,gl.head.line).text.slice(0,gl.head.ch))){gr=ad(gk,gl.head.line,"smart")}}}if(gr){ae(gk,"electricInput",gk,gl.head.line)}}}function dk(gk){var gp=[],gm=[];for(var gn=0;gn<gk.doc.sel.ranges.length;gn++){var gl=gk.doc.sel.ranges[gn].head.line;var go={anchor:W(gl,0),head:W(gl+1,0)};gm.push(go);gp.push(gk.getRange(go.anchor,go.head))}return{text:gp,ranges:gm}}function fQ(gk){gk.setAttribute("autocorrect","off");gk.setAttribute("autocapitalize","off");gk.setAttribute("spellcheck","false")}function Y(gk){this.cm=gk;this.prevInput="";this.pollingFast=false;this.polling=new gj();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null}function aX(){var gk=f4("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");var gl=f4("div",[gk],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(c0){gk.style.width="1000px"}else{gk.setAttribute("wrap","off")}if(e2){gk.style.border="1px solid black"}fQ(gk);return gl}Y.prototype=aN({init:function(gm){var gl=this,gk=this.cm;var gp=this.wrapper=aX();var gn=this.textarea=gp.firstChild;gm.wrapper.insertBefore(gp,gm.wrapper.firstChild);if(e2){gn.style.width="0px"}bX(gn,"input",function(){if(dL&&k>=9&&gl.hasSelection){gl.hasSelection=null}gl.poll()});bX(gn,"paste",function(gq){if(ba(gq,gk)){return true}gk.state.pasteIncoming=true;gl.fastPoll()});function go(gr){if(gk.somethingSelected()){bm=gk.getSelections();if(gl.inaccurateSelection){gl.prevInput="";gl.inaccurateSelection=false;gn.value=bm.join("\n");dM(gn)}}else{if(!gk.options.lineWiseCopyCut){return}else{var gq=dk(gk);bm=gq.text;if(gr.type=="cut"){gk.setSelections(gq.ranges,null,Z)}else{gl.prevInput="";gn.value=gq.text.join("\n");dM(gn)}}}if(gr.type=="cut"){gk.state.cutIncoming=true}}bX(gn,"cut",go);bX(gn,"copy",go);bX(gm.scroller,"paste",function(gq){if(bb(gm,gq)){return}gk.state.pasteIncoming=true;gl.focus()});bX(gm.lineSpace,"selectstart",function(gq){if(!bb(gm,gq)){cG(gq)}});bX(gn,"compositionstart",function(){var gq=gk.getCursor("from");if(gl.composing){gl.composing.range.clear()}gl.composing={start:gq,range:gk.markText(gq,gk.getCursor("to"),{className:"CodeMirror-composing"})}});bX(gn,"compositionend",function(){if(gl.composing){gl.poll();gl.composing.range.clear();gl.composing=null}})},prepareSelection:function(){var gl=this.cm,gp=gl.display,go=gl.doc;var gk=fJ(gl);if(gl.options.moveInputWithCursor){var gq=dV(gl,go.sel.primary().head,"div");var gm=gp.wrapper.getBoundingClientRect(),gn=gp.lineDiv.getBoundingClientRect();gk.teTop=Math.max(0,Math.min(gp.wrapper.clientHeight-10,gq.top+gn.top-gm.top));gk.teLeft=Math.max(0,Math.min(gp.wrapper.clientWidth-10,gq.left+gn.left-gm.left))}return gk},showSelection:function(gm){var gk=this.cm,gl=gk.display;bR(gl.cursorDiv,gm.cursors);bR(gl.selectionDiv,gm.selection);if(gm.teTop!=null){this.wrapper.style.top=gm.teTop+"px";this.wrapper.style.left=gm.teLeft+"px"}},reset:function(go){if(this.contextMenuPending){return}var gl,gn,gk=this.cm,gq=gk.doc;if(gk.somethingSelected()){this.prevInput="";var gm=gq.sel.primary();gl=da&&(gm.to().line-gm.from().line>100||(gn=gk.getSelection()).length>1000);var gp=gl?"-":gn||gk.getSelection();this.textarea.value=gp;if(gk.state.focused){dM(this.textarea)}if(dL&&k>=9){this.hasSelection=gp}}else{if(!go){this.prevInput=this.textarea.value="";if(dL&&k>=9){this.hasSelection=null}}}this.inaccurateSelection=gl},getField:function(){return this.textarea},supportsTouch:function(){return false},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!eh||dP()!=this.textarea)){try{this.textarea.focus()}catch(gk){}}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var gk=this;if(gk.pollingFast){return}gk.polling.set(this.cm.options.pollInterval,function(){gk.poll();if(gk.cm.state.focused){gk.slowPoll()}})},fastPoll:function(){var gl=false,gk=this;gk.pollingFast=true;function gm(){var gn=gk.poll();if(!gn&&!gl){gl=true;gk.polling.set(60,gm)}else{gk.pollingFast=false;gk.slowPoll()}}gk.polling.set(20,gm)},poll:function(){var gk=this.cm,gn=this.textarea,go=this.prevInput;if(this.contextMenuPending||!gk.state.focused||(bs(gn)&&!go&&!this.composing)||aj(gk)||gk.options.disableInput||gk.state.keySeq){return false}var gq=gn.value;if(gq==go&&!gk.somethingSelected()){return false}if(dL&&k>=9&&this.hasSelection===gq||b7&&/[\uf700-\uf7ff]/.test(gq)){gk.display.input.reset();return false}if(gk.doc.sel==gk.display.selForContextMenu){var gp=gq.charCodeAt(0);if(gp==8203&&!go){go="\u200b"}if(gp==8666){this.reset();return this.cm.execCommand("undo")}}var gr=0,gl=Math.min(go.length,gq.length);while(gr<gl&&go.charCodeAt(gr)==gq.charCodeAt(gr)){++gr}var gm=this;cM(gk,function(){f0(gk,gq.slice(gr),go.length-gr,null,gm.composing?"*compose":null);if(gq.length>1000||gq.indexOf("\n")>-1){gn.value=gm.prevInput=""}else{gm.prevInput=gq}if(gm.composing){gm.composing.range.clear();gm.composing.range=gk.markText(gm.composing.start,gk.getCursor("to"),{className:"CodeMirror-composing"})}});return true},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}},onKeyPress:function(){if(dL&&k>=9){this.hasSelection=null}this.fastPoll()},onContextMenu:function(gp){var gu=this,gv=gu.cm,gr=gv.display,gl=gu.textarea;var gt=cn(gv,gp),gk=gr.scroller.scrollTop;if(!gt||d4){return}var go=gv.options.resetSelectionOnContextMenu;if(go&&gv.doc.sel.contains(gt)==-1){c2(gv,bU)(gv.doc,eT(gt),Z)}var gq=gl.style.cssText;gu.wrapper.style.position="absolute";gl.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(gp.clientY-5)+"px; left: "+(gp.clientX-5)+"px; z-index: 1000; background: "+(dL?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(c0){var gw=window.scrollY}gr.input.focus();if(c0){window.scrollTo(null,gw)}gr.input.reset();if(!gv.somethingSelected()){gl.value=gu.prevInput=" "}gu.contextMenuPending=true;gr.selForContextMenu=gv.doc.sel;clearTimeout(gr.detectingSelectAll);function gn(){if(gl.selectionStart!=null){var gx=gv.somethingSelected();var gy="\u200b"+(gx?gl.value:"");gl.value="\u21da";gl.value=gy;gu.prevInput=gx?"":"\u200b";gl.selectionStart=1;gl.selectionEnd=gy.length;gr.selForContextMenu=gv.doc.sel}}function gs(){gu.contextMenuPending=false;gu.wrapper.style.position="relative";gl.style.cssText=gq;if(dL&&k<9){gr.scrollbars.setScrollTop(gr.scroller.scrollTop=gk)}if(gl.selectionStart!=null){if(!dL||(dL&&k<9)){gn()}var gx=0,gy=function(){if(gr.selForContextMenu==gv.doc.sel&&gl.selectionStart==0&&gl.selectionEnd>0&&gu.prevInput=="\u200b"){c2(gv,eE.selectAll)(gv)}else{if(gx++<10){gr.detectingSelectAll=setTimeout(gy,500)}else{gr.input.reset()}}};gr.detectingSelectAll=setTimeout(gy,200)}}if(dL&&k>=9){gn()}if(gb){es(gp);var gm=function(){ee(window,"mouseup",gm);setTimeout(gs,20)};bX(window,"mouseup",gm)}else{setTimeout(gs,50)}},readOnlyChanged:function(gk){if(!gk){this.reset()}},setUneditable:fW,needsContentAttribute:false},Y.prototype);function dw(gk){this.cm=gk;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new gj();this.gracePeriod=false}dw.prototype=aN({init:function(gn){var gm=this,gk=gm.cm;var go=gm.div=gn.lineDiv;fQ(go);bX(go,"paste",function(gp){ba(gp,gk)});bX(go,"compositionstart",function(gt){var gs=gt.data;gm.composing={sel:gk.doc.sel,data:gs,startData:gs};if(!gs){return}var gq=gk.doc.sel.primary();var gp=gk.getLine(gq.head.line);var gr=gp.indexOf(gs,Math.max(0,gq.head.ch-gs.length));if(gr>-1&&gr<=gq.head.ch){gm.composing.sel=eT(W(gq.head.line,gr),W(gq.head.line,gr+gs.length))}});bX(go,"compositionupdate",function(gp){gm.composing.data=gp.data});bX(go,"compositionend",function(gq){var gp=gm.composing;if(!gp){return}if(gq.data!=gp.startData&&!/\u200b/.test(gq.data)){gp.data=gq.data}setTimeout(function(){if(!gp.handled){gm.applyComposition(gp)}if(gm.composing==gp){gm.composing=null}},50)});bX(go,"touchstart",function(){gm.forceCompositionEnd()});bX(go,"input",function(){if(gm.composing){return}if(aj(gk)||!gm.pollContent()){cM(gm.cm,function(){ah(gk)})}});function gl(gs){if(gk.somethingSelected()){bm=gk.getSelections();if(gs.type=="cut"){gk.replaceSelection("",null,"cut")}}else{if(!gk.options.lineWiseCopyCut){return}else{var gq=dk(gk);bm=gq.text;if(gs.type=="cut"){gk.operation(function(){gk.setSelections(gq.ranges,0,Z);gk.replaceSelection("",null,"cut")})}}}if(gs.clipboardData&&!e2){gs.preventDefault();gs.clipboardData.clearData();gs.clipboardData.setData("text/plain",bm.join("\n"))}else{var gr=aX(),gt=gr.firstChild;gk.display.lineSpace.insertBefore(gr,gk.display.lineSpace.firstChild);gt.value=bm.join("\n");var gp=document.activeElement;dM(gt);setTimeout(function(){gk.display.lineSpace.removeChild(gr);gp.focus()},50)}}bX(go,"copy",gl);bX(go,"cut",gl)},prepareSelection:function(){var gk=fJ(this.cm,false);gk.focus=this.cm.state.focused;return gk},showSelection:function(gk){if(!gk||!this.cm.display.view.length){return}if(gk.focus){this.showPrimarySelection()}this.showMultipleSelections(gk)},showPrimarySelection:function(){var go=window.getSelection(),gr=this.cm.doc.sel.primary();var gp=az(this.cm,go.anchorNode,go.anchorOffset);var gt=az(this.cm,go.focusNode,go.focusOffset);if(gp&&!gp.bad&&gt&&!gt.bad&&cf(ar(gp,gt),gr.from())==0&&cf(bx(gp,gt),gr.to())==0){return}var gn=cz(this.cm,gr.from());var gs=cz(this.cm,gr.to());if(!gn&&!gs){return}var gv=this.cm.display.view;var gq=go.rangeCount&&go.getRangeAt(0);if(!gn){gn={node:gv[0].measure.map[2],offset:0}}else{if(!gs){var gm=gv[gv.length-1].measure;var gl=gm.maps?gm.maps[gm.maps.length-1]:gm.map;gs={node:gl[gl.length-1],offset:gl[gl.length-2]-gl[gl.length-3]}}}try{var gk=cl(gn.node,gn.offset,gs.offset,gs.node)}catch(gu){}if(gk){go.removeAllRanges();go.addRange(gk);if(gq&&go.anchorNode==null){go.addRange(gq)}else{if(co){this.startGracePeriod()}}}this.rememberSelection()},startGracePeriod:function(){var gk=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){gk.gracePeriod=false;if(gk.selectionChanged()){gk.cm.operation(function(){gk.cm.curOp.selectionChanged=true})}},20)},showMultipleSelections:function(gk){bR(this.cm.display.cursorDiv,gk.cursors);bR(this.cm.display.selectionDiv,gk.selection)},rememberSelection:function(){var gk=window.getSelection();this.lastAnchorNode=gk.anchorNode;this.lastAnchorOffset=gk.anchorOffset;this.lastFocusNode=gk.focusNode;this.lastFocusOffset=gk.focusOffset},selectionInEditor:function(){var gl=window.getSelection();if(!gl.rangeCount){return false}var gk=gl.getRangeAt(0).commonAncestorContainer;return gc(this.div,gk)},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus()}},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return true},receivedFocus:function(){var gk=this;if(this.selectionInEditor()){this.pollSelection()}else{cM(this.cm,function(){gk.cm.curOp.selectionChanged=true})}function gl(){if(gk.cm.state.focused){gk.pollSelection();gk.polling.set(gk.cm.options.pollInterval,gl)}}this.polling.set(this.cm.options.pollInterval,gl)},selectionChanged:function(){var gk=window.getSelection();return gk.anchorNode!=this.lastAnchorNode||gk.anchorOffset!=this.lastAnchorOffset||gk.focusNode!=this.lastFocusNode||gk.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var gn=window.getSelection(),gk=this.cm;this.rememberSelection();var gl=az(gk,gn.anchorNode,gn.anchorOffset);var gm=az(gk,gn.focusNode,gn.focusOffset);if(gl&&gm){cM(gk,function(){bU(gk.doc,eT(gl,gm),Z);if(gl.bad||gm.bad){gk.curOp.selectionChanged=true}})}}},pollContent:function(){var gu=this.cm,gE=gu.display,gC=gu.doc.sel.primary();var gD=gC.from(),go=gC.to();if(gD.line<gE.viewFrom||go.line>gE.viewTo-1){return false}var gr;if(gD.line==gE.viewFrom||(gr=ds(gu,gD.line))==0){var gp=bN(gE.view[0].line);var gt=gE.view[0].node}else{var gp=bN(gE.view[gr].line);var gt=gE.view[gr-1].node.nextSibling}var gB=ds(gu,go.line);if(gB==gE.view.length-1){var gw=gE.viewTo-1;var gz=gE.lineDiv.lastChild}else{var gw=bN(gE.view[gB+1].line)-1;var gz=gE.view[gB+1].node.previousSibling}var gF=gu.doc.splitLines(f1(gu,gt,gz,gp,gw));var gy=f6(gu.doc,W(gp,0),W(gw,fg(gu.doc,gw).text.length));while(gF.length>1&&gy.length>1){if(fH(gF)==fH(gy)){gF.pop();gy.pop();gw--}else{if(gF[0]==gy[0]){gF.shift();gy.shift();gp++}else{break}}}var gA=0,gm=0;var gv=gF[0],gl=gy[0],gk=Math.min(gv.length,gl.length);while(gA<gk&&gv.charCodeAt(gA)==gl.charCodeAt(gA)){++gA}var gs=fH(gF),gG=fH(gy);var gn=Math.min(gs.length-(gF.length==1?gA:0),gG.length-(gy.length==1?gA:0));while(gm<gn&&gs.charCodeAt(gs.length-gm-1)==gG.charCodeAt(gG.length-gm-1)){++gm}gF[gF.length-1]=gs.slice(0,gs.length-gm);gF[0]=gF[0].slice(gA);var gq=W(gp,gA);var gx=W(gw,gy.length?fH(gy).length-gm:0);if(gF.length>1||gF[0]||cf(gq,gx)){a1(gu.doc,gF,gq,gx,"+input");return true}},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus()},applyComposition:function(gk){if(aj(this.cm)){c2(this.cm,ah)(this.cm)}else{if(gk.data&&gk.data!=gk.startData){c2(this.cm,f0)(this.cm,gk.data,0,gk.sel)}}},setUneditable:function(gk){gk.contentEditable="false"},onKeyPress:function(gk){gk.preventDefault();if(!aj(this.cm)){c2(this.cm,f0)(this.cm,String.fromCharCode(gk.charCode==null?gk.keyCode:gk.charCode),0)}},readOnlyChanged:function(gk){this.div.contentEditable=String(gk!="nocursor")},onContextMenu:fW,resetPosition:fW,needsContentAttribute:true},dw.prototype);function cz(gq,go){var gp=fc(gq,go.line);if(!gp||gp.hidden){return null}var gs=fg(gq.doc,go.line);var gl=ct(gp,gs,go.line);var gm=a(gs),gn="left";if(gm){var gk=aG(gm,go.ch);gn=gk%2?"right":"left"}var gr=aL(gl.map,go.ch,gn);gr.offset=gr.collapse=="right"?gr.end:gr.start;return gr}function eu(gl,gk){if(gk){gl.bad=true}return gl}function az(gk,gn,gp){var go;if(gn==gk.display.lineDiv){go=gk.display.lineDiv.childNodes[gp];if(!go){return eu(gk.clipPos(W(gk.display.viewTo-1)),true)}gn=null;gp=0}else{for(go=gn;;go=go.parentNode){if(!go||go==gk.display.lineDiv){return null}if(go.parentNode&&go.parentNode==gk.display.lineDiv){break}}}for(var gm=0;gm<gk.display.view.length;gm++){var gl=gk.display.view[gm];if(gl.node==go){return aa(gl,gn,gp)}}}function aa(gs,go,gq){var gm=gs.text.firstChild,gn=false;if(!go||!gc(gm,go)){return eu(W(bN(gs.line),0),true)}if(go==gm){gn=true;go=gm.childNodes[gq];gq=0;if(!go){var gy=gs.rest?fH(gs.rest):gs.line;return eu(W(bN(gy),gy.text.length),gn)}}var gp=go.nodeType==3?go:null,gw=go;if(!gp&&go.childNodes.length==1&&go.firstChild.nodeType==3){gp=go.firstChild;if(gq){gq=gp.nodeValue.length}}while(gw.parentNode!=gm){gw=gw.parentNode}var gl=gs.measure,gu=gl.maps;function gr(gB,gG,gD){for(var gF=-1;gF<(gu?gu.length:0);gF++){var gA=gF<0?gl.map:gu[gF];for(var gE=0;gE<gA.length;gE+=3){var gC=gA[gE+2];if(gC==gB||gC==gG){var gH=bN(gF<0?gs.line:gs.rest[gF]);var gz=gA[gE]+gD;if(gD<0||gC!=gB){gz=gA[gE+(gD?1:0)]}return W(gH,gz)}}}}var gx=gr(gp,gw,gq);if(gx){return eu(gx,gn)}for(var gk=gw.nextSibling,gt=gp?gp.nodeValue.length-gq:0;gk;gk=gk.nextSibling){gx=gr(gk,gk.firstChild,0);if(gx){return eu(W(gx.line,gx.ch-gt),gn)}else{gt+=gk.textContent.length}}for(var gv=gw.previousSibling,gt=gq;gv;gv=gv.previousSibling){gx=gr(gv,gv.firstChild,-1);if(gx){return eu(W(gx.line,gx.ch+gt),gn)}else{gt+=gk.textContent.length}}}function f1(gs,gq,gr,gn,gl){var gt="",gm=false,gk=gs.doc.lineSeparator();function go(gu){return function(gv){return gv.id==gu}}function gp(gy){if(gy.nodeType==1){var gv=gy.getAttribute("cm-text");if(gv!=null){if(gv==""){gv=gy.textContent.replace(/\u200b/g,"")}gt+=gv;return}var gx=gy.getAttribute("cm-marker"),gu;if(gx){var gz=gs.findMarks(W(gn,0),W(gl+1,0),go(+gx));if(gz.length&&(gu=gz[0].find())){gt+=f6(gs.doc,gu.from,gu.to).join(gk)}return}if(gy.getAttribute("contenteditable")=="false"){return}for(var gw=0;gw<gy.childNodes.length;gw++){gp(gy.childNodes[gw])}if(/^(pre|div|p)$/i.test(gy.nodeName)){gm=true}}else{if(gy.nodeType==3){var gA=gy.nodeValue;if(!gA){return}if(gm){gt+=gk;gm=false}gt+=gA}}}for(;;){gp(gq);if(gq==gr){break}gq=gq.nextSibling}return gt}H.inputStyles={textarea:Y,contenteditable:dw};function f5(gk,gl){this.ranges=gk;this.primIndex=gl}f5.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(gk){if(gk==this){return true}if(gk.primIndex!=this.primIndex||gk.ranges.length!=this.ranges.length){return false}for(var gm=0;gm<this.ranges.length;gm++){var gl=this.ranges[gm],gn=gk.ranges[gm];if(cf(gl.anchor,gn.anchor)!=0||cf(gl.head,gn.head)!=0){return false}}return true},deepCopy:function(){for(var gk=[],gl=0;gl<this.ranges.length;gl++){gk[gl]=new dZ(ci(this.ranges[gl].anchor),ci(this.ranges[gl].head))}return new f5(gk,this.primIndex)},somethingSelected:function(){for(var gk=0;gk<this.ranges.length;gk++){if(!this.ranges[gk].empty()){return true}}return false},contains:function(gn,gk){if(!gk){gk=gn}for(var gm=0;gm<this.ranges.length;gm++){var gl=this.ranges[gm];if(cf(gk,gl.from())>=0&&cf(gn,gl.to())<=0){return gm}}return -1}};function dZ(gk,gl){this.anchor=gk;this.head=gl}dZ.prototype={from:function(){return ar(this.anchor,this.head)},to:function(){return bx(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cw(gk,gr){var gm=gk[gr];gk.sort(function(gu,gt){return cf(gu.from(),gt.from())});gr=di(gk,gm);for(var go=1;go<gk.length;go++){var gs=gk[go],gl=gk[go-1];if(cf(gl.to(),gs.from())>=0){var gp=ar(gl.from(),gs.from()),gq=bx(gl.to(),gs.to());var gn=gl.empty()?gs.from()==gs.head:gl.from()==gl.head;if(go<=gr){--gr}gk.splice(--go,2,new dZ(gn?gq:gp,gn?gp:gq))}}return new f5(gk,gr)}function eT(gk,gl){return new f5([new dZ(gk,gl||gk)],0)}function c5(gk,gl){return Math.max(gk.first,Math.min(gl,gk.first+gk.size-1))}function fK(gl,gm){if(gm.line<gl.first){return W(gl.first,0)}var gk=gl.first+gl.size-1;if(gm.line>gk){return W(gk,fg(gl,gk).text.length)}return ft(gm,fg(gl,gm.line).text.length)}function ft(gm,gl){var gk=gm.ch;if(gk==null||gk>gl){return W(gm.line,gl)}else{if(gk<0){return W(gm.line,0)}else{return gm}}}function b9(gl,gk){return gk>=gl.first&&gk<gl.first+gl.size}function d1(gm,gn){for(var gk=[],gl=0;gl<gn.length;gl++){gk[gl]=fK(gm,gn[gl])}return gk}function fw(gp,gl,go,gk){if(gp.cm&&gp.cm.display.shift||gp.extend){var gn=gl.anchor;if(gk){var gm=cf(go,gn)<0;if(gm!=(cf(gk,gn)<0)){gn=go;go=gk}else{if(gm!=(cf(go,gk)<0)){go=gk}}}return new dZ(gn,go)}else{return new dZ(gk||go,go)}}function fY(gn,gm,gk,gl){bU(gn,new f5([fw(gn,gn.sel.primary(),gm,gk)],0),gl)}function aw(gp,go,gm){for(var gl=[],gn=0;gn<gp.sel.ranges.length;gn++){gl[gn]=fw(gp,gp.sel.ranges[gn],go[gn],null)}var gk=cw(gl,gp.sel.primIndex);bU(gp,gk,gm)}function e(go,gn,gl,gm){var gk=go.sel.ranges.slice(0);gk[gn]=gl;bU(go,cw(gk,go.sel.primIndex),gm)}function F(gn,gl,gm,gk){bU(gn,eT(gl,gm),gk)}function c(gm,gk){var gl={ranges:gk.ranges,update:function(gn){this.ranges=[];for(var go=0;go<gn.length;go++){this.ranges[go]=new dZ(fK(gm,gn[go].anchor),fK(gm,gn[go].head))}}};aE(gm,"beforeSelectionChange",gm,gl);if(gm.cm){aE(gm.cm,"beforeSelectionChange",gm.cm,gl)}if(gl.ranges!=gk.ranges){return cw(gl.ranges,gl.ranges.length-1)}else{return gk}}function e8(go,gn,gl){var gk=go.history.done,gm=fH(gk);if(gm&&gm.ranges){gk[gk.length-1]=gn;eq(go,gn,gl)}else{bU(go,gn,gl)}}function bU(gm,gl,gk){eq(gm,gl,gk);gd(gm,gm.sel,gm.cm?gm.cm.curOp.id:NaN,gk)}function eq(gn,gm,gl){if(fj(gn,"beforeSelectionChange")||gn.cm&&fj(gn.cm,"beforeSelectionChange")){gm=c(gn,gm)}var gk=gl&&gl.bias||(cf(gm.primary().head,gn.sel.primary().head)<0?-1:1);c9(gn,n(gn,gm,gk,true));if(!(gl&&gl.scroll===false)&&gn.cm){fG(gn.cm)}}function c9(gl,gk){if(gk.equals(gl.sel)){return}gl.sel=gk;if(gl.cm){gl.cm.curOp.updateInput=gl.cm.curOp.selectionChanged=true;V(gl.cm)}ae(gl,"cursorActivity",gl)}function ez(gk){c9(gk,n(gk,gk.sel,null,false),Z)}function n(gs,gk,gp,gq){var gm;for(var gn=0;gn<gk.ranges.length;gn++){var go=gk.ranges[gn];var gr=bV(gs,go.anchor,gp,gq);var gl=bV(gs,go.head,gp,gq);if(gm||gr!=go.anchor||gl!=go.head){if(!gm){gm=gk.ranges.slice(0,gn)}gm[gn]=new dZ(gr,gl)}}return gm?cw(gm,gk.primIndex):gk}function bV(gt,gs,gp,gq){var gu=false,gm=gs;var gn=gp||1;gt.cantEdit=false;search:for(;;){var gv=fg(gt,gm.line);if(gv.markedSpans){for(var go=0;go<gv.markedSpans.length;++go){var gk=gv.markedSpans[go],gl=gk.marker;if((gk.from==null||(gl.inclusiveLeft?gk.from<=gm.ch:gk.from<gm.ch))&&(gk.to==null||(gl.inclusiveRight?gk.to>=gm.ch:gk.to>gm.ch))){if(gq){aE(gl,"beforeCursorEnter");if(gl.explicitlyCleared){if(!gv.markedSpans){break}else{--go;continue}}}if(!gl.atomic){continue}var gr=gl.find(gn<0?-1:1);if(cf(gr,gm)==0){gr.ch+=gn;if(gr.ch<0){if(gr.line>gt.first){gr=fK(gt,W(gr.line-1))}else{gr=null}}else{if(gr.ch>gv.text.length){if(gr.line<gt.first+gt.size-1){gr=W(gr.line+1,0)}else{gr=null}}}if(!gr){if(gu){if(!gq){return bV(gt,gs,gp,true)}gt.cantEdit=true;return W(gt.first,0)}gu=true;gr=gs;gn=-gn}}gm=gr;continue search}}}return gm}}function bC(gk){gk.display.input.showSelection(gk.display.input.prepareSelection())}function fJ(gr,gk){var gq=gr.doc,gs={};var gp=gs.cursors=document.createDocumentFragment();var gl=gs.selection=document.createDocumentFragment();for(var gn=0;gn<gq.sel.ranges.length;gn++){if(gk===false&&gn==gq.sel.primIndex){continue}var go=gq.sel.ranges[gn];var gm=go.empty();if(gm||gr.options.showCursorWhenSelecting){A(gr,go.head,gp)}if(!gm){bD(gr,go,gl)}}return gs}function A(gk,gn,gm){var gp=dV(gk,gn,"div",null,null,!gk.options.singleCursorHeightPerLine);var go=gm.appendChild(f4("div","\u00a0","CodeMirror-cursor"));go.style.left=gp.left+"px";go.style.top=gp.top+"px";go.style.height=Math.max(0,gp.bottom-gp.top)*gk.options.cursorHeight+"px";if(gp.other){var gl=gm.appendChild(f4("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));gl.style.display="";gl.style.left=gp.other.left+"px";gl.style.top=gp.other.top+"px";gl.style.height=(gp.other.bottom-gp.other.top)*0.85+"px"}}function bD(go,gu,gp){var gx=go.display,gB=go.doc;var gk=document.createDocumentFragment();var gt=e6(go.display),gn=gt.left;var gy=Math.max(gx.sizerWidth,dm(go)-gx.sizer.offsetLeft)-gt.right;function gv(gF,gE,gD,gC){if(gE<0){gE=0}gE=Math.round(gE);gC=Math.round(gC);gk.appendChild(f4("div",null,"CodeMirror-selected","position: absolute; left: "+gF+"px; top: "+gE+"px; width: "+(gD==null?gy-gF:gD)+"px; height: "+(gC-gE)+"px"))}function gl(gD,gF,gI){var gE=fg(gB,gD);var gG=gE.text.length;var gJ,gC;function gH(gL,gK){return cJ(go,W(gD,gL),"div",gE,gK)}d5(a(gE),gF||0,gI==null?gG:gI,function(gR,gQ,gK){var gN=gH(gR,"left"),gO,gP,gM;if(gR==gQ){gO=gN;gP=gM=gN.left}else{gO=gH(gQ-1,"right");if(gK=="rtl"){var gL=gN;gN=gO;gO=gL}gP=gN.left;gM=gO.right}if(gF==null&&gR==0){gP=gn}if(gO.top-gN.top>3){gv(gP,gN.top,null,gN.bottom);gP=gn;if(gN.bottom<gO.top){gv(gP,gN.bottom,null,gO.top)}}if(gI==null&&gQ==gG){gM=gy}if(!gJ||gN.top<gJ.top||gN.top==gJ.top&&gN.left<gJ.left){gJ=gN}if(!gC||gO.bottom>gC.bottom||gO.bottom==gC.bottom&&gO.right>gC.right){gC=gO}if(gP<gn+1){gP=gn}gv(gP,gO.top,gM-gP,gO.bottom)});return{start:gJ,end:gC}}var gA=gu.from(),gz=gu.to();if(gA.line==gz.line){gl(gA.line,gA.ch,gz.ch)}else{var gm=fg(gB,gA.line),gr=fg(gB,gz.line);var gq=x(gm)==x(gr);var gs=gl(gA.line,gA.ch,gq?gm.text.length+1:null).end;var gw=gl(gz.line,gq?0:null,gz.ch).start;if(gq){if(gs.top<gw.top-2){gv(gs.right,gs.top,null,gs.bottom);gv(gn,gw.top,gw.left,gw.bottom)}else{gv(gs.right,gs.top,gw.left-gs.right,gs.bottom)}}if(gs.bottom<gw.top){gv(gn,gs.bottom,null,gw.top)}}gp.appendChild(gk)}function o(gk){if(!gk.state.focused){return}var gm=gk.display;clearInterval(gm.blinker);var gl=true;gm.cursorDiv.style.visibility="";if(gk.options.cursorBlinkRate>0){gm.blinker=setInterval(function(){gm.cursorDiv.style.visibility=(gl=!gl)?"":"hidden"},gk.options.cursorBlinkRate)}else{if(gk.options.cursorBlinkRate<0){gm.cursorDiv.style.visibility="hidden"}}}function eg(gk,gl){if(gk.doc.mode.startState&&gk.doc.frontier<gk.display.viewTo){gk.state.highlight.set(gl,cv(cP,gk))}}function cP(gk){var go=gk.doc;if(go.frontier<go.first){go.frontier=go.first}if(go.frontier>=gk.display.viewTo){return}var gm=+new Date+gk.options.workTime;var gn=b3(go.mode,dD(gk,go.frontier));var gl=[];go.iter(go.frontier,Math.min(go.first+go.size,gk.display.viewTo+500),function(gp){if(go.frontier>=gk.display.viewFrom){var gs=gp.styles,gw=gp.text.length>gk.options.maxHighlightLength;var gu=fA(gk,gp,gw?b3(go.mode,gn):gn,true);gp.styles=gu.styles;var gr=gp.styleClasses,gt=gu.classes;if(gt){gp.styleClasses=gt}else{if(gr){gp.styleClasses=null}}var gv=!gs||gs.length!=gp.styles.length||gr!=gt&&(!gr||!gt||gr.bgClass!=gt.bgClass||gr.textClass!=gt.textClass);for(var gq=0;!gv&&gq<gs.length;++gq){gv=gs[gq]!=gp.styles[gq]}if(gv){gl.push(go.frontier)}gp.stateAfter=gw?gn:b3(go.mode,gn)}else{if(gp.text.length<=gk.options.maxHighlightLength){dy(gk,gp.text,gn)}gp.stateAfter=go.frontier%5==0?b3(go.mode,gn):null}++go.frontier;if(+new Date>gm){eg(gk,gk.options.workDelay);return true}});if(gl.length){cM(gk,function(){for(var gp=0;gp<gl.length;gp++){R(gk,gl[gp],"text")}})}}function cy(gq,gk,gn){var gl,go,gp=gq.doc;var gm=gn?-1:gk-(gq.doc.mode.innerMode?1000:100);for(var gt=gk;gt>gm;--gt){if(gt<=gp.first){return gp.first}var gs=fg(gp,gt-1);if(gs.stateAfter&&(!gn||gt<=gp.frontier)){return gt}var gr=bT(gs.text,null,gq.options.tabSize);if(go==null||gl>gr){go=gt-1;gl=gr}}return go}function dD(gk,gq,gl){var go=gk.doc,gn=gk.display;if(!go.mode.startState){return true}var gp=cy(gk,gq,gl),gm=gp>go.first&&fg(go,gp-1).stateAfter;if(!gm){gm=b0(go.mode)}else{gm=b3(go.mode,gm)}go.iter(gp,gq,function(gr){dy(gk,gr.text,gm);var gs=gp==gq-1||gp%5==0||gp>=gn.viewFrom&&gp<gn.viewTo;gr.stateAfter=gs?b3(go.mode,gm):null;++gp});if(gl){go.frontier=gp}return gm}function e9(gk){return gk.lineSpace.offsetTop}function bI(gk){return gk.mover.offsetHeight-gk.lineSpace.offsetHeight}function e6(gn){if(gn.cachedPaddingH){return gn.cachedPaddingH}var gm=bR(gn.measure,f4("pre","x"));var gk=window.getComputedStyle?window.getComputedStyle(gm):gm.currentStyle;var gl={left:parseInt(gk.paddingLeft),right:parseInt(gk.paddingRight)};if(!isNaN(gl.left)&&!isNaN(gl.right)){gn.cachedPaddingH=gl}return gl}function cT(gk){return dK-gk.display.nativeBarWidth}function dm(gk){return gk.display.scroller.clientWidth-cT(gk)-gk.display.barWidth}function cV(gk){return gk.display.scroller.clientHeight-cT(gk)-gk.display.barHeight}function ch(gr,gn,gq){var gm=gr.options.lineWrapping;var go=gm&&dm(gr);if(!gn.measure.heights||gm&&gn.measure.width!=go){var gp=gn.measure.heights=[];if(gm){gn.measure.width=go;var gt=gn.text.firstChild.getClientRects();for(var gk=0;gk<gt.length-1;gk++){var gs=gt[gk],gl=gt[gk+1];if(Math.abs(gs.bottom-gl.bottom)>2){gp.push((gs.bottom+gl.top)/2-gq.top)}}}gp.push(gq.bottom-gq.top)}}function ct(gm,gk,gn){if(gm.line==gk){return{map:gm.measure.map,cache:gm.measure.cache}}for(var gl=0;gl<gm.rest.length;gl++){if(gm.rest[gl]==gk){return{map:gm.measure.maps[gl],cache:gm.measure.caches[gl]}}}for(var gl=0;gl<gm.rest.length;gl++){if(bN(gm.rest[gl])>gn){return{map:gm.measure.maps[gl],cache:gm.measure.caches[gl],before:true}}}}function c1(gk,gm){gm=x(gm);var go=bN(gm);var gl=gk.display.externalMeasured=new bv(gk.doc,gm,go);gl.lineN=go;var gn=gl.built=eS(gk,gl);gl.text=gn.pre;bR(gk.display.lineMeasure,gn.pre);return gl}function ei(gk,gl,gn,gm){return C(gk,a4(gk,gl),gn,gm)}function fc(gk,gm){if(gm>=gk.display.viewFrom&&gm<gk.display.viewTo){return gk.display.view[ds(gk,gm)]}var gl=gk.display.externalMeasured;if(gl&&gm>=gl.lineN&&gm<gl.lineN+gl.size){return gl}}function a4(gk,gm){var gn=bN(gm);var gl=fc(gk,gn);if(gl&&!gl.text){gl=null}else{if(gl&&gl.changes){ab(gk,gl,gn,fe(gk));gk.curOp.forceUpdate=true}}if(!gl){gl=c1(gk,gm)}var go=ct(gl,gm,gn);return{line:gm,view:gl,rect:null,map:go.map,cache:go.cache,before:go.before,hasHeights:false}}function C(gk,gq,go,gl,gn){if(gq.before){go=-1}var gm=go+(gl||""),gp;if(gq.cache.hasOwnProperty(gm)){gp=gq.cache[gm]}else{if(!gq.rect){gq.rect=gq.view.text.getBoundingClientRect()}if(!gq.hasHeights){ch(gk,gq.view,gq.rect);gq.hasHeights=true}gp=j(gk,gq,go,gl);if(!gp.bogus){gq.cache[gm]=gp}}return{left:gp.left,right:gp.right,top:gn?gp.rtop:gp.top,bottom:gn?gp.rbottom:gp.bottom}}var eC={left:0,right:0,top:0,bottom:0};function aL(gl,gk,gr){var gn,gm,gp,gs;for(var gq=0;gq<gl.length;gq+=3){var go=gl[gq],gt=gl[gq+1];if(gk<go){gm=0;gp=1;gs="left"}else{if(gk<gt){gm=gk-go;gp=gm+1}else{if(gq==gl.length-3||gk==gt&&gl[gq+3]>gk){gp=gt-go;gm=gp-1;if(gk>=gt){gs="right"}}}}if(gm!=null){gn=gl[gq+2];if(go==gt&&gr==(gn.insertLeft?"left":"right")){gs=gr}if(gr=="left"&&gm==0){while(gq&&gl[gq-2]==gl[gq-3]&&gl[gq-1].insertLeft){gn=gl[(gq-=3)+2];gs="left"}}if(gr=="right"&&gm==gt-go){while(gq<gl.length-3&&gl[gq+3]==gl[gq+4]&&!gl[gq+5].insertLeft){gn=gl[(gq+=3)+2];gs="right"}}break}}return{node:gn,start:gm,end:gp,collapse:gs,coverStart:go,coverEnd:gt}}function j(gr,gB,gu,gp){var gs=aL(gB.map,gu,gp);var gz=gs.node,go=gs.start,gn=gs.end,gk=gs.collapse;var gl;if(gz.nodeType==3){for(var gA=0;gA<4;gA++){while(go&&fq(gB.line.text.charAt(gs.coverStart+go))){--go}while(gs.coverStart+gn<gs.coverEnd&&fq(gB.line.text.charAt(gs.coverStart+gn))){++gn}if(dL&&k<9&&go==0&&gn==gs.coverEnd-gs.coverStart){gl=gz.parentNode.getBoundingClientRect()}else{if(dL&&gr.options.lineWrapping){var gm=cl(gz,go,gn).getClientRects();if(gm.length){gl=gm[gp=="right"?gm.length-1:0]}else{gl=eC}}else{gl=cl(gz,go,gn).getBoundingClientRect()||eC}}if(gl.left||gl.right||go==0){break}gn=go;go=go-1;gk="right"}if(dL&&k<11){gl=eO(gr.display.measure,gl)}}else{if(go>0){gk=gp="right"}var gm;if(gr.options.lineWrapping&&(gm=gz.getClientRects()).length>1){gl=gm[gp=="right"?gm.length-1:0]}else{gl=gz.getBoundingClientRect()}}if(dL&&k<9&&!go&&(!gl||!gl.left&&!gl.right)){var gq=gz.parentNode.getClientRects()[0];if(gq){gl={left:gq.left,right:gq.left+dE(gr.display),top:gq.top,bottom:gq.bottom}}else{gl=eC}}var gx=gl.top-gB.rect.top,gv=gl.bottom-gB.rect.top;var gD=(gx+gv)/2;var gC=gB.view.measure.heights;for(var gA=0;gA<gC.length-1;gA++){if(gD<gC[gA]){break}}var gy=gA?gC[gA-1]:0,gw=gC[gA];var gt={left:(gk=="right"?gl.right:gl.left)-gB.rect.left,right:(gk=="left"?gl.left:gl.right)-gB.rect.left,top:gy,bottom:gw};if(!gl.left&&!gl.right){gt.bogus=true}if(!gr.options.singleCursorHeightPerLine){gt.rtop=gx;gt.rbottom=gv}return gt}function eO(gm,gn){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aK(gm)){return gn}var gl=screen.logicalXDPI/screen.deviceXDPI;var gk=screen.logicalYDPI/screen.deviceYDPI;return{left:gn.left*gl,right:gn.right*gl,top:gn.top*gk,bottom:gn.bottom*gk}}function au(gl){if(gl.measure){gl.measure.cache={};gl.measure.heights=null;if(gl.rest){for(var gk=0;gk<gl.rest.length;gk++){gl.measure.caches[gk]={}}}}}function aO(gk){gk.display.externalMeasure=null;d2(gk.display.lineMeasure);for(var gl=0;gl<gk.display.view.length;gl++){au(gk.display.view[gl])}}function ak(gk){aO(gk);gk.display.cachedCharWidth=gk.display.cachedTextHeight=gk.display.cachedPaddingH=null;if(!gk.options.lineWrapping){gk.display.maxLineChanged=true}gk.display.lineNumChars=null}function cu(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cs(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function eR(gq,gn,gp,gl){if(gn.widgets){for(var gm=0;gm<gn.widgets.length;++gm){if(gn.widgets[gm].above){var gs=cY(gn.widgets[gm]);gp.top+=gs;gp.bottom+=gs}}}if(gl=="line"){return gp}if(!gl){gl="local"}var go=bM(gn);if(gl=="local"){go+=e9(gq.display)}else{go-=gq.display.viewOffset}if(gl=="page"||gl=="window"){var gk=gq.display.lineSpace.getBoundingClientRect();go+=gk.top+(gl=="window"?0:cs());var gr=gk.left+(gl=="window"?0:cu());gp.left+=gr;gp.right+=gr}gp.top+=go;gp.bottom+=go;return gp}function gg(gl,go,gm){if(gm=="div"){return go}var gq=go.left,gp=go.top;if(gm=="page"){gq-=cu();gp-=cs()}else{if(gm=="local"||!gm){var gn=gl.display.sizer.getBoundingClientRect();gq+=gn.left;gp+=gn.top}}var gk=gl.display.lineSpace.getBoundingClientRect();return{left:gq-gk.left,top:gp-gk.top}}function cJ(gk,go,gn,gm,gl){if(!gm){gm=fg(gk.doc,go.line)}return eR(gk,gm,ei(gk,gm,go.ch,gl),gn)}function dV(gt,gs,gm,gq,gv,gr){gq=gq||fg(gt.doc,gs.line);if(!gv){gv=a4(gt,gq)}function go(gy,gx){var gw=C(gt,gv,gy,gx?"right":"left",gr);if(gx){gw.left=gw.right}else{gw.right=gw.left}return eR(gt,gq,gw,gm)}function gu(gz,gw){var gx=gp[gw],gy=gx.level%2;if(gz==dz(gx)&&gw&&gx.level<gp[gw-1].level){gx=gp[--gw];gz=gf(gx)-(gx.level%2?0:1);gy=true}else{if(gz==gf(gx)&&gw<gp.length-1&&gx.level<gp[gw+1].level){gx=gp[++gw];gz=dz(gx)-gx.level%2;gy=false}}if(gy&&gz==gx.to&&gz>gx.from){return go(gz-1)}return go(gz,gy)}var gp=a(gq),gk=gs.ch;if(!gp){return go(gk)}var gl=aG(gp,gk);var gn=gu(gk,gl);if(e3!=null){gn.other=gu(gk,e3)}return gn}function dI(gk,go){var gn=0,go=fK(gk.doc,go);if(!gk.options.lineWrapping){gn=dE(gk.display)*go.ch}var gl=fg(gk.doc,go.line);var gm=bM(gl)+e9(gk.display);return{left:gn,right:gn,top:gm,bottom:gm+gl.height}}function f3(gk,gl,gm,go){var gn=W(gk,gl);gn.xRel=go;if(gm){gn.outside=true}return gn}function fP(gr,go,gn){var gq=gr.doc;gn+=gr.display.viewOffset;if(gn<0){return f3(gq.first,0,true,-1)}var gm=bG(gq,gn),gs=gq.first+gq.size-1;if(gm>gs){return f3(gq.first+gq.size-1,fg(gq,gs).text.length,true,1)}if(go<0){go=0}var gl=fg(gq,gm);for(;;){var gt=cZ(gr,gl,gm,go,gn);var gp=ex(gl);var gk=gp&&gp.find(0,true);if(gp&&(gt.ch>gk.from.ch||gt.ch==gk.from.ch&&gt.xRel>0)){gm=bN(gl=gk.to.line)}else{return gt}}}function cZ(gu,gm,gx,gw,gv){var gt=gv-bM(gm);var gq=false,gD=2*gu.display.wrapper.clientWidth;var gA=a4(gu,gm);function gH(gJ){var gK=dV(gu,W(gx,gJ),"line",gm,gA);gq=true;if(gt>gK.bottom){return gK.left-gD}else{if(gt<gK.top){return gK.left+gD}else{gq=false}}return gK.left}var gz=a(gm),gC=gm.text.length;var gE=cE(gm),gn=cS(gm);var gB=gH(gE),gk=gq,gl=gH(gn),gp=gq;if(gw>gl){return f3(gx,gn,gp,1)}for(;;){if(gz?gn==gE||gn==u(gm,gE,1):gn-gE<=1){var gy=gw<gB||gw-gB<=gl-gw?gE:gn;var gG=gw-(gy==gE?gB:gl);while(fq(gm.text.charAt(gy))){++gy}var gs=f3(gx,gy,gy==gE?gk:gp,gG<-1?-1:gG>1?1:0);return gs}var gr=Math.ceil(gC/2),gI=gE+gr;if(gz){gI=gE;for(var gF=0;gF<gr;++gF){gI=u(gm,gI,1)}}var go=gH(gI);if(go>gw){gn=gI;gl=go;if(gp=gq){gl+=1000}gC=gr}else{gE=gI;gB=go;gk=gq;gC-=gr}}}var aH;function aY(gm){if(gm.cachedTextHeight!=null){return gm.cachedTextHeight}if(aH==null){aH=f4("pre");for(var gl=0;gl<49;++gl){aH.appendChild(document.createTextNode("x"));aH.appendChild(f4("br"))}aH.appendChild(document.createTextNode("x"))}bR(gm.measure,aH);var gk=aH.offsetHeight/50;if(gk>3){gm.cachedTextHeight=gk}d2(gm.measure);return gk||1}function dE(go){if(go.cachedCharWidth!=null){return go.cachedCharWidth}var gk=f4("span","xxxxxxxxxx");var gn=f4("pre",[gk]);bR(go.measure,gn);var gm=gk.getBoundingClientRect(),gl=(gm.right-gm.left)/10;if(gl>2){go.cachedCharWidth=gl}return gl||10}var bp=null;var d9=0;function cI(gk){gk.curOp={cm:gk,viewChanged:false,startHeight:gk.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++d9};if(bp){bp.ops.push(gk.curOp)}else{gk.curOp.ownsGroup=bp={ops:[gk.curOp],delayedCallbacks:[]}}}function cU(gn){var gm=gn.delayedCallbacks,gl=0;do{for(;gl<gm.length;gl++){gm[gl].call(null)}for(var gk=0;gk<gn.ops.length;gk++){var go=gn.ops[gk];if(go.cursorActivityHandlers){while(go.cursorActivityCalled<go.cursorActivityHandlers.length){go.cursorActivityHandlers[go.cursorActivityCalled++].call(null,go.cm)}}}}while(gl<gm.length)}function am(gk){var gn=gk.curOp,gm=gn.ownsGroup;if(!gm){return}try{cU(gm)}finally{bp=null;for(var gl=0;gl<gm.ops.length;gl++){gm.ops[gl].cm.curOp=null}cK(gm)}}function cK(gm){var gl=gm.ops;for(var gk=0;gk<gl.length;gk++){b5(gl[gk])}for(var gk=0;gk<gl.length;gk++){aq(gl[gk])}for(var gk=0;gk<gl.length;gk++){b2(gl[gk])}for(var gk=0;gk<gl.length;gk++){ap(gl[gk])}for(var gk=0;gk<gl.length;gk++){e1(gl[gk])}}function b5(gm){var gk=gm.cm,gl=gk.display;J(gk);if(gm.updateMaxLine){h(gk)}gm.mustUpdate=gm.viewChanged||gm.forceUpdate||gm.scrollTop!=null||gm.scrollToPos&&(gm.scrollToPos.from.line<gl.viewFrom||gm.scrollToPos.to.line>=gl.viewTo)||gl.maxLineChanged&&gk.options.lineWrapping;gm.update=gm.mustUpdate&&new aI(gk,gm.mustUpdate&&{top:gm.scrollTop,ensure:gm.scrollToPos},gm.forceUpdate)}function aq(gk){gk.updatedDisplay=gk.mustUpdate&&B(gk.cm,gk.update)}function b2(gm){var gk=gm.cm,gl=gk.display;if(gm.updatedDisplay){a9(gk)}gm.barMeasure=dB(gk);if(gl.maxLineChanged&&!gk.options.lineWrapping){gm.adjustWidthTo=ei(gk,gl.maxLine,gl.maxLine.text.length).left+3;gk.display.sizerWidth=gm.adjustWidthTo;gm.barMeasure.scrollWidth=Math.max(gl.scroller.clientWidth,gl.sizer.offsetLeft+gm.adjustWidthTo+cT(gk)+gk.display.barWidth);gm.maxScrollLeft=Math.max(0,gl.sizer.offsetLeft+gm.adjustWidthTo-dm(gk))}if(gm.updatedDisplay||gm.selectionChanged){gm.preparedSelection=gl.input.prepareSelection()}}function ap(gl){var gk=gl.cm;if(gl.adjustWidthTo!=null){gk.display.sizer.style.minWidth=gl.adjustWidthTo+"px";if(gl.maxScrollLeft<gk.doc.scrollLeft){bE(gk,Math.min(gk.display.scroller.scrollLeft,gl.maxScrollLeft),true)}gk.display.maxLineChanged=false}if(gl.preparedSelection){gk.display.input.showSelection(gl.preparedSelection)}if(gl.updatedDisplay){dA(gk,gl.barMeasure)}if(gl.updatedDisplay||gl.startHeight!=gk.doc.height){eZ(gk,gl.barMeasure)}if(gl.selectionChanged){o(gk)}if(gk.state.focused&&gl.updateInput){gk.display.input.reset(gl.typing)}if(gl.focus&&gl.focus==dP()){r(gl.cm)}}function e1(gr){var gk=gr.cm,gp=gk.display,go=gk.doc;if(gr.updatedDisplay){cj(gk,gr.update)}if(gp.wheelStartX!=null&&(gr.scrollTop!=null||gr.scrollLeft!=null||gr.scrollToPos)){gp.wheelStartX=gp.wheelStartY=null}if(gr.scrollTop!=null&&(gp.scroller.scrollTop!=gr.scrollTop||gr.forceScroll)){go.scrollTop=Math.max(0,Math.min(gp.scroller.scrollHeight-gp.scroller.clientHeight,gr.scrollTop));gp.scrollbars.setScrollTop(go.scrollTop);gp.scroller.scrollTop=go.scrollTop}if(gr.scrollLeft!=null&&(gp.scroller.scrollLeft!=gr.scrollLeft||gr.forceScroll)){go.scrollLeft=Math.max(0,Math.min(gp.scroller.scrollWidth-dm(gk),gr.scrollLeft));gp.scrollbars.setScrollLeft(go.scrollLeft);gp.scroller.scrollLeft=go.scrollLeft;eF(gk)}if(gr.scrollToPos){var gn=D(gk,fK(go,gr.scrollToPos.from),fK(go,gr.scrollToPos.to),gr.scrollToPos.margin);if(gr.scrollToPos.isCursor&&gk.state.focused){d7(gk,gn)}}var gm=gr.maybeHiddenMarkers,gq=gr.maybeUnhiddenMarkers;if(gm){for(var gl=0;gl<gm.length;++gl){if(!gm[gl].lines.length){aE(gm[gl],"hide")}}}if(gq){for(var gl=0;gl<gq.length;++gl){if(gq[gl].lines.length){aE(gq[gl],"unhide")}}}if(gp.wrapper.offsetHeight){go.scrollTop=gk.display.scroller.scrollTop}if(gr.changeObjs){aE(gk,"changes",gk,gr.changeObjs)}if(gr.update){gr.update.finish()}}function cM(gk,gl){if(gk.curOp){return gl()}cI(gk);try{return gl()}finally{am(gk)}}function c2(gk,gl){return function(){if(gk.curOp){return gl.apply(gk,arguments)}cI(gk);try{return gl.apply(gk,arguments)}finally{am(gk)}}}function c8(gk){return function(){if(this.curOp){return gk.apply(this,arguments)}cI(this);try{return gk.apply(this,arguments)}finally{am(this)}}}function cD(gk){return function(){var gl=this.cm;if(!gl||gl.curOp){return gk.apply(this,arguments)}cI(gl);try{return gk.apply(this,arguments)}finally{am(gl)}}}function bv(gm,gk,gl){this.line=gk;this.rest=g(gk);this.size=this.rest?bN(fH(this.rest))-gl+1:1;this.node=this.text=null;this.hidden=fx(gm,gk)}function eW(gk,gq,gp){var go=[],gm;for(var gn=gq;gn<gp;gn=gm){var gl=new bv(gk.doc,fg(gk.doc,gn),gn);gm=gn+gl.size;go.push(gl)}return go}function ah(gr,gp,gq,gs){if(gp==null){gp=gr.doc.first}if(gq==null){gq=gr.doc.first+gr.doc.size}if(!gs){gs=0}var gm=gr.display;if(gs&&gq<gm.viewTo&&(gm.updateLineNumbers==null||gm.updateLineNumbers>gp)){gm.updateLineNumbers=gp}gr.curOp.viewChanged=true;if(gp>=gm.viewTo){if(a7&&aW(gr.doc,gp)<gm.viewTo){ey(gr)}}else{if(gq<=gm.viewFrom){if(a7&&d3(gr.doc,gq+gs)>gm.viewFrom){ey(gr)}else{gm.viewFrom+=gs;gm.viewTo+=gs}}else{if(gp<=gm.viewFrom&&gq>=gm.viewTo){ey(gr)}else{if(gp<=gm.viewFrom){var go=df(gr,gq,gq+gs,1);if(go){gm.view=gm.view.slice(go.index);gm.viewFrom=go.lineN;gm.viewTo+=gs}else{ey(gr)}}else{if(gq>=gm.viewTo){var go=df(gr,gp,gp,-1);if(go){gm.view=gm.view.slice(0,go.index);gm.viewTo=go.lineN}else{ey(gr)}}else{var gn=df(gr,gp,gp,-1);var gl=df(gr,gq,gq+gs,1);if(gn&&gl){gm.view=gm.view.slice(0,gn.index).concat(eW(gr,gn.lineN,gl.lineN)).concat(gm.view.slice(gl.index));gm.viewTo+=gs}else{ey(gr)}}}}}}var gk=gm.externalMeasured;if(gk){if(gq<gk.lineN){gk.lineN+=gs}else{if(gp<gk.lineN+gk.size){gm.externalMeasured=null}}}}function R(gl,gm,gp){gl.curOp.viewChanged=true;var gq=gl.display,go=gl.display.externalMeasured;if(go&&gm>=go.lineN&&gm<go.lineN+go.size){gq.externalMeasured=null}if(gm<gq.viewFrom||gm>=gq.viewTo){return}var gn=gq.view[ds(gl,gm)];if(gn.node==null){return}var gk=gn.changes||(gn.changes=[]);if(di(gk,gp)==-1){gk.push(gp)}}function ey(gk){gk.display.viewFrom=gk.display.viewTo=gk.doc.first;gk.display.view=[];gk.display.viewOffset=0}function ds(gk,gn){if(gn>=gk.display.viewTo){return null}gn-=gk.display.viewFrom;if(gn<0){return null}var gl=gk.display.view;for(var gm=0;gm<gl.length;gm++){gn-=gl[gm].size;if(gn<0){return gm}}}function df(gs,gm,go,gl){var gp=ds(gs,gm),gr,gq=gs.display.view;if(!a7||go==gs.doc.first+gs.doc.size){return{index:gp,lineN:go}}for(var gn=0,gk=gs.display.viewFrom;gn<gp;gn++){gk+=gq[gn].size}if(gk!=gm){if(gl>0){if(gp==gq.length-1){return null}gr=(gk+gq[gp].size)-gm;gp++}else{gr=gk-gm}gm+=gr;go+=gr}while(aW(gs.doc,go)!=go){if(gp==(gl<0?0:gq.length-1)){return null}go+=gl*gq[gp-(gl<0?1:0)].size;gp+=gl}return{index:gp,lineN:go}}function cR(gk,go,gn){var gm=gk.display,gl=gm.view;if(gl.length==0||go>=gm.viewTo||gn<=gm.viewFrom){gm.view=eW(gk,go,gn);gm.viewFrom=go}else{if(gm.viewFrom>go){gm.view=eW(gk,go,gm.viewFrom).concat(gm.view)}else{if(gm.viewFrom<go){gm.view=gm.view.slice(ds(gk,go))}}gm.viewFrom=go;if(gm.viewTo<gn){gm.view=gm.view.concat(eW(gk,gm.viewTo,gn))}else{if(gm.viewTo>gn){gm.view=gm.view.slice(0,ds(gk,gn))}}}gm.viewTo=gn}function dc(gk){var gl=gk.display.view,go=0;for(var gn=0;gn<gl.length;gn++){var gm=gl[gn];if(!gm.hidden&&(!gm.node||gm.changes)){++go}}return go}function fR(gl){var gp=gl.display;bX(gp.scroller,"mousedown",c2(gl,ev));if(dL&&k<11){bX(gp.scroller,"dblclick",c2(gl,function(gt){if(aR(gl,gt)){return}var gu=cn(gl,gt);if(!gu||l(gl,gt)||bb(gl.display,gt)){return}cG(gt);var gs=gl.findWordAt(gu);fY(gl.doc,gs.anchor,gs.head)}))}else{bX(gp.scroller,"dblclick",function(gs){aR(gl,gs)||cG(gs)})}if(!gb){bX(gp.scroller,"contextmenu",function(gs){ay(gl,gs)})}var gr,gk={end:0};function gq(){if(gp.activeTouch){gr=setTimeout(function(){gp.activeTouch=null},1000);gk=gp.activeTouch;gk.end=+new Date}}function gn(gs){if(gs.touches.length!=1){return false}var gt=gs.touches[0];return gt.radiusX<=1&&gt.radiusY<=1}function gm(gv,gs){if(gs.left==null){return true}var gu=gs.left-gv.left,gt=gs.top-gv.top;return gu*gu+gt*gt>20*20}bX(gp.scroller,"touchstart",function(gt){if(!gn(gt)){clearTimeout(gr);var gs=+new Date;gp.activeTouch={start:gs,moved:false,prev:gs-gk.end<=300?gk:null};if(gt.touches.length==1){gp.activeTouch.left=gt.touches[0].pageX;gp.activeTouch.top=gt.touches[0].pageY}}});bX(gp.scroller,"touchmove",function(){if(gp.activeTouch){gp.activeTouch.moved=true}});bX(gp.scroller,"touchend",function(gt){var gv=gp.activeTouch;if(gv&&!bb(gp,gt)&&gv.left!=null&&!gv.moved&&new Date-gv.start<300){var gu=gl.coordsChar(gp.activeTouch,"page"),gs;if(!gv.prev||gm(gv,gv.prev)){gs=new dZ(gu,gu)}else{if(!gv.prev.prev||gm(gv,gv.prev.prev)){gs=gl.findWordAt(gu)}else{gs=new dZ(W(gu.line,0),fK(gl.doc,W(gu.line+1,0)))}}gl.setSelection(gs.anchor,gs.head);gl.focus();cG(gt)}gq()});bX(gp.scroller,"touchcancel",gq);bX(gp.scroller,"scroll",function(){if(gp.scroller.clientHeight){N(gl,gp.scroller.scrollTop);bE(gl,gp.scroller.scrollLeft,true);aE(gl,"scroll",gl)}});bX(gp.scroller,"mousewheel",function(gs){b(gl,gs)});bX(gp.scroller,"DOMMouseScroll",function(gs){b(gl,gs)});bX(gp.wrapper,"scroll",function(){gp.wrapper.scrollTop=gp.wrapper.scrollLeft=0});gp.dragFunctions={enter:function(gs){if(!aR(gl,gs)){es(gs)}},over:function(gs){if(!aR(gl,gs)){gh(gl,gs);es(gs)}},start:function(gs){Q(gl,gs)},drop:c2(gl,bk),leave:function(){db(gl)}};var go=gp.input.getField();bX(go,"keyup",function(gs){bi.call(gl,gs)});bX(go,"keydown",c2(gl,p));bX(go,"keypress",c2(gl,cx));bX(go,"focus",cv(cB,gl));bX(go,"blur",cv(aV,gl))}function f2(gl,go,gm){var gp=gm&&gm!=H.Init;if(!go!=!gp){var gn=gl.display.dragFunctions;var gk=go?bX:ee;gk(gl.display.scroller,"dragstart",gn.start);gk(gl.display.scroller,"dragenter",gn.enter);gk(gl.display.scroller,"dragover",gn.over);gk(gl.display.scroller,"dragleave",gn.leave);gk(gl.display.scroller,"drop",gn.drop)}}function aT(gk){var gl=gk.display;if(gl.lastWrapHeight==gl.wrapper.clientHeight&&gl.lastWrapWidth==gl.wrapper.clientWidth){return}gl.cachedCharWidth=gl.cachedTextHeight=gl.cachedPaddingH=null;gl.scrollbarsClipped=false;gk.setSize()}function bb(gl,gk){for(var gm=L(gk);gm!=gl.wrapper;gm=gm.parentNode){if(!gm||(gm.nodeType==1&&gm.getAttribute("cm-ignore-events")=="true")||(gm.parentNode==gl.sizer&&gm!=gl.mover)){return true}}}function cn(gt,go,gl,gm){var gp=gt.display;if(!gl&&L(go).getAttribute("cm-not-content")=="true"){return null}var gs,gq,gk=gp.lineSpace.getBoundingClientRect();try{gs=go.clientX-gk.left;gq=go.clientY-gk.top}catch(go){return null}var gr=fP(gt,gs,gq),gu;if(gm&&gr.xRel==1&&(gu=fg(gt.doc,gr.line).text).length==gr.ch){var gn=bT(gu,gu.length,gt.options.tabSize)-gu.length;gr=W(gr.line,Math.max(0,Math.round((gs-e6(gt.display).left)/dE(gt.display))-gn))}return gr}function ev(gm){var gk=this,gl=gk.display;if(gl.activeTouch&&gl.input.supportsTouch()||aR(gk,gm)){return}gl.shift=gm.shiftKey;if(bb(gl,gm)){if(!c0){gl.scroller.draggable=false;setTimeout(function(){gl.scroller.draggable=true},100)}return}if(l(gk,gm)){return}var gn=cn(gk,gm);window.focus();switch(fO(gm)){case 1:if(gk.state.selectingText){gk.state.selectingText(gm)}else{if(gn){ax(gk,gm,gn)}else{if(L(gm)==gl.scroller){cG(gm)}}}break;case 2:if(c0){gk.state.lastMiddleDown=+new Date}if(gn){fY(gk.doc,gn)}setTimeout(function(){gl.input.focus()},20);cG(gm);break;case 3:if(gb){ay(gk,gm)}else{al(gk)}break}}var dp,de;function ax(gl,gq,gr){if(dL){setTimeout(cv(r,gl),0)}else{gl.curOp.focus=dP()}var gm=+new Date,go;if(de&&de.time>gm-400&&cf(de.pos,gr)==0){go="triple"}else{if(dp&&dp.time>gm-400&&cf(dp.pos,gr)==0){go="double";de={time:gm,pos:gr}}else{go="single";dp={time:gm,pos:gr}}}var gp=gl.doc.sel,gk=b7?gq.metaKey:gq.ctrlKey,gn;if(gl.options.dragDrop&&eM&&!aj(gl)&&go=="single"&&(gn=gp.contains(gr))>-1&&(cf((gn=gp.ranges[gn]).from(),gr)<0||gr.xRel>0)&&(cf(gn.to(),gr)>0||gr.xRel<0)){a3(gl,gq,gr,gk)}else{m(gl,gq,gr,go,gk)}}function a3(gm,gp,gq,gl){var go=gm.display,gn=+new Date;var gk=c2(gm,function(gr){if(c0){go.scroller.draggable=false}gm.state.draggingText=false;ee(document,"mouseup",gk);ee(go.scroller,"drop",gk);if(Math.abs(gp.clientX-gr.clientX)+Math.abs(gp.clientY-gr.clientY)<10){cG(gr);if(!gl&&+new Date-200<gn){fY(gm.doc,gq)}if(c0||dL&&k==9){setTimeout(function(){document.body.focus();go.input.focus()},20)}else{go.input.focus()}}});if(c0){go.scroller.draggable=true}gm.state.draggingText=gk;if(go.scroller.dragDrop){go.scroller.dragDrop()}bX(document,"mouseup",gk);bX(go.scroller,"drop",gk)}function m(go,gC,gn,gl,gq){var gz=go.display,gE=go.doc;cG(gC);var gm,gD,gp=gE.sel,gk=gp.ranges;if(gq&&!gC.shiftKey){gD=gE.sel.contains(gn);if(gD>-1){gm=gk[gD]}else{gm=new dZ(gn,gn)}}else{gm=gE.sel.primary();gD=gE.sel.primIndex}if(gC.altKey){gl="rect";if(!gq){gm=new dZ(gn,gn)}gn=cn(go,gC,true,true);gD=-1}else{if(gl=="double"){var gA=go.findWordAt(gn);if(go.display.shift||gE.extend){gm=fw(gE,gm,gA.anchor,gA.head)}else{gm=gA}}else{if(gl=="triple"){var gt=new dZ(W(gn.line,0),fK(gE,W(gn.line+1,0)));if(go.display.shift||gE.extend){gm=fw(gE,gm,gt.anchor,gt.head)}else{gm=gt}}else{gm=fw(gE,gm,gn)}}}if(!gq){gD=0;bU(gE,new f5([gm],0),M);gp=gE.sel}else{if(gD==-1){gD=gk.length;bU(gE,cw(gk.concat([gm]),gD),{scroll:false,origin:"*mouse"})}else{if(gk.length>1&&gk[gD].empty()&&gl=="single"&&!gC.shiftKey){bU(gE,cw(gk.slice(0,gD).concat(gk.slice(gD+1)),0),{scroll:false,origin:"*mouse"});gp=gE.sel}else{e(gE,gD,gm,M)}}}var gy=gn;function gx(gP){if(cf(gy,gP)==0){return}gy=gP;if(gl=="rect"){var gG=[],gM=go.options.tabSize;var gF=bT(fg(gE,gn.line).text,gn.ch,gM);var gS=bT(fg(gE,gP.line).text,gP.ch,gM);var gH=Math.min(gF,gS),gQ=Math.max(gF,gS);for(var gT=Math.min(gn.line,gP.line),gJ=Math.min(go.lastLine(),Math.max(gn.line,gP.line));gT<=gJ;gT++){var gR=fg(gE,gT).text,gI=er(gR,gH,gM);if(gH==gQ){gG.push(new dZ(W(gT,gI),W(gT,gI)))}else{if(gR.length>gI){gG.push(new dZ(W(gT,gI),W(gT,er(gR,gQ,gM))))}}}if(!gG.length){gG.push(new dZ(gn,gn))}bU(gE,cw(gp.ranges.slice(0,gD).concat(gG),gD),{origin:"*mouse",scroll:false});go.scrollIntoView(gP)}else{var gN=gm;var gK=gN.anchor,gO=gP;if(gl!="single"){if(gl=="double"){var gL=go.findWordAt(gP)}else{var gL=new dZ(W(gP.line,0),fK(gE,W(gP.line+1,0)))}if(cf(gL.anchor,gK)>0){gO=gL.head;gK=ar(gN.from(),gL.anchor)}else{gO=gL.anchor;gK=bx(gN.to(),gL.head)}}var gG=gp.ranges.slice(0);gG[gD]=new dZ(fK(gE,gK),gO);bU(gE,cw(gG,gD),M)}}var gv=gz.wrapper.getBoundingClientRect();var gr=0;function gB(gH){var gF=++gr;var gJ=cn(go,gH,true,gl=="rect");if(!gJ){return}if(cf(gJ,gy)!=0){go.curOp.focus=dP();gx(gJ);var gI=b6(gz,gE);if(gJ.line>=gI.to||gJ.line<gI.from){setTimeout(c2(go,function(){if(gr==gF){gB(gH)}}),150)}}else{var gG=gH.clientY<gv.top?-20:gH.clientY>gv.bottom?20:0;if(gG){setTimeout(c2(go,function(){if(gr!=gF){return}gz.scroller.scrollTop+=gG;gB(gH)}),50)}}}function gu(gF){go.state.selectingText=false;gr=Infinity;cG(gF);gz.input.focus();ee(document,"mousemove",gw);ee(document,"mouseup",gs);gE.history.lastSelOrigin=null}var gw=c2(go,function(gF){if(!fO(gF)){gu(gF)}else{gB(gF)}});var gs=c2(go,gu);go.state.selectingText=gs;bX(document,"mousemove",gw);bX(document,"mouseup",gs)}function gi(gv,gr,gt,gu,gn){try{var gl=gr.clientX,gk=gr.clientY}catch(gr){return false}if(gl>=Math.floor(gv.display.gutters.getBoundingClientRect().right)){return false}if(gu){cG(gr)}var gs=gv.display;var gq=gs.lineDiv.getBoundingClientRect();if(gk>gq.bottom||!fj(gv,gt)){return bL(gr)}gk-=gq.top-gs.viewOffset;for(var go=0;go<gv.options.gutters.length;++go){var gp=gs.gutters.childNodes[go];if(gp&&gp.getBoundingClientRect().right>=gl){var gw=bG(gv.doc,gk);var gm=gv.options.gutters[go];gn(gv,gt,gv,gw,gm,gr);return bL(gr)}}}function l(gk,gl){return gi(gk,gl,"gutterClick",true,ae)}var ag=0;function bk(gq){var gs=this;db(gs);if(aR(gs,gq)||bb(gs.display,gq)){return}cG(gq);if(dL){ag=+new Date}var gr=cn(gs,gq,true),gk=gq.dataTransfer.files;if(!gr||aj(gs)){return}if(gk&&gk.length&&window.FileReader&&window.File){var gm=gk.length,gt=Array(gm),gl=0;var go=function(gw,gv){var gu=new FileReader;gu.onload=c2(gs,function(){gt[gv]=gu.result;if(++gl==gm){gr=fK(gs.doc,gr);var gx={from:gr,to:gr,text:gs.doc.splitLines(gt.join(gs.doc.lineSeparator())),origin:"paste"};bg(gs.doc,gx);e8(gs.doc,eT(gr,cX(gx)))}});gu.readAsText(gw)};for(var gp=0;gp<gm;++gp){go(gk[gp],gp)}}else{if(gs.state.draggingText&&gs.doc.sel.contains(gr)>-1){gs.state.draggingText(gq);setTimeout(function(){gs.display.input.focus()},20);return}try{var gt=gq.dataTransfer.getData("Text");if(gt){if(gs.state.draggingText&&!(b7?gq.altKey:gq.ctrlKey)){var gn=gs.listSelections()}eq(gs.doc,eT(gr,gr));if(gn){for(var gp=0;gp<gn.length;++gp){a1(gs.doc,"",gn[gp].anchor,gn[gp].head,"drag")}}gs.replaceSelection(gt,"around","paste");gs.display.input.focus()}}catch(gq){}}}function Q(gk,gm){if(dL&&(!gk.state.draggingText||+new Date-ag<100)){es(gm);return}if(aR(gk,gm)||bb(gk.display,gm)){return}gm.dataTransfer.setData("Text",gk.getSelection());if(gm.dataTransfer.setDragImage&&!aC){var gl=f4("img",null,null,"position: fixed; left: 0; top: 0;");gl.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(d4){gl.width=gl.height=1;gk.display.wrapper.appendChild(gl);gl._top=gl.offsetTop}gm.dataTransfer.setDragImage(gl,0,0);if(d4){gl.parentNode.removeChild(gl)}}}function gh(gk,gl){var gn=cn(gk,gl);if(!gn){return}var gm=document.createDocumentFragment();A(gk,gn,gm);if(!gk.display.dragCursor){gk.display.dragCursor=f4("div",null,"CodeMirror-cursors CodeMirror-dragcursors");gk.display.lineSpace.insertBefore(gk.display.dragCursor,gk.display.cursorDiv)}bR(gk.display.dragCursor,gm)}function db(gk){if(gk.display.dragCursor){gk.display.lineSpace.removeChild(gk.display.dragCursor);gk.display.dragCursor=null}}function N(gk,gl){if(Math.abs(gk.doc.scrollTop-gl)<2){return}gk.doc.scrollTop=gl;if(!co){dU(gk,{top:gl})}if(gk.display.scroller.scrollTop!=gl){gk.display.scroller.scrollTop=gl}gk.display.scrollbars.setScrollTop(gl);if(co){dU(gk)}eg(gk,100)}function bE(gk,gm,gl){if(gl?gm==gk.doc.scrollLeft:Math.abs(gk.doc.scrollLeft-gm)<2){return}gm=Math.min(gm,gk.display.scroller.scrollWidth-gk.display.scroller.clientWidth);gk.doc.scrollLeft=gm;eF(gk);if(gk.display.scroller.scrollLeft!=gm){gk.display.scroller.scrollLeft=gm}gk.display.scrollbars.setScrollLeft(gm)}var fn=0,cg=null;if(dL){cg=-0.53}else{if(co){cg=15}else{if(dd){cg=-0.7}else{if(aC){cg=-1/3}}}}var cQ=function(gm){var gl=gm.wheelDeltaX,gk=gm.wheelDeltaY;if(gl==null&&gm.detail&&gm.axis==gm.HORIZONTAL_AXIS){gl=gm.detail}if(gk==null&&gm.detail&&gm.axis==gm.VERTICAL_AXIS){gk=gm.detail}else{if(gk==null){gk=gm.wheelDelta}}return{x:gl,y:gk}};H.wheelEventPixels=function(gk){var gl=cQ(gk);gl.x*=cg;gl.y*=cg;return gl};function b(gs,gm){var gt=cQ(gm),gw=gt.x,gv=gt.y;var go=gs.display,gr=go.scroller;if(!(gw&&gr.scrollWidth>gr.clientWidth||gv&&gr.scrollHeight>gr.clientHeight)){return}if(gv&&b7&&c0){outer:for(var gu=gm.target,gq=go.view;gu!=gr;gu=gu.parentNode){for(var gl=0;gl<gq.length;gl++){if(gq[gl].node==gu){gs.display.currentWheelTarget=gu;break outer}}}}if(gw&&!co&&!d4&&cg!=null){if(gv){N(gs,Math.max(0,Math.min(gr.scrollTop+gv*cg,gr.scrollHeight-gr.clientHeight)))}bE(gs,Math.max(0,Math.min(gr.scrollLeft+gw*cg,gr.scrollWidth-gr.clientWidth)));cG(gm);go.wheelStartX=null;return}if(gv&&cg!=null){var gk=gv*cg;var gp=gs.doc.scrollTop,gn=gp+go.wrapper.clientHeight;if(gk<0){gp=Math.max(0,gp+gk-50)}else{gn=Math.min(gs.doc.height,gn+gk+50)}dU(gs,{top:gp,bottom:gn})}if(fn<20){if(go.wheelStartX==null){go.wheelStartX=gr.scrollLeft;go.wheelStartY=gr.scrollTop;go.wheelDX=gw;go.wheelDY=gv;setTimeout(function(){if(go.wheelStartX==null){return}var gx=gr.scrollLeft-go.wheelStartX;var gz=gr.scrollTop-go.wheelStartY;var gy=(gz&&go.wheelDY&&gz/go.wheelDY)||(gx&&go.wheelDX&&gx/go.wheelDX);go.wheelStartX=go.wheelStartY=null;if(!gy){return}cg=(cg*fn+gy)/(fn+1);++fn},200)}else{go.wheelDX+=gw;go.wheelDY+=gv}}}function fS(gl,go,gk){if(typeof go=="string"){go=eE[go];if(!go){return false}}gl.display.input.ensurePolled();var gn=gl.display.shift,gm=false;try{if(aj(gl)){gl.state.suppressEdits=true}if(gk){gl.display.shift=false}gm=go(gl)!=ca}finally{gl.display.shift=gn;gl.state.suppressEdits=false}return gm}function eb(gl,gm,go){for(var gn=0;gn<gl.state.keyMaps.length;gn++){var gk=i(gm,gl.state.keyMaps[gn],go,gl);if(gk){return gk}}return(gl.options.extraKeys&&i(gm,gl.options.extraKeys,go,gl))||i(gm,gl.options.keyMap,go,gl)}var dN=new gj;function bd(gl,gn,gp,go){var gm=gl.state.keySeq;if(gm){if(eD(gn)){return"handled"}dN.set(50,function(){if(gl.state.keySeq==gm){gl.state.keySeq=null;gl.display.input.reset()}});gn=gm+" "+gn}var gk=eb(gl,gn,go);if(gk=="multi"){gl.state.keySeq=gn}if(gk=="handled"){ae(gl,"keyHandled",gl,gn,gp)}if(gk=="handled"||gk=="multi"){cG(gp);o(gl)}if(gm&&!gk&&/\'$/.test(gn)){cG(gp);return true}return !!gk}function fk(gk,gm){var gl=fs(gm,true);if(!gl){return false}if(gm.shiftKey&&!gk.state.keySeq){return bd(gk,"Shift-"+gl,gm,function(gn){return fS(gk,gn,true)})||bd(gk,gl,gm,function(gn){if(typeof gn=="string"?/^go[A-Z]/.test(gn):gn.motion){return fS(gk,gn)}})}else{return bd(gk,gl,gm,function(gn){return fS(gk,gn)})}}function ek(gk,gm,gl){return bd(gk,"'"+gl+"'",gm,function(gn){return fS(gk,gn,true)})}var dn=null;function p(gn){var gk=this;gk.curOp.focus=dP();if(aR(gk,gn)){return}if(dL&&k<11&&gn.keyCode==27){gn.returnValue=false}var gl=gn.keyCode;gk.display.shift=gl==16||gn.shiftKey;var gm=fk(gk,gn);if(d4){dn=gm?gl:null;if(!gm&&gl==88&&!da&&(b7?gn.metaKey:gn.ctrlKey)){gk.replaceSelection("",null,"cut")}}if(gl==18&&!/\bCodeMirror-crosshair\b/.test(gk.display.lineDiv.className)){av(gk)}}function av(gl){var gm=gl.display.lineDiv;fB(gm,"CodeMirror-crosshair");function gk(gn){if(gn.keyCode==18||!gn.altKey){f(gm,"CodeMirror-crosshair");ee(document,"keyup",gk);ee(document,"mouseover",gk)}}bX(document,"keyup",gk);bX(document,"mouseover",gk)}function bi(gk){if(gk.keyCode==16){this.doc.sel.shift=false}aR(this,gk)}function cx(go){var gk=this;if(bb(gk.display,go)||aR(gk,go)||go.ctrlKey&&!go.altKey||b7&&go.metaKey){return}var gn=go.keyCode,gl=go.charCode;if(d4&&gn==dn){dn=null;cG(go);return}if((d4&&(!go.which||go.which<10))&&fk(gk,go)){return}var gm=String.fromCharCode(gl==null?gn:gl);if(ek(gk,go,gm)){return}gk.display.input.onKeyPress(go)}function al(gk){gk.state.delayingBlurEvent=true;setTimeout(function(){if(gk.state.delayingBlurEvent){gk.state.delayingBlurEvent=false;aV(gk)}},100)}function cB(gk){if(gk.state.delayingBlurEvent){gk.state.delayingBlurEvent=false}if(gk.options.readOnly=="nocursor"){return}if(!gk.state.focused){aE(gk,"focus",gk);gk.state.focused=true;fB(gk.display.wrapper,"CodeMirror-focused");if(!gk.curOp&&gk.display.selForContextMenu!=gk.doc.sel){gk.display.input.reset();if(c0){setTimeout(function(){gk.display.input.reset(true)},20)}}gk.display.input.receivedFocus()}o(gk)}function aV(gk){if(gk.state.delayingBlurEvent){return}if(gk.state.focused){aE(gk,"blur",gk);gk.state.focused=false;f(gk.display.wrapper,"CodeMirror-focused")}clearInterval(gk.display.blinker);setTimeout(function(){if(!gk.state.focused){gk.display.shift=false}},150)}function ay(gk,gl){if(bb(gk.display,gl)||dh(gk,gl)){return}gk.display.input.onContextMenu(gl)}function dh(gk,gl){if(!fj(gk,"gutterContextMenu")){return false}return gi(gk,gl,"gutterContextMenu",false,aE)}var cX=H.changeEnd=function(gk){if(!gk.text){return gk.to}return W(gk.from.line+gk.text.length-1,fH(gk.text).length+(gk.text.length==1?gk.from.ch:0))};function bZ(gn,gm){if(cf(gn,gm.from)<0){return gn}if(cf(gn,gm.to)<=0){return cX(gm)}var gk=gn.line+gm.text.length-(gm.to.line-gm.from.line)-1,gl=gn.ch;if(gn.line==gm.to.line){gl+=cX(gm).ch-gm.to.ch}return W(gk,gl)}function fl(gn,go){var gl=[];for(var gm=0;gm<gn.sel.ranges.length;gm++){var gk=gn.sel.ranges[gm];gl.push(new dZ(bZ(gk.anchor,go),bZ(gk.head,go)))}return cw(gl,gn.sel.primIndex)}function bu(gm,gl,gk){if(gm.line==gl.line){return W(gk.line,gm.ch-gl.ch+gk.ch)}else{return W(gk.line+(gm.line-gl.line),gm.ch)}}function af(gu,gr,gl){var gm=[];var gk=W(gu.first,0),gv=gk;for(var go=0;go<gr.length;go++){var gq=gr[go];var gt=bu(gq.from,gk,gv);var gs=bu(cX(gq),gk,gv);gk=gq.to;gv=gs;if(gl=="around"){var gp=gu.sel.ranges[go],gn=cf(gp.head,gp.anchor)<0;gm[go]=new dZ(gn?gs:gt,gn?gt:gs)}else{gm[go]=new dZ(gt,gt)}}return new f5(gm,gu.sel.primIndex)}function dS(gl,gn,gm){var gk={canceled:false,from:gn.from,to:gn.to,text:gn.text,origin:gn.origin,cancel:function(){this.canceled=true}};if(gm){gk.update=function(gr,gq,gp,go){if(gr){this.from=fK(gl,gr)}if(gq){this.to=fK(gl,gq)}if(gp){this.text=gp}if(go!==undefined){this.origin=go}}}aE(gl,"beforeChange",gl,gk);if(gl.cm){aE(gl.cm,"beforeChange",gl.cm,gk)}if(gk.canceled){return null}return{from:gk.from,to:gk.to,text:gk.text,origin:gk.origin}}function bg(gn,go,gm){if(gn.cm){if(!gn.cm.curOp){return c2(gn.cm,bg)(gn,go,gm)}if(gn.cm.state.suppressEdits){return}}if(fj(gn,"beforeChange")||gn.cm&&fj(gn.cm,"beforeChange")){go=dS(gn,go,true);if(!go){return}}var gl=ge&&!gm&&cH(gn,go.from,go.to);if(gl){for(var gk=gl.length-1;gk>=0;--gk){K(gn,{from:gl[gk].from,to:gl[gk].to,text:gk?[""]:go.text})}}else{K(gn,go)}}function K(gm,gn){if(gn.text.length==1&&gn.text[0]==""&&cf(gn.from,gn.to)==0){return}var gl=fl(gm,gn);fN(gm,gn,gl,gm.cm?gm.cm.curOp.id:NaN);ef(gm,gn,gl,el(gm,gn));var gk=[];d8(gm,function(gp,go){if(!go&&di(gk,gp.history)==-1){dF(gp.history,gn);gk.push(gp.history)}ef(gp,gn,null,el(gp,gn))})}function b8(gv,gt,gx){if(gv.cm&&gv.cm.state.suppressEdits){return}var gs=gv.history,gm,go=gv.sel;var gk=gt=="undo"?gs.done:gs.undone,gw=gt=="undo"?gs.undone:gs.done;for(var gp=0;gp<gk.length;gp++){gm=gk[gp];if(gx?gm.ranges&&!gm.equals(gv.sel):!gm.ranges){break}}if(gp==gk.length){return}gs.lastOrigin=gs.lastSelOrigin=null;for(;;){gm=gk.pop();if(gm.ranges){cN(gm,gw);if(gx&&!gm.equals(gv.sel)){bU(gv,gm,{clearRedo:false});return}go=gm}else{break}}var gr=[];cN(go,gw);gw.push({changes:gr,generation:gs.generation});gs.generation=gm.generation||++gs.maxGeneration;var gn=fj(gv,"beforeChange")||gv.cm&&fj(gv.cm,"beforeChange");for(var gp=gm.changes.length-1;gp>=0;--gp){var gu=gm.changes[gp];gu.origin=gt;if(gn&&!dS(gv,gu,false)){gk.length=0;return}gr.push(dv(gv,gu));var gl=gp?fl(gv,gu):fH(gk);ef(gv,gu,gl,ea(gv,gu));if(!gp&&gv.cm){gv.cm.scrollIntoView({from:gu.from,to:cX(gu)})}var gq=[];d8(gv,function(gz,gy){if(!gy&&di(gq,gz.history)==-1){dF(gz.history,gu);gq.push(gz.history)}ef(gz,gu,null,ea(gz,gu))})}}function fo(gl,gn){if(gn==0){return}gl.first+=gn;gl.sel=new f5(bS(gl.sel.ranges,function(go){return new dZ(W(go.anchor.line+gn,go.anchor.ch),W(go.head.line+gn,go.head.ch))}),gl.sel.primIndex);if(gl.cm){ah(gl.cm,gl.first,gl.first-gn,gn);for(var gm=gl.cm.display,gk=gm.viewFrom;gk<gm.viewTo;gk++){R(gl.cm,gk,"gutter")}}}function ef(go,gp,gn,gl){if(go.cm&&!go.cm.curOp){return c2(go.cm,ef)(go,gp,gn,gl)}if(gp.to.line<go.first){fo(go,gp.text.length-1-(gp.to.line-gp.from.line));return}if(gp.from.line>go.lastLine()){return}if(gp.from.line<go.first){var gk=gp.text.length-1-(go.first-gp.from.line);fo(go,gk);gp={from:W(go.first,0),to:W(gp.to.line+gk,gp.to.ch),text:[fH(gp.text)],origin:gp.origin}}var gm=go.lastLine();if(gp.to.line>gm){gp={from:gp.from,to:W(gm,fg(go,gm).text.length),text:[gp.text[0]],origin:gp.origin}}gp.removed=f6(go,gp.from,gp.to);if(!gn){gn=fl(go,gp)}if(go.cm){aJ(go.cm,gp,gl)}else{fz(go,gp,gl)}eq(go,gn,Z)}function aJ(gv,gr,gp){var gu=gv.doc,gq=gv.display,gs=gr.from,gt=gr.to;var gk=false,go=gs.line;if(!gv.options.lineWrapping){go=bN(x(fg(gu,gs.line)));gu.iter(go,gt.line+1,function(gx){if(gx==gq.maxLine){gk=true;return true}})}if(gu.sel.contains(gr.from,gr.to)>-1){V(gv)}fz(gu,gr,gp,be(gv));if(!gv.options.lineWrapping){gu.iter(go,gs.line+gr.text.length,function(gy){var gx=eo(gy);if(gx>gq.maxLineLength){gq.maxLine=gy;gq.maxLineLength=gx;gq.maxLineChanged=true;gk=false}});if(gk){gv.curOp.updateMaxLine=true}}gu.frontier=Math.min(gu.frontier,gs.line);eg(gv,400);var gw=gr.text.length-(gt.line-gs.line)-1;if(gr.full){ah(gv)}else{if(gs.line==gt.line&&gr.text.length==1&&!dT(gv.doc,gr)){R(gv,gs.line,"text")}else{ah(gv,gs.line,gt.line+1,gw)}}var gm=fj(gv,"changes"),gn=fj(gv,"change");if(gn||gm){var gl={from:gs,to:gt,text:gr.text,removed:gr.removed,origin:gr.origin};if(gn){ae(gv,"change",gv,gl)}if(gm){(gv.curOp.changeObjs||(gv.curOp.changeObjs=[])).push(gl)}}gv.display.selForContextMenu=null}function a1(gn,gm,gp,go,gk){if(!go){go=gp}if(cf(go,gp)<0){var gl=go;go=gp;gp=gl}if(typeof gm=="string"){gm=gn.splitLines(gm)}bg(gn,{from:gp,to:go,text:gm,origin:gk})}function d7(gl,go){if(aR(gl,"scrollCursorIntoView")){return}var gp=gl.display,gm=gp.sizer.getBoundingClientRect(),gk=null;if(go.top+gm.top<0){gk=true}else{if(go.bottom+gm.top>(window.innerHeight||document.documentElement.clientHeight)){gk=false}}if(gk!=null&&!fv){var gn=f4("div","\u200b",null,"position: absolute; top: "+(go.top-gp.viewOffset-e9(gl.display))+"px; height: "+(go.bottom-go.top+cT(gl)+gp.barHeight)+"px; left: "+go.left+"px; width: 2px;");gl.display.lineSpace.appendChild(gn);gn.scrollIntoView(gk);gl.display.lineSpace.removeChild(gn)}}function D(gu,gs,go,gn){if(gn==null){gn=0}for(var gp=0;gp<5;gp++){var gq=false,gt=dV(gu,gs);var gk=!go||go==gs?gt:dV(gu,go);var gm=G(gu,Math.min(gt.left,gk.left),Math.min(gt.top,gk.top)-gn,Math.max(gt.left,gk.left),Math.max(gt.bottom,gk.bottom)+gn);var gr=gu.doc.scrollTop,gl=gu.doc.scrollLeft;if(gm.scrollTop!=null){N(gu,gm.scrollTop);if(Math.abs(gu.doc.scrollTop-gr)>1){gq=true}}if(gm.scrollLeft!=null){bE(gu,gm.scrollLeft);if(Math.abs(gu.doc.scrollLeft-gl)>1){gq=true}}if(!gq){break}}return gt}function E(gk,gm,go,gl,gn){var gp=G(gk,gm,go,gl,gn);if(gp.scrollTop!=null){N(gk,gp.scrollTop)}if(gp.scrollLeft!=null){bE(gk,gp.scrollLeft)}}function G(gw,gn,gv,gl,gu){var gs=gw.display,gq=aY(gw.display);if(gv<0){gv=0}var go=gw.curOp&&gw.curOp.scrollTop!=null?gw.curOp.scrollTop:gs.scroller.scrollTop;var gy=cV(gw),gA={};if(gu-gv>gy){gu=gv+gy}var gm=gw.doc.height+bI(gs);var gk=gv<gq,gr=gu>gm-gq;if(gv<go){gA.scrollTop=gk?0:gv}else{if(gu>go+gy){var gt=Math.min(gv,(gr?gm:gu)-gy);if(gt!=go){gA.scrollTop=gt}}}var gz=gw.curOp&&gw.curOp.scrollLeft!=null?gw.curOp.scrollLeft:gs.scroller.scrollLeft;var gx=dm(gw)-(gw.options.fixedGutter?gs.gutters.offsetWidth:0);var gp=gl-gn>gx;if(gp){gl=gn+gx}if(gn<10){gA.scrollLeft=0}else{if(gn<gz){gA.scrollLeft=Math.max(0,gn-(gp?0:10))}else{if(gl>gx+gz-3){gA.scrollLeft=gl+(gp?0:10)-gx}}}return gA}function cL(gk,gm,gl){if(gm!=null||gl!=null){fD(gk)}if(gm!=null){gk.curOp.scrollLeft=(gk.curOp.scrollLeft==null?gk.doc.scrollLeft:gk.curOp.scrollLeft)+gm}if(gl!=null){gk.curOp.scrollTop=(gk.curOp.scrollTop==null?gk.doc.scrollTop:gk.curOp.scrollTop)+gl}}function fG(gk){fD(gk);var gl=gk.getCursor(),gn=gl,gm=gl;if(!gk.options.lineWrapping){gn=gl.ch?W(gl.line,gl.ch-1):gl;gm=W(gl.line,gl.ch+1)}gk.curOp.scrollToPos={from:gn,to:gm,margin:gk.options.cursorScrollMargin,isCursor:true}}function fD(gk){var gm=gk.curOp.scrollToPos;if(gm){gk.curOp.scrollToPos=null;var go=dI(gk,gm.from),gn=dI(gk,gm.to);var gl=G(gk,Math.min(go.left,gn.left),Math.min(go.top,gn.top)-gm.margin,Math.max(go.right,gn.right),Math.max(go.bottom,gn.bottom)+gm.margin);gk.scrollTo(gl.scrollLeft,gl.scrollTop)}}function ad(gx,gn,gw,gm){var gv=gx.doc,gl;if(gw==null){gw="add"}if(gw=="smart"){if(!gv.mode.indent){gw="prev"}else{gl=dD(gx,gn)}}var gr=gx.options.tabSize;var gy=fg(gv,gn),gq=bT(gy.text,null,gr);if(gy.stateAfter){gy.stateAfter=null}var gk=gy.text.match(/^\s*/)[0],gt;if(!gm&&!/\S/.test(gy.text)){gt=0;gw="not"}else{if(gw=="smart"){gt=gv.mode.indent(gl,gy.text.slice(gk.length),gy.text);if(gt==ca||gt>150){if(!gm){return}gw="prev"}}}if(gw=="prev"){if(gn>gv.first){gt=bT(fg(gv,gn-1).text,null,gr)}else{gt=0}}else{if(gw=="add"){gt=gq+gx.options.indentUnit}else{if(gw=="subtract"){gt=gq-gx.options.indentUnit}else{if(typeof gw=="number"){gt=gq+gw}}}}gt=Math.max(0,gt);var gu="",gs=0;if(gx.options.indentWithTabs){for(var go=Math.floor(gt/gr);go;--go){gs+=gr;gu+="\t"}}if(gs<gt){gu+=cp(gt-gs)}if(gu!=gk){a1(gv,gu,W(gn,0),W(gn,gk.length),"+input");gy.stateAfter=null;return true}else{for(var go=0;go<gv.sel.ranges.length;go++){var gp=gv.sel.ranges[go];if(gp.head.line==gn&&gp.head.ch<gk.length){var gs=W(gn,gk.length);e(gv,go,new dZ(gs,gs));break}}}}function eA(gn,gm,gk,gp){var go=gm,gl=gm;if(typeof gm=="number"){gl=fg(gn,c5(gn,gm))}else{go=bN(gm)}if(go==null){return null}if(gp(gl,go)&&gn.cm){R(gn.cm,go,gk)}return gl}function eY(gk,gq){var gl=gk.doc.sel.ranges,go=[];for(var gn=0;gn<gl.length;gn++){var gm=gq(gl[gn]);while(go.length&&cf(gm.from,fH(go).to)<=0){var gp=go.pop();if(cf(gp.from,gm.from)<0){gm.from=gp.from;break}}go.push(gm)}cM(gk,function(){for(var gr=go.length-1;gr>=0;gr--){a1(gk.doc,"",go[gr].from,go[gr].to,"+delete")}fG(gk)})}function bw(gC,go,gw,gv,gq){var gt=go.line,gu=go.ch,gB=gw;var gl=fg(gC,gt);var gz=true;function gA(){var gD=gt+gw;if(gD<gC.first||gD>=gC.first+gC.size){return(gz=false)}gt=gD;return gl=fg(gC,gD)}function gy(gE){var gD=(gq?u:ai)(gl,gu,gw,true);if(gD==null){if(!gE&&gA()){if(gq){gu=(gw<0?cS:cE)(gl)}else{gu=gw<0?gl.text.length:0}}else{return(gz=false)}}else{gu=gD}return true}if(gv=="char"){gy()}else{if(gv=="column"){gy(true)}else{if(gv=="word"||gv=="group"){var gx=null,gr=gv=="group";var gk=gC.cm&&gC.cm.getHelper(go,"wordChars");for(var gp=true;;gp=false){if(gw<0&&!gy(!gp)){break}var gm=gl.text.charAt(gu)||"\n";var gn=cA(gm,gk)?"w":gr&&gm=="\n"?"n":!gr||/\s/.test(gm)?null:"p";if(gr&&!gp&&!gn){gn="s"}if(gx&&gx!=gn){if(gw<0){gw=1;gy()}break}if(gn){gx=gn}if(gw>0&&!gy(!gp)){break}}}}}var gs=bV(gC,W(gt,gu),gB,true);if(!gz){gs.hitSide=true}return gs}function bq(gs,gn,gk,gr){var gq=gs.doc,gp=gn.left,go;if(gr=="page"){var gm=Math.min(gs.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);go=gn.top+gk*(gm-(gk<0?1.5:0.5)*aY(gs.display))}else{if(gr=="line"){go=gk>0?gn.bottom+3:gn.top-3}}for(;;){var gl=fP(gs,gp,go);if(!gl.outside){break}if(gk<0?go<=0:go>=gq.height){gl.hitSide=true;break}go+=gk*5}return gl}H.prototype={constructor:H,focus:function(){window.focus();this.display.input.focus()},setOption:function(gm,gn){var gl=this.options,gk=gl[gm];if(gl[gm]==gn&&gm!="mode"){return}gl[gm]=gn;if(bf.hasOwnProperty(gm)){c2(this,bf[gm])(this,gn,gk)}},getOption:function(gk){return this.options[gk]},getDoc:function(){return this.doc},addKeyMap:function(gl,gk){this.state.keyMaps[gk?"push":"unshift"](fZ(gl))},removeKeyMap:function(gl){var gm=this.state.keyMaps;for(var gk=0;gk<gm.length;++gk){if(gm[gk]==gl||gm[gk].name==gl){gm.splice(gk,1);return true}}},addOverlay:c8(function(gk,gl){var gm=gk.token?gk:H.getMode(this.options,gk);if(gm.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:gm,modeSpec:gk,opaque:gl&&gl.opaque});this.state.modeGen++;ah(this)}),removeOverlay:c8(function(gk){var gm=this.state.overlays;for(var gl=0;gl<gm.length;++gl){var gn=gm[gl].modeSpec;if(gn==gk||typeof gk=="string"&&gn.name==gk){gm.splice(gl,1);this.state.modeGen++;ah(this);return}}}),indentLine:c8(function(gm,gk,gl){if(typeof gk!="string"&&typeof gk!="number"){if(gk==null){gk=this.options.smartIndent?"smart":"prev"}else{gk=gk?"add":"subtract"}}if(b9(this.doc,gm)){ad(this,gm,gk,gl)}}),indentSelection:c8(function(gt){var gk=this.doc.sel.ranges,gn=-1;for(var gp=0;gp<gk.length;gp++){var gq=gk[gp];if(!gq.empty()){var gr=gq.from(),gs=gq.to();var gl=Math.max(gn,gr.line);gn=Math.min(this.lastLine(),gs.line-(gs.ch?0:1))+1;for(var go=gl;go<gn;++go){ad(this,go,gt)}var gm=this.doc.sel.ranges;if(gr.ch==0&&gk.length==gm.length&&gm[gp].from().ch>0){e(this.doc,gp,new dZ(gr,gm[gp].to()),Z)}}else{if(gq.head.line>gn){ad(this,gq.head.line,gt,true);gn=gq.head.line;if(gp==this.doc.sel.primIndex){fG(this)}}}}}),getTokenAt:function(gl,gk){return cq(this,gl,gk)},getLineTokens:function(gl,gk){return cq(this,W(gl),gk,true)},getTokenTypeAt:function(gr){gr=fK(this.doc,gr);var gn=c6(this,fg(this.doc,gr.line));var gp=0,gq=(gn.length-1)/2,gm=gr.ch;var gl;if(gm==0){gl=gn[2]}else{for(;;){var gk=(gp+gq)>>1;if((gk?gn[gk*2-1]:0)>=gm){gq=gk}else{if(gn[gk*2+1]<gm){gp=gk+1}else{gl=gn[gk*2+2];break}}}}var go=gl?gl.indexOf("cm-overlay "):-1;return go<0?gl:go==0?null:gl.slice(0,go-1)},getModeAt:function(gl){var gk=this.doc.mode;if(!gk.innerMode){return gk}return H.innerMode(gk,this.getTokenAt(gl).state).mode},getHelper:function(gl,gk){return this.getHelpers(gl,gk)[0]},getHelpers:function(gr,gm){var gn=[];if(!fp.hasOwnProperty(gm)){return gn}var gk=fp[gm],gq=this.getModeAt(gr);if(typeof gq[gm]=="string"){if(gk[gq[gm]]){gn.push(gk[gq[gm]])}}else{if(gq[gm]){for(var gl=0;gl<gq[gm].length;gl++){var gp=gk[gq[gm][gl]];if(gp){gn.push(gp)}}}else{if(gq.helperType&&gk[gq.helperType]){gn.push(gk[gq.helperType])}else{if(gk[gq.name]){gn.push(gk[gq.name])}}}}for(var gl=0;gl<gk._global.length;gl++){var go=gk._global[gl];if(go.pred(gq,this)&&di(gn,go.val)==-1){gn.push(go.val)}}return gn},getStateAfter:function(gl,gk){var gm=this.doc;gl=c5(gm,gl==null?gm.first+gm.size-1:gl);return dD(this,gl+1,gk)},cursorCoords:function(gn,gl){var gm,gk=this.doc.sel.primary();if(gn==null){gm=gk.head}else{if(typeof gn=="object"){gm=fK(this.doc,gn)}else{gm=gn?gk.from():gk.to()}}return dV(this,gm,gl||"page")},charCoords:function(gl,gk){return cJ(this,fK(this.doc,gl),gk||"page")},coordsChar:function(gk,gl){gk=gg(this,gk,gl||"page");return fP(this,gk.left,gk.top)},lineAtHeight:function(gk,gl){gk=gg(this,{top:gk,left:0},gl||"page").top;return bG(this.doc,gk+this.display.viewOffset)},heightAtLine:function(gl,go){var gk=false,gm;if(typeof gl=="number"){var gn=this.doc.first+this.doc.size-1;if(gl<this.doc.first){gl=this.doc.first}else{if(gl>gn){gl=gn;gk=true}}gm=fg(this.doc,gl)}else{gm=gl}return eR(this,gm,{top:0,left:0},go||"page").top+(gk?this.doc.height-bM(gm):0)},defaultTextHeight:function(){return aY(this.display)},defaultCharWidth:function(){return dE(this.display)},setGutterMarker:c8(function(gk,gl,gm){return eA(this.doc,gk,"gutter",function(gn){var go=gn.gutterMarkers||(gn.gutterMarkers={});go[gl]=gm;if(!gm&&eV(go)){gn.gutterMarkers=null}return true})}),clearGutter:c8(function(gm){var gk=this,gn=gk.doc,gl=gn.first;gn.iter(function(go){if(go.gutterMarkers&&go.gutterMarkers[gm]){go.gutterMarkers[gm]=null;R(gk,gl,"gutter");if(eV(go.gutterMarkers)){go.gutterMarkers=null}}++gl})}),lineInfo:function(gk){if(typeof gk=="number"){if(!b9(this.doc,gk)){return null}var gl=gk;gk=fg(this.doc,gk);if(!gk){return null}}else{var gl=bN(gk);if(gl==null){return null}}return{line:gl,handle:gk,text:gk.text,gutterMarkers:gk.gutterMarkers,textClass:gk.textClass,bgClass:gk.bgClass,wrapClass:gk.wrapClass,widgets:gk.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(gp,gm,gr,gn,gt){var go=this.display;gp=dV(this,fK(this.doc,gp));var gq=gp.bottom,gl=gp.left;gm.style.position="absolute";gm.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(gm);go.sizer.appendChild(gm);if(gn=="over"){gq=gp.top}else{if(gn=="above"||gn=="near"){var gk=Math.max(go.wrapper.clientHeight,this.doc.height),gs=Math.max(go.sizer.clientWidth,go.lineSpace.clientWidth);if((gn=="above"||gp.bottom+gm.offsetHeight>gk)&&gp.top>gm.offsetHeight){gq=gp.top-gm.offsetHeight}else{if(gp.bottom+gm.offsetHeight<=gk){gq=gp.bottom}}if(gl+gm.offsetWidth>gs){gl=gs-gm.offsetWidth}}}gm.style.top=gq+"px";gm.style.left=gm.style.right="";if(gt=="right"){gl=go.sizer.clientWidth-gm.offsetWidth;gm.style.right="0px"}else{if(gt=="left"){gl=0}else{if(gt=="middle"){gl=(go.sizer.clientWidth-gm.offsetWidth)/2}}gm.style.left=gl+"px"}if(gr){E(this,gl,gq,gl+gm.offsetWidth,gq+gm.offsetHeight)}},triggerOnKeyDown:c8(p),triggerOnKeyPress:c8(cx),triggerOnKeyUp:bi,execCommand:function(gk){if(eE.hasOwnProperty(gk)){return eE[gk].call(null,this)}},triggerElectric:c8(function(gk){fX(this,gk)}),findPosH:function(gq,gn,go,gl){var gk=1;if(gn<0){gk=-1;gn=-gn}for(var gm=0,gp=fK(this.doc,gq);gm<gn;++gm){gp=bw(this.doc,gp,gk,go,gl);if(gp.hitSide){break}}return gp},moveH:c8(function(gl,gm){var gk=this;gk.extendSelectionsBy(function(gn){if(gk.display.shift||gk.doc.extend||gn.empty()){return bw(gk.doc,gn.head,gl,gm,gk.options.rtlMoveVisually)}else{return gl<0?gn.from():gn.to()}},cW)}),deleteH:c8(function(gk,gl){var gm=this.doc.sel,gn=this.doc;if(gm.somethingSelected()){gn.replaceSelection("",null,"+delete")}else{eY(this,function(gp){var go=bw(gn,gp.head,gk,gl,false);return gk<0?{from:go,to:gp.head}:{from:gp.head,to:go}})}}),findPosV:function(gp,gm,gq,gs){var gk=1,go=gs;if(gm<0){gk=-1;gm=-gm}for(var gl=0,gr=fK(this.doc,gp);gl<gm;++gl){var gn=dV(this,gr,"div");if(go==null){go=gn.left}else{gn.left=go}gr=bq(this,gn,gk,gq);if(gr.hitSide){break}}return gr},moveV:c8(function(gl,gn){var gk=this,gp=this.doc,go=[];var gq=!gk.display.shift&&!gp.extend&&gp.sel.somethingSelected();gp.extendSelectionsBy(function(gr){if(gq){return gl<0?gr.from():gr.to()}var gt=dV(gk,gr.head,"div");if(gr.goalColumn!=null){gt.left=gr.goalColumn}go.push(gt.left);var gs=bq(gk,gt,gl,gn);if(gn=="page"&&gr==gp.sel.primary()){cL(gk,null,cJ(gk,gs,"div").top-gt.top)}return gs},cW);if(go.length){for(var gm=0;gm<gp.sel.ranges.length;gm++){gp.sel.ranges[gm].goalColumn=go[gm]}}}),findWordAt:function(gr){var gp=this.doc,gn=fg(gp,gr.line).text;var gq=gr.ch,gm=gr.ch;if(gn){var go=this.getHelper(gr,"wordChars");if((gr.xRel<0||gm==gn.length)&&gq){--gq}else{++gm}var gl=gn.charAt(gq);var gk=cA(gl,go)?function(gs){return cA(gs,go)}:/\s/.test(gl)?function(gs){return/\s/.test(gs)}:function(gs){return !/\s/.test(gs)&&!cA(gs)};while(gq>0&&gk(gn.charAt(gq-1))){--gq}while(gm<gn.length&&gk(gn.charAt(gm))){++gm}}return new dZ(W(gr.line,gq),W(gr.line,gm))},toggleOverwrite:function(gk){if(gk!=null&&gk==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fB(this.display.cursorDiv,"CodeMirror-overwrite")}else{f(this.display.cursorDiv,"CodeMirror-overwrite")}aE(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==dP()},scrollTo:c8(function(gk,gl){if(gk!=null||gl!=null){fD(this)}if(gk!=null){this.curOp.scrollLeft=gk}if(gl!=null){this.curOp.scrollTop=gl}}),getScrollInfo:function(){var gk=this.display.scroller;return{left:gk.scrollLeft,top:gk.scrollTop,height:gk.scrollHeight-cT(this)-this.display.barHeight,width:gk.scrollWidth-cT(this)-this.display.barWidth,clientHeight:cV(this),clientWidth:dm(this)}},scrollIntoView:c8(function(gl,gm){if(gl==null){gl={from:this.doc.sel.primary().head,to:null};if(gm==null){gm=this.options.cursorScrollMargin}}else{if(typeof gl=="number"){gl={from:W(gl,0),to:null}}else{if(gl.from==null){gl={from:gl,to:null}}}}if(!gl.to){gl.to=gl.from}gl.margin=gm||0;if(gl.from.line!=null){fD(this);this.curOp.scrollToPos=gl}else{var gk=G(this,Math.min(gl.from.left,gl.to.left),Math.min(gl.from.top,gl.to.top)-gl.margin,Math.max(gl.from.right,gl.to.right),Math.max(gl.from.bottom,gl.to.bottom)+gl.margin);this.scrollTo(gk.scrollLeft,gk.scrollTop)}}),setSize:c8(function(gn,gl){var gk=this;function gm(gp){return typeof gp=="number"||/^\d+$/.test(String(gp))?gp+"px":gp}if(gn!=null){gk.display.wrapper.style.width=gm(gn)}if(gl!=null){gk.display.wrapper.style.height=gm(gl)}if(gk.options.lineWrapping){aO(this)}var go=gk.display.viewFrom;gk.doc.iter(go,gk.display.viewTo,function(gp){if(gp.widgets){for(var gq=0;gq<gp.widgets.length;gq++){if(gp.widgets[gq].noHScroll){R(gk,go,"widget");break}}}++go});gk.curOp.forceUpdate=true;aE(gk,"refresh",this)}),operation:function(gk){return cM(this,gk)},refresh:c8(function(){var gk=this.display.cachedTextHeight;ah(this);this.curOp.forceUpdate=true;ak(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);c4(this);if(gk==null||Math.abs(gk-aY(this.display))>0.5){X(this)}aE(this,"refresh",this)}),swapDoc:c8(function(gl){var gk=this.doc;gk.cm=null;ec(this,gl);ak(this);this.display.input.reset();this.scrollTo(gl.scrollLeft,gl.scrollTop);this.curOp.forceScroll=true;ae(this,"swapDoc",this,gk);return gk}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};by(H);var e4=H.defaults={};var bf=H.optionHandlers={};function s(gk,gn,gm,gl){H.defaults[gk]=gn;if(gm){bf[gk]=gl?function(go,gq,gp){if(gp!=cc){gm(go,gq,gp)}}:gm}}var cc=H.Init={toString:function(){return"CodeMirror.Init"}};s("value","",function(gk,gl){gk.setValue(gl)},true);s("mode",null,function(gk,gl){gk.doc.modeOption=gl;br(gk)},true);s("indentUnit",2,br,true);s("indentWithTabs",false);s("smartIndent",true);s("tabSize",4,function(gk){em(gk);ak(gk);ah(gk)},true);s("lineSeparator",null,function(gk,gn){gk.doc.lineSep=gn;if(!gn){return}var gm=[],go=gk.doc.first;gk.doc.iter(function(gp){for(var gr=0;;){var gq=gp.text.indexOf(gn,gr);if(gq==-1){break}gr=gq+gn.length;gm.push(W(go,gq))}go++});for(var gl=gm.length-1;gl>=0;gl--){a1(gk.doc,gn,gm[gl],W(gm[gl].line,gm[gl].ch+gn.length))}});s("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(gk,gm,gl){gk.state.specialChars=new RegExp(gm.source+(gm.test("\t")?"":"|\t"),"g");if(gl!=H.Init){gk.refresh()}});s("specialCharPlaceholder",fd,function(gk){gk.refresh()},true);s("electricChars",true);s("inputStyle",eh?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);s("rtlMoveVisually",!aP);s("wholeLineUpdateBefore",true);s("theme","default",function(gk){cO(gk);dx(gk)},true);s("keyMap","default",function(gk,go,gl){var gm=fZ(go);var gn=gl!=H.Init&&fZ(gl);if(gn&&gn.detach){gn.detach(gk,gm)}if(gm.attach){gm.attach(gk,gn||null)}});s("extraKeys",null);s("lineWrapping",false,eH,true);s("gutters",[],function(gk){ce(gk.options);dx(gk)},true);s("fixedGutter",true,function(gk,gl){gk.display.gutters.style.left=gl?dY(gk.display)+"px":"0";gk.refresh()},true);s("coverGutterNextToScrollbar",false,function(gk){eZ(gk)},true);s("scrollbarStyle","native",function(gk){aD(gk);eZ(gk);gk.display.scrollbars.setScrollTop(gk.doc.scrollTop);gk.display.scrollbars.setScrollLeft(gk.doc.scrollLeft)},true);s("lineNumbers",false,function(gk){ce(gk.options);dx(gk)},true);s("firstLineNumber",1,dx,true);s("lineNumberFormatter",function(gk){return gk},dx,true);s("showCursorWhenSelecting",false,bC,true);s("resetSelectionOnContextMenu",true);s("lineWiseCopyCut",true);s("readOnly",false,function(gk,gl){if(gl=="nocursor"){aV(gk);gk.display.input.blur();gk.display.disabled=true}else{gk.display.disabled=false}gk.display.input.readOnlyChanged(gl)});s("disableInput",false,function(gk,gl){if(!gl){gk.display.input.reset()}},true);s("dragDrop",true,f2);s("cursorBlinkRate",530);s("cursorScrollMargin",0);s("cursorHeight",1,bC,true);s("singleCursorHeightPerLine",true,bC,true);s("workTime",100);s("workDelay",100);s("flattenSpans",true,em,true);s("addModeClass",false,em,true);s("pollInterval",100);s("undoDepth",200,function(gk,gl){gk.doc.history.undoDepth=gl});s("historyEventDelay",1250);s("viewportMargin",10,function(gk){gk.refresh()},true);s("maxHighlightLength",10000,em,true);s("moveInputWithCursor",true,function(gk,gl){if(!gl){gk.display.input.resetPosition()}});s("tabindex",null,function(gk,gl){gk.display.input.getField().tabIndex=gl||""});s("autofocus",null);var dt=H.modes={},aS=H.mimeModes={};H.defineMode=function(gk,gl){if(!H.defaults.mode&&gk!="null"){H.defaults.mode=gk}if(arguments.length>2){gl.dependencies=Array.prototype.slice.call(arguments,2)}dt[gk]=gl};H.defineMIME=function(gl,gk){aS[gl]=gk};H.resolveMode=function(gk){if(typeof gk=="string"&&aS.hasOwnProperty(gk)){gk=aS[gk]}else{if(gk&&typeof gk.name=="string"&&aS.hasOwnProperty(gk.name)){var gl=aS[gk.name];if(typeof gl=="string"){gl={name:gl}}gk=ck(gl,gk);gk.name=gl.name}else{if(typeof gk=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(gk)){return H.resolveMode("application/xml")}}}if(typeof gk=="string"){return{name:gk}}else{return gk||{name:"null"}}};H.getMode=function(gl,gk){var gk=H.resolveMode(gk);var gn=dt[gk.name];if(!gn){return H.getMode(gl,"text/plain")}var go=gn(gl,gk);if(dq.hasOwnProperty(gk.name)){var gm=dq[gk.name];for(var gp in gm){if(!gm.hasOwnProperty(gp)){continue}if(go.hasOwnProperty(gp)){go["_"+gp]=go[gp]}go[gp]=gm[gp]}}go.name=gk.name;if(gk.helperType){go.helperType=gk.helperType}if(gk.modeProps){for(var gp in gk.modeProps){go[gp]=gk.modeProps[gp]}}return go};H.defineMode("null",function(){return{token:function(gk){gk.skipToEnd()}}});H.defineMIME("text/plain","null");var dq=H.modeExtensions={};H.extendMode=function(gm,gl){var gk=dq.hasOwnProperty(gm)?dq[gm]:(dq[gm]={});aN(gl,gk)};H.defineExtension=function(gk,gl){H.prototype[gk]=gl};H.defineDocExtension=function(gk,gl){at.prototype[gk]=gl};H.defineOption=s;var a8=[];H.defineInitHook=function(gk){a8.push(gk)};var fp=H.helpers={};H.registerHelper=function(gl,gk,gm){if(!fp.hasOwnProperty(gl)){fp[gl]=H[gl]={_global:[]}}fp[gl][gk]=gm};H.registerGlobalHelper=function(gm,gl,gk,gn){H.registerHelper(gm,gl,gn);fp[gm]._global.push({pred:gk,val:gn})};var b3=H.copyState=function(gn,gk){if(gk===true){return gk}if(gn.copyState){return gn.copyState(gk)}var gm={};for(var go in gk){var gl=gk[go];if(gl instanceof Array){gl=gl.concat([])}gm[go]=gl}return gm};var b0=H.startState=function(gm,gl,gk){return gm.startState?gm.startState(gl,gk):true};H.innerMode=function(gm,gk){while(gm.innerMode){var gl=gm.innerMode(gk);if(!gl||gl.mode==gm){break}gk=gl.state;gm=gl.mode}return gl||{mode:gm,state:gk}};var eE=H.commands={selectAll:function(gk){gk.setSelection(W(gk.firstLine(),0),W(gk.lastLine()),Z)},singleSelection:function(gk){gk.setSelection(gk.getCursor("anchor"),gk.getCursor("head"),Z)},killLine:function(gk){eY(gk,function(gm){if(gm.empty()){var gl=fg(gk.doc,gm.head.line).text.length;if(gm.head.ch==gl&&gm.head.line<gk.lastLine()){return{from:gm.head,to:W(gm.head.line+1,0)}}else{return{from:gm.head,to:W(gm.head.line,gl)}}}else{return{from:gm.from(),to:gm.to()}}})},deleteLine:function(gk){eY(gk,function(gl){return{from:W(gl.from().line,0),to:fK(gk.doc,W(gl.to().line+1,0))}})},delLineLeft:function(gk){eY(gk,function(gl){return{from:W(gl.from().line,0),to:gl.from()}})},delWrappedLineLeft:function(gk){eY(gk,function(gl){var gn=gk.charCoords(gl.head,"div").top+5;var gm=gk.coordsChar({left:0,top:gn},"div");return{from:gm,to:gl.from()}})},delWrappedLineRight:function(gk){eY(gk,function(gl){var gn=gk.charCoords(gl.head,"div").top+5;var gm=gk.coordsChar({left:gk.display.lineDiv.offsetWidth+100,top:gn},"div");return{from:gl.from(),to:gm}})},undo:function(gk){gk.undo()},redo:function(gk){gk.redo()},undoSelection:function(gk){gk.undoSelection()},redoSelection:function(gk){gk.redoSelection()},goDocStart:function(gk){gk.extendSelection(W(gk.firstLine(),0))},goDocEnd:function(gk){gk.extendSelection(W(gk.lastLine()))},goLineStart:function(gk){gk.extendSelectionsBy(function(gl){return bt(gk,gl.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(gk){gk.extendSelectionsBy(function(gl){return dJ(gk,gl.head)},{origin:"+move",bias:1})},goLineEnd:function(gk){gk.extendSelectionsBy(function(gl){return dQ(gk,gl.head.line)},{origin:"+move",bias:-1})},goLineRight:function(gk){gk.extendSelectionsBy(function(gl){var gm=gk.charCoords(gl.head,"div").top+5;return gk.coordsChar({left:gk.display.lineDiv.offsetWidth+100,top:gm},"div")},cW)},goLineLeft:function(gk){gk.extendSelectionsBy(function(gl){var gm=gk.charCoords(gl.head,"div").top+5;return gk.coordsChar({left:0,top:gm},"div")},cW)},goLineLeftSmart:function(gk){gk.extendSelectionsBy(function(gl){var gm=gk.charCoords(gl.head,"div").top+5;var gn=gk.coordsChar({left:0,top:gm},"div");if(gn.ch<gk.getLine(gn.line).search(/\S/)){return dJ(gk,gl.head)}return gn},cW)},goLineUp:function(gk){gk.moveV(-1,"line")},goLineDown:function(gk){gk.moveV(1,"line")},goPageUp:function(gk){gk.moveV(-1,"page")},goPageDown:function(gk){gk.moveV(1,"page")},goCharLeft:function(gk){gk.moveH(-1,"char")},goCharRight:function(gk){gk.moveH(1,"char")},goColumnLeft:function(gk){gk.moveH(-1,"column")},goColumnRight:function(gk){gk.moveH(1,"column")},goWordLeft:function(gk){gk.moveH(-1,"word")},goGroupRight:function(gk){gk.moveH(1,"group")},goGroupLeft:function(gk){gk.moveH(-1,"group")},goWordRight:function(gk){gk.moveH(1,"word")},delCharBefore:function(gk){gk.deleteH(-1,"char")},delCharAfter:function(gk){gk.deleteH(1,"char")},delWordBefore:function(gk){gk.deleteH(-1,"word")},delWordAfter:function(gk){gk.deleteH(1,"word")},delGroupBefore:function(gk){gk.deleteH(-1,"group")},delGroupAfter:function(gk){gk.deleteH(1,"group")},indentAuto:function(gk){gk.indentSelection("smart")},indentMore:function(gk){gk.indentSelection("add")},indentLess:function(gk){gk.indentSelection("subtract")},insertTab:function(gk){gk.replaceSelection("\t")},insertSoftTab:function(gk){var gm=[],gl=gk.listSelections(),gp=gk.options.tabSize;for(var go=0;go<gl.length;go++){var gq=gl[go].from();var gn=bT(gk.getLine(gq.line),gq.ch,gp);gm.push(new Array(gp-gn%gp+1).join(" "))}gk.replaceSelections(gm)},defaultTab:function(gk){if(gk.somethingSelected()){gk.indentSelection("add")}else{gk.execCommand("insertTab")}},transposeChars:function(gk){cM(gk,function(){var gn=gk.listSelections(),gm=[];for(var go=0;go<gn.length;go++){var gq=gn[go].head,gl=fg(gk.doc,gq.line).text;if(gl){if(gq.ch==gl.length){gq=new W(gq.line,gq.ch-1)}if(gq.ch>0){gq=new W(gq.line,gq.ch+1);gk.replaceRange(gl.charAt(gq.ch-1)+gl.charAt(gq.ch-2),W(gq.line,gq.ch-2),gq,"+transpose")}else{if(gq.line>gk.doc.first){var gp=fg(gk.doc,gq.line-1).text;if(gp){gk.replaceRange(gl.charAt(0)+gk.doc.lineSeparator()+gp.charAt(gp.length-1),W(gq.line-1,gp.length-1),W(gq.line,1),"+transpose")}}}}gm.push(new dZ(gq,gq))}gk.setSelections(gm)})},newlineAndIndent:function(gk){cM(gk,function(){var gl=gk.listSelections().length;for(var gn=0;gn<gl;gn++){var gm=gk.listSelections()[gn];gk.replaceRange(gk.doc.lineSeparator(),gm.anchor,gm.head,"+input");gk.indentLine(gm.from().line+1,null,true);fG(gk)}})},toggleOverwrite:function(gk){gk.toggleOverwrite()}};var fb=H.keyMap={};fb.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};fb.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};fb.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};fb.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};fb["default"]=b7?fb.macDefault:fb.pcDefault;function du(gl){var gr=gl.split(/-(?!$)/),gl=gr[gr.length-1];var gq,gp,gk,go;for(var gn=0;gn<gr.length-1;gn++){var gm=gr[gn];if(/^(cmd|meta|m)$/i.test(gm)){go=true}else{if(/^a(lt)?$/i.test(gm)){gq=true}else{if(/^(c|ctrl|control)$/i.test(gm)){gp=true}else{if(/^s(hift)$/i.test(gm)){gk=true}else{throw new Error("Unrecognized modifier name: "+gm)}}}}}if(gq){gl="Alt-"+gl}if(gp){gl="Ctrl-"+gl}if(go){gl="Cmd-"+gl}if(gk){gl="Shift-"+gl}return gl}H.normalizeKeyMap=function(gr){var gl={};for(var gq in gr){if(gr.hasOwnProperty(gq)){var gs=gr[gq];if(/^(name|fallthrough|(de|at)tach)$/.test(gq)){continue}if(gs=="..."){delete gr[gq];continue}var gt=bS(gq.split(" "),du);for(var gp=0;gp<gt.length;gp++){var gn,gm;if(gp==gt.length-1){gm=gt.join(" ");gn=gs}else{gm=gt.slice(0,gp+1).join(" ");gn="..."}var go=gl[gm];if(!go){gl[gm]=gn}else{if(go!=gn){throw new Error("Inconsistent bindings for "+gm)}}}delete gr[gq]}}for(var gk in gl){gr[gk]=gl[gk]}return gr};var i=H.lookupKey=function(gn,gq,gp,gm){gq=fZ(gq);var go=gq.call?gq.call(gn,gm):gq[gn];if(go===false){return"nothing"}if(go==="..."){return"multi"}if(go!=null&&gp(go)){return"handled"}if(gq.fallthrough){if(Object.prototype.toString.call(gq.fallthrough)!="[object Array]"){return i(gn,gq.fallthrough,gp,gm)}for(var gl=0;gl<gq.fallthrough.length;gl++){var gk=i(gn,gq.fallthrough[gl],gp,gm);if(gk){return gk}}}};var eD=H.isModifierKey=function(gl){var gk=typeof gl=="string"?gl:fh[gl.keyCode];return gk=="Ctrl"||gk=="Alt"||gk=="Shift"||gk=="Mod"};var fs=H.keyName=function(gl,gn){if(d4&&gl.keyCode==34&&gl["char"]){return false}var gm=fh[gl.keyCode],gk=gm;if(gk==null||gl.altGraphKey){return false}if(gl.altKey&&gm!="Alt"){gk="Alt-"+gk}if((bQ?gl.metaKey:gl.ctrlKey)&&gm!="Ctrl"){gk="Ctrl-"+gk}if((bQ?gl.ctrlKey:gl.metaKey)&&gm!="Cmd"){gk="Cmd-"+gk}if(!gn&&gl.shiftKey&&gm!="Shift"){gk="Shift-"+gk}return gk};function fZ(gk){return typeof gk=="string"?fb[gk]:gk}H.fromTextArea=function(gr,gs){gs=gs?aN(gs):{};gs.value=gr.value;if(!gs.tabindex&&gr.tabIndex){gs.tabindex=gr.tabIndex}if(!gs.placeholder&&gr.placeholder){gs.placeholder=gr.placeholder}if(gs.autofocus==null){var gk=dP();gs.autofocus=gk==gr||gr.getAttribute("autofocus")!=null&&gk==document.body}function go(){gr.value=gq.getValue()}if(gr.form){bX(gr.form,"submit",go);if(!gs.leaveSubmitMethodAlone){var gl=gr.form,gp=gl.submit;try{var gn=gl.submit=function(){go();gl.submit=gp;gl.submit();gl.submit=gn}}catch(gm){}}}gs.finishInit=function(gt){gt.save=go;gt.getTextArea=function(){return gr};gt.toTextArea=function(){gt.toTextArea=isNaN;go();gr.parentNode.removeChild(gt.getWrapperElement());gr.style.display="";if(gr.form){ee(gr.form,"submit",go);if(typeof gr.form.submit=="function"){gr.form.submit=gp}}}};gr.style.display="none";var gq=H(function(gt){gr.parentNode.insertBefore(gt,gr.nextSibling)},gs);return gq};var eU=H.StringStream=function(gk,gl){this.pos=this.start=0;this.string=gk;this.tabSize=gl||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};eU.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(gk){var gm=this.string.charAt(this.pos);if(typeof gk=="string"){var gl=gm==gk}else{var gl=gm&&(gk.test?gk.test(gm):gk(gm))}if(gl){++this.pos;return gm}},eatWhile:function(gk){var gl=this.pos;while(this.eat(gk)){}return this.pos>gl},eatSpace:function(){var gk=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>gk},skipToEnd:function(){this.pos=this.string.length},skipTo:function(gk){var gl=this.string.indexOf(gk,this.pos);if(gl>-1){this.pos=gl;return true}},backUp:function(gk){this.pos-=gk},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bT(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bT(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bT(this.string,null,this.tabSize)-(this.lineStart?bT(this.string,this.lineStart,this.tabSize):0)},match:function(go,gl,gk){if(typeof go=="string"){var gp=function(gq){return gk?gq.toLowerCase():gq};var gn=this.string.substr(this.pos,go.length);if(gp(gn)==gp(go)){if(gl!==false){this.pos+=go.length}return true}}else{var gm=this.string.slice(this.pos).match(go);if(gm&&gm.index>0){return null}if(gm&&gl!==false){this.pos+=gm[0].length}return gm}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(gl,gk){this.lineStart+=gl;try{return gk()}finally{this.lineStart-=gl}}};var a5=0;var P=H.TextMarker=function(gl,gk){this.lines=[];this.type=gk;this.doc=gl;this.id=++a5};by(P);P.prototype.clear=function(){if(this.explicitlyCleared){return}var gr=this.doc.cm,gl=gr&&!gr.curOp;if(gl){cI(gr)}if(fj(this,"clear")){var gs=this.find();if(gs){ae(this,"clear",gs.from,gs.to)}}var gm=null,gp=null;for(var gn=0;gn<this.lines.length;++gn){var gt=this.lines[gn];var gq=fa(gt.markedSpans,this);if(gr&&!this.collapsed){R(gr,bN(gt),"text")}else{if(gr){if(gq.to!=null){gp=bN(gt)}if(gq.from!=null){gm=bN(gt)}}}gt.markedSpans=eI(gt.markedSpans,gq);if(gq.from==null&&this.collapsed&&!fx(this.doc,gt)&&gr){f7(gt,aY(gr.display))}}if(gr&&this.collapsed&&!gr.options.lineWrapping){for(var gn=0;gn<this.lines.length;++gn){var gk=x(this.lines[gn]),go=eo(gk);if(go>gr.display.maxLineLength){gr.display.maxLine=gk;gr.display.maxLineLength=go;gr.display.maxLineChanged=true}}}if(gm!=null&&gr&&this.collapsed){ah(gr,gm,gp+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(gr){ez(gr.doc)}}if(gr){ae(gr,"markerCleared",gr,this)}if(gl){am(gr)}if(this.parent){this.parent.clear()}};P.prototype.find=function(gn,gl){if(gn==null&&this.type=="bookmark"){gn=1}var gq,gp;for(var gm=0;gm<this.lines.length;++gm){var gk=this.lines[gm];var go=fa(gk.markedSpans,this);if(go.from!=null){gq=W(gl?gk:bN(gk),go.from);if(gn==-1){return gq}}if(go.to!=null){gp=W(gl?gk:bN(gk),go.to);if(gn==1){return gp}}}return gq&&{from:gq,to:gp}};P.prototype.changed=function(){var gm=this.find(-1,true),gl=this,gk=this.doc.cm;if(!gm||!gk){return}cM(gk,function(){var go=gm.line,gp=bN(gm.line);var gn=fc(gk,gp);if(gn){au(gn);gk.curOp.selectionChanged=gk.curOp.forceUpdate=true}gk.curOp.updateMaxLine=true;if(!fx(gl.doc,go)&&gl.height!=null){var gr=gl.height;gl.height=null;var gq=cY(gl)-gr;if(gq){f7(go,go.height+gq)}}})};P.prototype.attachLine=function(gk){if(!this.lines.length&&this.doc.cm){var gl=this.doc.cm.curOp;if(!gl.maybeHiddenMarkers||di(gl.maybeHiddenMarkers,this)==-1){(gl.maybeUnhiddenMarkers||(gl.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(gk)};P.prototype.detachLine=function(gk){this.lines.splice(di(this.lines,gk),1);if(!this.lines.length&&this.doc.cm){var gl=this.doc.cm.curOp;(gl.maybeHiddenMarkers||(gl.maybeHiddenMarkers=[])).push(this)}};var a5=0;function eG(gs,gq,gr,gu,go){if(gu&&gu.shared){return O(gs,gq,gr,gu,go)}if(gs.cm&&!gs.cm.curOp){return c2(gs.cm,eG)(gs,gq,gr,gu,go)}var gn=new P(gs,go),gt=cf(gq,gr);if(gu){aN(gu,gn,false)}if(gt>0||gt==0&&gn.clearWhenEmpty!==false){return gn}if(gn.replacedWith){gn.collapsed=true;gn.widgetNode=f4("span",[gn.replacedWith],"CodeMirror-widget");if(!gu.handleMouseEvents){gn.widgetNode.setAttribute("cm-ignore-events","true")}if(gu.insertLeft){gn.widgetNode.insertLeft=true}}if(gn.collapsed){if(z(gs,gq.line,gq,gr,gn)||gq.line!=gr.line&&z(gs,gr.line,gq,gr,gn)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}a7=true}if(gn.addToHistory){fN(gs,{from:gq,to:gr,origin:"markText"},gs.sel,NaN)}var gl=gq.line,gp=gs.cm,gk;gs.iter(gl,gr.line+1,function(gv){if(gp&&gn.collapsed&&!gp.options.lineWrapping&&x(gv)==gp.display.maxLine){gk=true}if(gn.collapsed&&gl!=gq.line){f7(gv,0)}cd(gv,new ej(gn,gl==gq.line?gq.ch:null,gl==gr.line?gr.ch:null));++gl});if(gn.collapsed){gs.iter(gq.line,gr.line+1,function(gv){if(fx(gs,gv)){f7(gv,0)}})}if(gn.clearOnEnter){bX(gn,"beforeCursorEnter",function(){gn.clear()})}if(gn.readOnly){ge=true;if(gs.history.done.length||gs.history.undone.length){gs.clearHistory()}}if(gn.collapsed){gn.id=++a5;gn.atomic=true}if(gp){if(gk){gp.curOp.updateMaxLine=true}if(gn.collapsed){ah(gp,gq.line,gr.line+1)}else{if(gn.className||gn.title||gn.startStyle||gn.endStyle||gn.css){for(var gm=gq.line;gm<=gr.line;gm++){R(gp,gm,"text")}}}if(gn.atomic){ez(gp.doc)}ae(gp,"markerAdded",gp,gn)}return gn}var y=H.SharedTextMarker=function(gm,gl){this.markers=gm;this.primary=gl;for(var gk=0;gk<gm.length;++gk){gm[gk].parent=this}};by(y);y.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var gk=0;gk<this.markers.length;++gk){this.markers[gk].clear()}ae(this,"clear")};y.prototype.find=function(gl,gk){return this.primary.find(gl,gk)};function O(go,gr,gq,gk,gm){gk=aN(gk);gk.shared=false;var gp=[eG(go,gr,gq,gk,gm)],gl=gp[0];var gn=gk.widgetNode;d8(go,function(gt){if(gn){gk.widgetNode=gn.cloneNode(true)}gp.push(eG(gt,fK(gt,gr),fK(gt,gq),gk,gm));for(var gs=0;gs<gt.linked.length;++gs){if(gt.linked[gs].isParent){return}}gl=fH(gp)});return new y(gp,gl)}function eQ(gk){return gk.findMarks(W(gk.first,0),gk.clipPos(W(gk.lastLine())),function(gl){return gl.parent})}function dG(gp,gq){for(var gn=0;gn<gq.length;gn++){var gl=gq[gn],gr=gl.find();var gk=gp.clipPos(gr.from),go=gp.clipPos(gr.to);if(cf(gk,go)){var gm=eG(gp,gk,go,gl.primary,gl.primary.type);gl.markers.push(gm);gm.parent=gl}}}function ep(gn){for(var gm=0;gm<gn.length;gm++){var gk=gn[gm],gp=[gk.primary.doc];d8(gk.primary.doc,function(gq){gp.push(gq)});for(var gl=0;gl<gk.markers.length;gl++){var go=gk.markers[gl];if(di(gp,go.doc)==-1){go.parent=null;gk.markers.splice(gl--,1)}}}}function ej(gk,gm,gl){this.marker=gk;this.from=gm;this.to=gl}function fa(gm,gk){if(gm){for(var gl=0;gl<gm.length;++gl){var gn=gm[gl];if(gn.marker==gk){return gn}}}}function eI(gl,gm){for(var gn,gk=0;gk<gl.length;++gk){if(gl[gk]!=gm){(gn||(gn=[])).push(gl[gk])}}return gn}function cd(gk,gl){gk.markedSpans=gk.markedSpans?gk.markedSpans.concat([gl]):[gl];gl.marker.attachLine(gk)}function aQ(gl,gm,gq){if(gl){for(var go=0,gr;go<gl.length;++go){var gs=gl[go],gp=gs.marker;var gk=gs.from==null||(gp.inclusiveLeft?gs.from<=gm:gs.from<gm);if(gk||gs.from==gm&&gp.type=="bookmark"&&(!gq||!gs.marker.insertLeft)){var gn=gs.to==null||(gp.inclusiveRight?gs.to>=gm:gs.to>gm);(gr||(gr=[])).push(new ej(gp,gs.from,gn?null:gs.to))}}}return gr}function aB(gl,gn,gq){if(gl){for(var go=0,gr;go<gl.length;++go){var gs=gl[go],gp=gs.marker;var gm=gs.to==null||(gp.inclusiveRight?gs.to>=gn:gs.to>gn);if(gm||gs.from==gn&&gp.type=="bookmark"&&(!gq||gs.marker.insertLeft)){var gk=gs.from==null||(gp.inclusiveLeft?gs.from<=gn:gs.from<gn);(gr||(gr=[])).push(new ej(gp,gk?null:gs.from-gn,gs.to==null?null:gs.to-gn))}}}return gr}function el(gw,gt){if(gt.full){return null}var gs=b9(gw,gt.from.line)&&fg(gw,gt.from.line).markedSpans;var gz=b9(gw,gt.to.line)&&fg(gw,gt.to.line).markedSpans;if(!gs&&!gz){return null}var gl=gt.from.ch,go=gt.to.ch,gr=cf(gt.from,gt.to)==0;var gq=aQ(gs,gl,gr);var gy=aB(gz,go,gr);var gx=gt.text.length==1,gm=fH(gt.text).length+(gx?gl:0);if(gq){for(var gn=0;gn<gq.length;++gn){var gv=gq[gn];if(gv.to==null){var gA=fa(gy,gv.marker);if(!gA){gv.to=gl}else{if(gx){gv.to=gA.to==null?null:gA.to+gm}}}}}if(gy){for(var gn=0;gn<gy.length;++gn){var gv=gy[gn];if(gv.to!=null){gv.to+=gm}if(gv.from==null){var gA=fa(gq,gv.marker);if(!gA){gv.from=gm;if(gx){(gq||(gq=[])).push(gv)}}}else{gv.from+=gm;if(gx){(gq||(gq=[])).push(gv)}}}}if(gq){gq=q(gq)}if(gy&&gy!=gq){gy=q(gy)}var gp=[gq];if(!gx){var gu=gt.text.length-2,gk;if(gu>0&&gq){for(var gn=0;gn<gq.length;++gn){if(gq[gn].to==null){(gk||(gk=[])).push(new ej(gq[gn].marker,null,null))}}}for(var gn=0;gn<gu;++gn){gp.push(gk)}gp.push(gy)}return gp}function q(gl){for(var gk=0;gk<gl.length;++gk){var gm=gl[gk];if(gm.from!=null&&gm.from==gm.to&&gm.marker.clearWhenEmpty!==false){gl.splice(gk--,1)}}if(!gl.length){return null}return gl}function ea(gs,gq){var gk=b4(gs,gq);var gt=el(gs,gq);if(!gk){return gt}if(!gt){return gk}for(var gn=0;gn<gk.length;++gn){var go=gk[gn],gp=gt[gn];if(go&&gp){spans:for(var gm=0;gm<gp.length;++gm){var gr=gp[gm];for(var gl=0;gl<go.length;++gl){if(go[gl].marker==gr.marker){continue spans}}go.push(gr)}}else{if(gp){gk[gn]=gp}}}return gk}function cH(gw,gu,gv){var go=null;gw.iter(gu.line,gv.line+1,function(gx){if(gx.markedSpans){for(var gy=0;gy<gx.markedSpans.length;++gy){var gz=gx.markedSpans[gy].marker;if(gz.readOnly&&(!go||di(go,gz)==-1)){(go||(go=[])).push(gz)}}}});if(!go){return null}var gp=[{from:gu,to:gv}];for(var gq=0;gq<go.length;++gq){var gr=go[gq],gm=gr.find(0);for(var gn=0;gn<gp.length;++gn){var gl=gp[gn];if(cf(gl.to,gm.from)<0||cf(gl.from,gm.to)>0){continue}var gt=[gn,1],gk=cf(gl.from,gm.from),gs=cf(gl.to,gm.to);if(gk<0||!gr.inclusiveLeft&&!gk){gt.push({from:gl.from,to:gm.from})}if(gs>0||!gr.inclusiveRight&&!gs){gt.push({from:gm.to,to:gl.to})}gp.splice.apply(gp,gt);gn+=gt.length-1}}return gp}function ga(gk){var gm=gk.markedSpans;if(!gm){return}for(var gl=0;gl<gm.length;++gl){gm[gl].marker.detachLine(gk)}gk.markedSpans=null}function c3(gk,gm){if(!gm){return}for(var gl=0;gl<gm.length;++gl){gm[gl].marker.attachLine(gk)}gk.markedSpans=gm}function v(gk){return gk.inclusiveLeft?-1:0}function bW(gk){return gk.inclusiveRight?1:0}function dR(gn,gl){var gp=gn.lines.length-gl.lines.length;if(gp!=0){return gp}var gm=gn.find(),gq=gl.find();var gk=cf(gm.from,gq.from)||v(gn)-v(gl);if(gk){return -gk}var go=cf(gm.to,gq.to)||bW(gn)-bW(gl);if(go){return go}return gl.id-gn.id}function a6(gl,gp){var gk=a7&&gl.markedSpans,go;if(gk){for(var gn,gm=0;gm<gk.length;++gm){gn=gk[gm];if(gn.marker.collapsed&&(gp?gn.from:gn.to)==null&&(!go||dR(go,gn.marker)<0)){go=gn.marker}}}return go}function eP(gk){return a6(gk,true)}function ex(gk){return a6(gk,false)}function z(gs,gm,gq,gr,go){var gv=fg(gs,gm);var gk=a7&&gv.markedSpans;if(gk){for(var gn=0;gn<gk.length;++gn){var gl=gk[gn];if(!gl.marker.collapsed){continue}var gu=gl.marker.find(0);var gt=cf(gu.from,gq)||v(gl.marker)-v(go);var gp=cf(gu.to,gr)||bW(gl.marker)-bW(go);if(gt>=0&&gp<=0||gt<=0&&gp>=0){continue}if(gt<=0&&(cf(gu.to,gq)>0||(gl.marker.inclusiveRight&&go.inclusiveLeft))||gt>=0&&(cf(gu.from,gr)<0||(gl.marker.inclusiveLeft&&go.inclusiveRight))){return true}}}}function x(gl){var gk;while(gk=eP(gl)){gl=gk.find(-1,true).line}return gl}function g(gm){var gk,gl;while(gk=ex(gm)){gm=gk.find(1,true).line;(gl||(gl=[])).push(gm)}return gl}function aW(gn,gl){var gk=fg(gn,gl),gm=x(gk);if(gk==gm){return gl}return bN(gm)}function d3(gn,gm){if(gm>gn.lastLine()){return gm}var gl=fg(gn,gm),gk;if(!fx(gn,gl)){return gm}while(gk=ex(gl)){gl=gk.find(1,true).line}return bN(gl)+1}function fx(go,gl){var gk=a7&&gl.markedSpans;if(gk){for(var gn,gm=0;gm<gk.length;++gm){gn=gk[gm];if(!gn.marker.collapsed){continue}if(gn.from==null){return true}if(gn.marker.widgetNode){continue}if(gn.from==0&&gn.marker.inclusiveLeft&&T(go,gl,gn)){return true}}}}function T(gp,gl,gn){if(gn.to==null){var gk=gn.marker.find(1,true);return T(gp,gk.line,fa(gk.line.markedSpans,gn.marker))}if(gn.marker.inclusiveRight&&gn.to==gl.text.length){return true}for(var go,gm=0;gm<gl.markedSpans.length;++gm){go=gl.markedSpans[gm];if(go.marker.collapsed&&!go.marker.widgetNode&&go.from==gn.to&&(go.to==null||go.to!=gn.from)&&(go.marker.inclusiveLeft||gn.marker.inclusiveRight)&&T(gp,gl,go)){return true}}}var dC=H.LineWidget=function(gn,gm,gk){if(gk){for(var gl in gk){if(gk.hasOwnProperty(gl)){this[gl]=gk[gl]}}}this.doc=gn;this.node=gm};by(dC);function d0(gk,gl,gm){if(bM(gl)<((gk.curOp&&gk.curOp.scrollTop)||gk.doc.scrollTop)){cL(gk,null,gm)}}dC.prototype.clear=function(){var gl=this.doc.cm,gn=this.line.widgets,gm=this.line,gp=bN(gm);if(gp==null||!gn){return}for(var go=0;go<gn.length;++go){if(gn[go]==this){gn.splice(go--,1)}}if(!gn.length){gm.widgets=null}var gk=cY(this);f7(gm,Math.max(0,gm.height-gk));if(gl){cM(gl,function(){d0(gl,gm,-gk);R(gl,gp,"widget")})}};dC.prototype.changed=function(){var gl=this.height,gk=this.doc.cm,gm=this.line;this.height=null;var gn=cY(this)-gl;if(!gn){return}f7(gm,gm.height+gn);if(gk){cM(gk,function(){gk.curOp.forceUpdate=true;d0(gk,gm,gn)})}};function cY(gm){if(gm.height!=null){return gm.height}var gk=gm.doc.cm;if(!gk){return 0}if(!gc(document.body,gm.node)){var gl="position: relative;";if(gm.coverGutter){gl+="margin-left: -"+gk.display.gutters.offsetWidth+"px;"}if(gm.noHScroll){gl+="width: "+gk.display.wrapper.clientWidth+"px;"}bR(gk.display.measure,f4("div",[gm.node],null,gl))}return gm.height=gm.node.offsetHeight}function bH(gp,go,gm,gl){var gn=new dC(gp,gm,gl);var gk=gp.cm;if(gk&&gn.noHScroll){gk.display.alignWidgets=true}eA(gp,go,"widget",function(gr){var gs=gr.widgets||(gr.widgets=[]);if(gn.insertAt==null){gs.push(gn)}else{gs.splice(Math.min(gs.length-1,Math.max(0,gn.insertAt)),0,gn)}gn.line=gr;if(gk&&!fx(gp,gr)){var gq=bM(gr)<gp.scrollTop;f7(gr,gr.height+cY(gn));if(gq){cL(gk,null,gn.height)}gk.curOp.forceUpdate=true}return true});return gn}var f8=H.Line=function(gm,gl,gk){this.text=gm;c3(this,gl);this.height=gk?gk(this):1};by(f8);f8.prototype.lineNo=function(){return bN(this)};function en(gl,go,gm,gk){gl.text=go;if(gl.stateAfter){gl.stateAfter=null}if(gl.styles){gl.styles=null}if(gl.order!=null){gl.order=null}ga(gl);c3(gl,gm);var gn=gk?gk(gl):1;if(gn!=gl.height){f7(gl,gn)}}function bB(gk){gk.parent=null;ga(gk)}function dj(gm,gl){if(gm){for(;;){var gk=gm.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!gk){break}gm=gm.slice(0,gk.index)+gm.slice(gk.index+gk[0].length);var gn=gk[1]?"bgClass":"textClass";if(gl[gn]==null){gl[gn]=gk[2]}else{if(!(new RegExp("(?:^|s)"+gk[2]+"(?:$|s)")).test(gl[gn])){gl[gn]+=" "+gk[2]}}}}return gm}function fr(gm,gl){if(gm.blankLine){return gm.blankLine(gl)}if(!gm.innerMode){return}var gk=H.innerMode(gm,gl);if(gk.mode.blankLine){return gk.mode.blankLine(gk.state)}}function eB(gp,go,gn,gk){for(var gl=0;gl<10;gl++){if(gk){gk[0]=H.innerMode(gp,gn).mode}var gm=gp.token(go,gn);if(go.pos>go.start){return gm}}throw new Error("Mode "+gp.name+" failed to advance stream.")}function cq(gt,gr,go,gn){function gk(gw){return{start:gu.start,end:gu.pos,string:gu.current(),type:gm||null,state:gw?b3(gs.mode,gl):gl}}var gs=gt.doc,gp=gs.mode,gm;gr=fK(gs,gr);var gv=fg(gs,gr.line),gl=dD(gt,gr.line,go);var gu=new eU(gv.text,gt.options.tabSize),gq;if(gn){gq=[]}while((gn||gu.pos<gr.ch)&&!gu.eol()){gu.start=gu.pos;gm=eB(gp,gu,gl);if(gn){gq.push(gk(true))}}return gn?gq:gk()}function w(gu,gw,gp,gl,gq,gn,go){var gm=gp.flattenSpans;if(gm==null){gm=gu.options.flattenSpans}var gs=0,gr=null;var gv=new eU(gw,gu.options.tabSize),gk;var gy=gu.options.addModeClass&&[null];if(gw==""){dj(fr(gp,gl),gn)}while(!gv.eol()){if(gv.pos>gu.options.maxHighlightLength){gm=false;if(go){dy(gu,gw,gl,gv.pos)}gv.pos=gw.length;gk=null}else{gk=dj(eB(gp,gv,gl,gy),gn)}if(gy){var gx=gy[0].name;if(gx){gk="m-"+(gk?gx+" "+gk:gx)}}if(!gm||gr!=gk){while(gs<gv.start){gs=Math.min(gv.start,gs+50000);gq(gs,gr)}gr=gk}gv.start=gv.pos}while(gs<gv.pos){var gt=Math.min(gv.pos,gs+50000);gq(gt,gr);gs=gt}}function fA(gr,gt,gk,go){var gs=[gr.state.modeGen],gn={};w(gr,gt.text,gr.doc.mode,gk,function(gu,gv){gs.push(gu,gv)},gn,go);for(var gl=0;gl<gr.state.overlays.length;++gl){var gp=gr.state.overlays[gl],gq=1,gm=0;w(gr,gt.text,gp.mode,true,function(gu,gw){var gy=gq;while(gm<gu){var gv=gs[gq];if(gv>gu){gs.splice(gq,1,gu,gs[gq+1],gv)}gq+=2;gm=Math.min(gu,gv)}if(!gw){return}if(gp.opaque){gs.splice(gy,gq-gy,gu,"cm-overlay "+gw);gq=gy+2}else{for(;gy<gq;gy+=2){var gx=gs[gy+1];gs[gy+1]=(gx?gx+" ":"")+"cm-overlay "+gw}}},gn)}return{styles:gs,classes:gn.bgClass||gn.textClass?gn:null}}function c6(gl,gm,go){if(!gm.styles||gm.styles[0]!=gl.state.modeGen){var gn=dD(gl,bN(gm));var gk=fA(gl,gm,gm.text.length>gl.options.maxHighlightLength?b3(gl.doc.mode,gn):gn);gm.stateAfter=gn;gm.styles=gk.styles;if(gk.classes){gm.styleClasses=gk.classes}else{if(gm.styleClasses){gm.styleClasses=null}}if(go===gl.doc.frontier){gl.doc.frontier++}}return gm.styles}function dy(gk,gp,gm,gl){var go=gk.doc.mode;var gn=new eU(gp,gk.options.tabSize);gn.start=gn.pos=gl||0;if(gp==""){fr(go,gm)}while(!gn.eol()){eB(go,gn,gm);gn.start=gn.pos}}var dX={},b1={};function eX(gm,gl){if(!gm||/^\s*$/.test(gm)){return null}var gk=gl.addModeClass?b1:dX;return gk[gm]||(gk[gm]=gm.replace(/\S+/g,"cm-$&"))}function eS(gl,gp){var gq=f4("span",null,null,c0?"padding-right: .1px":null);var gn={pre:f4("pre",[gq],"CodeMirror-line"),content:gq,col:0,pos:0,cm:gl,splitSpaces:(dL||c0)&&gl.getOption("lineWrapping")};gp.measure={};for(var go=0;go<=(gp.rest?gp.rest.length:0);go++){var gm=go?gp.rest[go-1]:gp.line,gk;gn.pos=0;gn.addToken=t;if(bO(gl.display.measure)&&(gk=a(gm))){gn.addToken=U(gn.addToken,gk)}gn.map=[];var gr=gp!=gl.display.externalMeasured&&bN(gm);bo(gm,gn,c6(gl,gm,gr));if(gm.styleClasses){if(gm.styleClasses.bgClass){gn.bgClass=fU(gm.styleClasses.bgClass,gn.bgClass||"")}if(gm.styleClasses.textClass){gn.textClass=fU(gm.styleClasses.textClass,gn.textClass||"")}}if(gn.map.length==0){gn.map.push(0,0,gn.content.appendChild(bn(gl.display.measure)))}if(go==0){gp.measure.map=gn.map;gp.measure.cache={}}else{(gp.measure.maps||(gp.measure.maps=[])).push(gn.map);(gp.measure.caches||(gp.measure.caches=[])).push({})}}if(c0&&/\bcm-tab\b/.test(gn.content.lastChild.className)){gn.content.className="cm-tab-wrap-hack"}aE(gl,"renderLine",gl,gp.line,gn.pre);if(gn.pre.className){gn.textClass=fU(gn.pre.className,gn.textClass||"")}return gn}function fd(gl){var gk=f4("span","\u2022","cm-invalidchar");gk.title="\\u"+gl.charCodeAt(0).toString(16);gk.setAttribute("aria-label",gk.title);return gk}function t(gv,gq,gA,gx,gt,gC,gp){if(!gq){return}var gz=gv.splitSpaces?gq.replace(/ {3,}/g,cF):gq;var gk=gv.cm.state.specialChars,gl=false;if(!gk.test(gq)){gv.col+=gq.length;var gy=document.createTextNode(gz);gv.map.push(gv.pos,gv.pos+gq.length,gy);if(dL&&k<9){gl=true}gv.pos+=gq.length}else{var gy=document.createDocumentFragment(),gn=0;while(true){gk.lastIndex=gn;var gw=gk.exec(gq);var gB=gw?gw.index-gn:gq.length-gn;if(gB){var gs=document.createTextNode(gz.slice(gn,gn+gB));if(dL&&k<9){gy.appendChild(f4("span",[gs]))}else{gy.appendChild(gs)}gv.map.push(gv.pos,gv.pos+gB,gs);gv.col+=gB;gv.pos+=gB}if(!gw){break}gn+=gB+1;if(gw[0]=="\t"){var gu=gv.cm.options.tabSize,gr=gu-gv.col%gu;var gs=gy.appendChild(f4("span",cp(gr),"cm-tab"));gs.setAttribute("role","presentation");gs.setAttribute("cm-text","\t");gv.col+=gr}else{if(gw[0]=="\r"||gw[0]=="\n"){var gs=gy.appendChild(f4("span",gw[0]=="\r"?"\u240d":"\u2424","cm-invalidchar"));gs.setAttribute("cm-text",gw[0]);gv.col+=1}else{var gs=gv.cm.options.specialCharPlaceholder(gw[0]);gs.setAttribute("cm-text",gw[0]);if(dL&&k<9){gy.appendChild(f4("span",[gs]))}else{gy.appendChild(gs)}gv.col+=1}}gv.map.push(gv.pos,gv.pos+1,gs);gv.pos++}}if(gA||gx||gt||gl||gp){var gm=gA||"";if(gx){gm+=gx}if(gt){gm+=gt}var go=f4("span",[gy],gm,gp);if(gC){go.title=gC}return gv.content.appendChild(go)}gv.content.appendChild(gy)}function cF(gk){var gl=" ";for(var gm=0;gm<gk.length-2;++gm){gl+=gm%2?" ":"\u00a0"}gl+=" ";return gl}function U(gl,gk){return function(gt,gv,gm,gq,gw,gu,gs){gm=gm?gm+" cm-force-border":"cm-force-border";var gn=gt.pos,gp=gn+gv.length;for(;;){for(var gr=0;gr<gk.length;gr++){var go=gk[gr];if(go.to>gn&&go.from<=gn){break}}if(go.to>=gp){return gl(gt,gv,gm,gq,gw,gu,gs)}gl(gt,gv.slice(0,go.to-gn),gm,gq,null,gu,gs);gq=null;gv=gv.slice(go.to-gn);gn=go.to}}}function ac(gl,gn,gk,gm){var go=!gm&&gk.widgetNode;if(go){gl.map.push(gl.pos,gl.pos+gn,go)}if(!gm&&gl.cm.display.input.needsContentAttribute){if(!go){go=gl.content.appendChild(document.createElement("span"))}go.setAttribute("cm-marker",gk.id)}if(go){gl.cm.display.input.setUneditable(go);gl.content.appendChild(go)}gl.pos+=gn}function bo(gt,gA,gs){var gp=gt.markedSpans,gr=gt.text,gy=0;if(!gp){for(var gD=1;gD<gs.length;gD+=2){gA.addToken(gA,gr.slice(gy,gy=gs[gD]),eX(gs[gD+1],gA.cm.options))}return}var gE=gr.length,go=0,gD=1,gw="",gF,gu;var gH=0,gk,gG,gx,gI,gm;for(;;){if(gH==go){gk=gG=gx=gI=gu="";gm=null;gH=Infinity;var gq=[];for(var gB=0;gB<gp.length;++gB){var gC=gp[gB],gz=gC.marker;if(gz.type=="bookmark"&&gC.from==go&&gz.widgetNode){gq.push(gz)}else{if(gC.from<=go&&(gC.to==null||gC.to>go||gz.collapsed&&gC.to==go&&gC.from==go)){if(gC.to!=null&&gC.to!=go&&gH>gC.to){gH=gC.to;gG=""}if(gz.className){gk+=" "+gz.className}if(gz.css){gu=gz.css}if(gz.startStyle&&gC.from==go){gx+=" "+gz.startStyle}if(gz.endStyle&&gC.to==gH){gG+=" "+gz.endStyle}if(gz.title&&!gI){gI=gz.title}if(gz.collapsed&&(!gm||dR(gm.marker,gz)<0)){gm=gC}}else{if(gC.from>go&&gH>gC.from){gH=gC.from}}}}if(gm&&(gm.from||0)==go){ac(gA,(gm.to==null?gE+1:gm.to)-go,gm.marker,gm.from==null);if(gm.to==null){return}if(gm.to==go){gm=false}}if(!gm&&gq.length){for(var gB=0;gB<gq.length;++gB){ac(gA,0,gq[gB])}}}if(go>=gE){break}var gv=Math.min(gE,gH);while(true){if(gw){var gl=go+gw.length;if(!gm){var gn=gl>gv?gw.slice(0,gv-go):gw;gA.addToken(gA,gn,gF?gF+gk:gk,gx,go+gn.length==gH?gG:"",gI,gu)}if(gl>=gv){gw=gw.slice(gv-go);go=gv;break}go=gl;gx=""}gw=gr.slice(gy,gy=gs[gD++]);gF=eX(gs[gD++],gA.cm.options)}}}function dT(gk,gl){return gl.from.ch==0&&gl.to.ch==0&&fH(gl.text)==""&&(!gk.cm||gk.cm.options.wholeLineUpdateBefore)}function fz(gx,gs,gl,go){function gy(gA){return gl?gl[gA]:null}function gm(gA,gC,gB){en(gA,gC,gB,go);ae(gA,"change",gA,gs)}function gk(gD,gB){for(var gC=gD,gA=[];gC<gB;++gC){gA.push(new f8(gz[gC],gy(gC),go))}return gA}var gw=gs.from,gv=gs.to,gz=gs.text;var gt=fg(gx,gw.line),gu=fg(gx,gv.line);var gr=fH(gz),gn=gy(gz.length-1),gq=gv.line-gw.line;if(gs.full){gx.insert(0,gk(0,gz.length));gx.remove(gz.length,gx.size-gz.length)}else{if(dT(gx,gs)){var gp=gk(0,gz.length-1);gm(gu,gu.text,gn);if(gq){gx.remove(gw.line,gq)}if(gp.length){gx.insert(gw.line,gp)}}else{if(gt==gu){if(gz.length==1){gm(gt,gt.text.slice(0,gw.ch)+gr+gt.text.slice(gv.ch),gn)}else{var gp=gk(1,gz.length-1);gp.push(new f8(gr+gt.text.slice(gv.ch),gn,go));gm(gt,gt.text.slice(0,gw.ch)+gz[0],gy(0));gx.insert(gw.line+1,gp)}}else{if(gz.length==1){gm(gt,gt.text.slice(0,gw.ch)+gz[0]+gu.text.slice(gv.ch),gy(0));gx.remove(gw.line+1,gq)}else{gm(gt,gt.text.slice(0,gw.ch)+gz[0],gy(0));gm(gu,gr+gu.text.slice(gv.ch),gn);var gp=gk(1,gz.length-1);if(gq>1){gx.remove(gw.line+1,gq-1)}gx.insert(gw.line+1,gp)}}}}ae(gx,"change",gx,gs)}function e0(gl){this.lines=gl;this.parent=null;for(var gm=0,gk=0;gm<gl.length;++gm){gl[gm].parent=this;gk+=gl[gm].height}this.height=gk}e0.prototype={chunkSize:function(){return this.lines.length},removeInner:function(gk,go){for(var gm=gk,gn=gk+go;gm<gn;++gm){var gl=this.lines[gm];this.height-=gl.height;bB(gl);ae(gl,"delete")}this.lines.splice(gk,go)},collapse:function(gk){gk.push.apply(gk,this.lines)},insertInner:function(gl,gm,gk){this.height+=gk;this.lines=this.lines.slice(0,gl).concat(gm).concat(this.lines.slice(gl));for(var gn=0;gn<gm.length;++gn){gm[gn].parent=this}},iterN:function(gk,gn,gm){for(var gl=gk+gn;gk<gl;++gk){if(gm(this.lines[gk])){return true}}}};function fy(gn){this.children=gn;var gm=0,gk=0;for(var gl=0;gl<gn.length;++gl){var go=gn[gl];gm+=go.chunkSize();gk+=go.height;go.parent=this}this.size=gm;this.height=gk;this.parent=null}fy.prototype={chunkSize:function(){return this.size},removeInner:function(gk,gr){this.size-=gr;for(var gm=0;gm<this.children.length;++gm){var gq=this.children[gm],go=gq.chunkSize();if(gk<go){var gn=Math.min(gr,go-gk),gp=gq.height;gq.removeInner(gk,gn);this.height-=gp-gq.height;if(go==gn){this.children.splice(gm--,1);gq.parent=null}if((gr-=gn)==0){break}gk=0}else{gk-=go}}if(this.size-gr<25&&(this.children.length>1||!(this.children[0] instanceof e0))){var gl=[];this.collapse(gl);this.children=[new e0(gl)];this.children[0].parent=this}},collapse:function(gk){for(var gl=0;gl<this.children.length;++gl){this.children[gl].collapse(gk)}},insertInner:function(gl,gm,gk){this.size+=gm.length;this.height+=gk;for(var gp=0;gp<this.children.length;++gp){var gr=this.children[gp],gq=gr.chunkSize();if(gl<=gq){gr.insertInner(gl,gm,gk);if(gr.lines&&gr.lines.length>50){while(gr.lines.length>50){var go=gr.lines.splice(gr.lines.length-25,25);var gn=new e0(go);gr.height-=gn.height;this.children.splice(gp+1,0,gn);gn.parent=this}this.maybeSpill()}break}gl-=gq}},maybeSpill:function(){if(this.children.length<=10){return}var gn=this;do{var gl=gn.children.splice(gn.children.length-5,5);var gm=new fy(gl);if(!gn.parent){var go=new fy(gn.children);go.parent=gn;gn.children=[go,gm];gn=go}else{gn.size-=gm.size;gn.height-=gm.height;var gk=di(gn.parent.children,gn);gn.parent.children.splice(gk+1,0,gm)}gm.parent=gn.parent}while(gn.children.length>10);gn.parent.maybeSpill()},iterN:function(gk,gq,gp){for(var gl=0;gl<this.children.length;++gl){var go=this.children[gl],gn=go.chunkSize();if(gk<gn){var gm=Math.min(gq,gn-gk);if(go.iterN(gk,gm,gp)){return true}if((gq-=gm)==0){break}gk=0}else{gk-=gn}}}};var cr=0;var at=H.Doc=function(gn,gm,gk,gl){if(!(this instanceof at)){return new at(gn,gm,gk,gl)}if(gk==null){gk=0}fy.call(this,[new e0([new f8("",null)])]);this.first=gk;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=gk;var go=W(gk,0);this.sel=eT(go);this.history=new fV(null);this.id=++cr;this.modeOption=gm;this.lineSep=gl;if(typeof gn=="string"){gn=this.splitLines(gn)}fz(this,{from:go,to:go,text:gn});bU(this,eT(go),Z)};at.prototype=ck(fy.prototype,{constructor:at,iter:function(gm,gl,gk){if(gk){this.iterN(gm-this.first,gl-gm,gk)}else{this.iterN(this.first,this.first+this.size,gm)}},insert:function(gl,gm){var gk=0;for(var gn=0;gn<gm.length;++gn){gk+=gm[gn].height}this.insertInner(gl-this.first,gm,gk)},remove:function(gk,gl){this.removeInner(gk-this.first,gl)},getValue:function(gl){var gk=a2(this,this.first,this.first+this.size);if(gl===false){return gk}return gk.join(gl||this.lineSeparator())},setValue:cD(function(gl){var gm=W(this.first,0),gk=this.first+this.size-1;bg(this,{from:gm,to:W(gk,fg(this,gk).text.length),text:this.splitLines(gl),origin:"setValue",full:true},true);bU(this,eT(gm))}),replaceRange:function(gl,gn,gm,gk){gn=fK(this,gn);gm=gm?fK(this,gm):gn;a1(this,gl,gn,gm,gk)},getRange:function(gn,gm,gl){var gk=f6(this,fK(this,gn),fK(this,gm));if(gl===false){return gk}return gk.join(gl||this.lineSeparator())},getLine:function(gl){var gk=this.getLineHandle(gl);return gk&&gk.text},getLineHandle:function(gk){if(b9(this,gk)){return fg(this,gk)}},getLineNumber:function(gk){return bN(gk)},getLineHandleVisualStart:function(gk){if(typeof gk=="number"){gk=fg(this,gk)}return x(gk)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(gk){return fK(this,gk)},getCursor:function(gm){var gk=this.sel.primary(),gl;if(gm==null||gm=="head"){gl=gk.head}else{if(gm=="anchor"){gl=gk.anchor}else{if(gm=="end"||gm=="to"||gm===false){gl=gk.to()}else{gl=gk.from()}}}return gl},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cD(function(gk,gm,gl){F(this,fK(this,typeof gk=="number"?W(gk,gm||0):gk),null,gl)}),setSelection:cD(function(gl,gm,gk){F(this,fK(this,gl),fK(this,gm||gl),gk)}),extendSelection:cD(function(gm,gk,gl){fY(this,fK(this,gm),gk&&fK(this,gk),gl)}),extendSelections:cD(function(gl,gk){aw(this,d1(this,gl,gk))}),extendSelectionsBy:cD(function(gl,gk){aw(this,bS(this.sel.ranges,gl),gk)}),setSelections:cD(function(gk,go,gm){if(!gk.length){return}for(var gn=0,gl=[];gn<gk.length;gn++){gl[gn]=new dZ(fK(this,gk[gn].anchor),fK(this,gk[gn].head))}if(go==null){go=Math.min(gk.length-1,this.sel.primIndex)}bU(this,cw(gl,go),gm)}),addSelection:cD(function(gm,gn,gl){var gk=this.sel.ranges.slice(0);gk.push(new dZ(fK(this,gm),fK(this,gn||gm)));bU(this,cw(gk,gk.length-1),gl)}),getSelection:function(go){var gl=this.sel.ranges,gk;for(var gm=0;gm<gl.length;gm++){var gn=f6(this,gl[gm].from(),gl[gm].to());gk=gk?gk.concat(gn):gn}if(go===false){return gk}else{return gk.join(go||this.lineSeparator())}},getSelections:function(go){var gn=[],gk=this.sel.ranges;for(var gl=0;gl<gk.length;gl++){var gm=f6(this,gk[gl].from(),gk[gl].to());if(go!==false){gm=gm.join(go||this.lineSeparator())}gn[gl]=gm}return gn},replaceSelection:function(gm,go,gk){var gn=[];for(var gl=0;gl<this.sel.ranges.length;gl++){gn[gl]=gm}this.replaceSelections(gn,go,gk||"+input")},replaceSelections:cD(function(gp,gr,gm){var go=[],gq=this.sel;for(var gn=0;gn<gq.ranges.length;gn++){var gl=gq.ranges[gn];go[gn]={from:gl.from(),to:gl.to(),text:this.splitLines(gp[gn]),origin:gm}}var gk=gr&&gr!="end"&&af(this,go,gr);for(var gn=go.length-1;gn>=0;gn--){bg(this,go[gn])}if(gk){e8(this,gk)}else{if(this.cm){fG(this.cm)}}}),undo:cD(function(){b8(this,"undo")}),redo:cD(function(){b8(this,"redo")}),undoSelection:cD(function(){b8(this,"undo",true)}),redoSelection:cD(function(){b8(this,"redo",true)}),setExtending:function(gk){this.extend=gk},getExtending:function(){return this.extend},historySize:function(){var gn=this.history,gk=0,gm=0;for(var gl=0;gl<gn.done.length;gl++){if(!gn.done[gl].ranges){++gk}}for(var gl=0;gl<gn.undone.length;gl++){if(!gn.undone[gl].ranges){++gm}}return{undo:gk,redo:gm}},clearHistory:function(){this.history=new fV(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(gk){if(gk){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gk){return this.history.generation==(gk||this.cleanGeneration)},getHistory:function(){return{done:bP(this.history.done),undone:bP(this.history.undone)}},setHistory:function(gl){var gk=this.history=new fV(this.history.maxGeneration);gk.done=bP(gl.done.slice(0),null,true);gk.undone=bP(gl.undone.slice(0),null,true)},addLineClass:cD(function(gm,gl,gk){return eA(this,gm,gl=="gutter"?"gutter":"class",function(gn){var go=gl=="text"?"textClass":gl=="background"?"bgClass":gl=="gutter"?"gutterClass":"wrapClass";if(!gn[go]){gn[go]=gk}else{if(S(gk).test(gn[go])){return false}else{gn[go]+=" "+gk}}return true})}),removeLineClass:cD(function(gm,gl,gk){return eA(this,gm,gl=="gutter"?"gutter":"class",function(go){var gr=gl=="text"?"textClass":gl=="background"?"bgClass":gl=="gutter"?"gutterClass":"wrapClass";var gq=go[gr];if(!gq){return false}else{if(gk==null){go[gr]=null}else{var gp=gq.match(S(gk));if(!gp){return false}var gn=gp.index+gp[0].length;go[gr]=gq.slice(0,gp.index)+(!gp.index||gn==gq.length?"":" ")+gq.slice(gn)||null}}return true})}),addLineWidget:cD(function(gm,gl,gk){return bH(this,gm,gl,gk)}),removeLineWidget:function(gk){gk.clear()},markText:function(gm,gl,gk){return eG(this,fK(this,gm),fK(this,gl),gk,"range")},setBookmark:function(gm,gk){var gl={replacedWith:gk&&(gk.nodeType==null?gk.widget:gk),insertLeft:gk&&gk.insertLeft,clearWhenEmpty:false,shared:gk&&gk.shared,handleMouseEvents:gk&&gk.handleMouseEvents};gm=fK(this,gm);return eG(this,gm,gm,gl,"bookmark")},findMarksAt:function(go){go=fK(this,go);var gn=[],gl=fg(this,go.line).markedSpans;if(gl){for(var gk=0;gk<gl.length;++gk){var gm=gl[gk];if((gm.from==null||gm.from<=go.ch)&&(gm.to==null||gm.to>=go.ch)){gn.push(gm.marker.parent||gm.marker)}}}return gn},findMarks:function(go,gn,gk){go=fK(this,go);gn=fK(this,gn);var gl=[],gm=go.line;this.iter(go.line,gn.line+1,function(gp){var gr=gp.markedSpans;if(gr){for(var gq=0;gq<gr.length;gq++){var gs=gr[gq];if(!(gm==go.line&&go.ch>gs.to||gs.from==null&&gm!=go.line||gm==gn.line&&gs.from>gn.ch)&&(!gk||gk(gs.marker))){gl.push(gs.marker.parent||gs.marker)}}}++gm});return gl},getAllMarks:function(){var gk=[];this.iter(function(gm){var gl=gm.markedSpans;if(gl){for(var gn=0;gn<gl.length;++gn){if(gl[gn].from!=null){gk.push(gl[gn].marker)}}}});return gk},posFromIndex:function(gl){var gk,gm=this.first;this.iter(function(gn){var go=gn.text.length+1;if(go>gl){gk=gl;return true}gl-=go;++gm});return fK(this,W(gm,gk))},indexFromPos:function(gl){gl=fK(this,gl);var gk=gl.ch;if(gl.line<this.first||gl.ch<0){return 0}this.iter(this.first,gl.line,function(gm){gk+=gm.text.length+1});return gk},copy:function(gk){var gl=new at(a2(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);gl.scrollTop=this.scrollTop;gl.scrollLeft=this.scrollLeft;gl.sel=this.sel;gl.extend=false;if(gk){gl.history.undoDepth=this.history.undoDepth;gl.setHistory(this.getHistory())}return gl},linkedDoc:function(gk){if(!gk){gk={}}var gn=this.first,gm=this.first+this.size;if(gk.from!=null&&gk.from>gn){gn=gk.from}if(gk.to!=null&&gk.to<gm){gm=gk.to}var gl=new at(a2(this,gn,gm),gk.mode||this.modeOption,gn,this.lineSep);if(gk.sharedHist){gl.history=this.history}(this.linked||(this.linked=[])).push({doc:gl,sharedHist:gk.sharedHist});gl.linked=[{doc:this,isParent:true,sharedHist:gk.sharedHist}];dG(gl,eQ(this));return gl},unlinkDoc:function(gl){if(gl instanceof H){gl=gl.doc}if(this.linked){for(var gm=0;gm<this.linked.length;++gm){var gn=this.linked[gm];if(gn.doc!=gl){continue}this.linked.splice(gm,1);gl.unlinkDoc(this);ep(eQ(this));break}}if(gl.history==this.history){var gk=[gl.id];d8(gl,function(go){gk.push(go.id)},true);gl.history=new fV(null);gl.history.done=bP(this.history.done,gk);gl.history.undone=bP(this.history.undone,gk)}},iterLinkedDocs:function(gk){d8(this,gk)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(gk){if(this.lineSep){return gk.split(this.lineSep)}return fT(gk)},lineSeparator:function(){return this.lineSep||"\n"}});at.prototype.eachLine=at.prototype.iter;var d="iter insert remove copy getEditor constructor".split(" ");for(var bK in at.prototype){if(at.prototype.hasOwnProperty(bK)&&di(d,bK)<0){H.prototype[bK]=(function(gk){return function(){return gk.apply(this.doc,arguments)}})(at.prototype[bK])}}by(at);function d8(gn,gm,gl){function gk(gt,gr,gp){if(gt.linked){for(var gq=0;gq<gt.linked.length;++gq){var go=gt.linked[gq];if(go.doc==gr){continue}var gs=gp&&go.sharedHist;if(gl&&!gs){continue}gm(go.doc,gs);gk(go.doc,gt,gs)}}}gk(gn,null,true)}function ec(gk,gl){if(gl.cm){throw new Error("This document is already in use.")}gk.doc=gl;gl.cm=gk;X(gk);br(gk);if(!gk.options.lineWrapping){h(gk)}gk.options.mode=gl.modeOption;ah(gk)}function fg(gn,gp){gp-=gn.first;if(gp<0||gp>=gn.size){throw new Error("There is no line "+(gp+gn.first)+" in the document.")}for(var gk=gn;!gk.lines;){for(var gl=0;;++gl){var go=gk.children[gl],gm=go.chunkSize();if(gp<gm){gk=go;break}gp-=gm}}return gk.lines[gp]}function f6(gm,go,gk){var gl=[],gn=go.line;gm.iter(go.line,gk.line+1,function(gp){var gq=gp.text;if(gn==gk.line){gq=gq.slice(0,gk.ch)}if(gn==go.line){gq=gq.slice(go.ch)}gl.push(gq);++gn});return gl}function a2(gl,gn,gm){var gk=[];gl.iter(gn,gm,function(go){gk.push(go.text)});return gk}function f7(gl,gk){var gm=gk-gl.height;if(gm){for(var gn=gl;gn;gn=gn.parent){gn.height+=gm}}}function bN(gk){if(gk.parent==null){return null}var go=gk.parent,gn=di(go.lines,gk);for(var gl=go.parent;gl;go=gl,gl=gl.parent){for(var gm=0;;++gm){if(gl.children[gm]==go){break}gn+=gl.children[gm].chunkSize()}}return gn+go.first}function bG(gm,gp){var gr=gm.first;outer:do{for(var gn=0;gn<gm.children.length;++gn){var gq=gm.children[gn],go=gq.height;if(gp<go){gm=gq;continue outer}gp-=go;gr+=gq.chunkSize()}return gr}while(!gm.lines);for(var gn=0;gn<gm.lines.length;++gn){var gl=gm.lines[gn],gk=gl.height;if(gp<gk){break}gp-=gk}return gr+gn}function bM(gm){gm=x(gm);var go=0,gl=gm.parent;for(var gn=0;gn<gl.lines.length;++gn){var gk=gl.lines[gn];if(gk==gm){break}else{go+=gk.height}}for(var gp=gl.parent;gp;gl=gp,gp=gl.parent){for(var gn=0;gn<gp.children.length;++gn){var gq=gp.children[gn];if(gq==gl){break}else{go+=gq.height}}}return go}function a(gl){var gk=gl.order;if(gk==null){gk=gl.order=bh(gl.text)}return gk}function fV(gk){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=gk||1}function dv(gk,gm){var gl={from:ci(gm.from),to:cX(gm),text:f6(gk,gm.from,gm.to)};bY(gk,gl,gm.from.line,gm.to.line+1);d8(gk,function(gn){bY(gn,gl,gm.from.line,gm.to.line+1)},true);return gl}function fC(gl){while(gl.length){var gk=fH(gl);if(gk.ranges){gl.pop()}else{break}}}function eN(gl,gk){if(gk){fC(gl.done);return fH(gl.done)}else{if(gl.done.length&&!fH(gl.done).ranges){return fH(gl.done)}else{if(gl.done.length>1&&!gl.done[gl.done.length-2].ranges){gl.done.pop();return fH(gl.done)}}}}function fN(gq,go,gk,gn){var gm=gq.history;gm.undone.length=0;var gl=+new Date,gr;if((gm.lastOp==gn||gm.lastOrigin==go.origin&&go.origin&&((go.origin.charAt(0)=="+"&&gq.cm&&gm.lastModTime>gl-gq.cm.options.historyEventDelay)||go.origin.charAt(0)=="*"))&&(gr=eN(gm,gm.lastOp==gn))){var gs=fH(gr.changes);if(cf(go.from,go.to)==0&&cf(go.from,gs.to)==0){gs.to=cX(go)}else{gr.changes.push(dv(gq,go))}}else{var gp=fH(gm.done);if(!gp||!gp.ranges){cN(gq.sel,gm.done)}gr={changes:[dv(gq,go)],generation:gm.generation};gm.done.push(gr);while(gm.done.length>gm.undoDepth){gm.done.shift();if(!gm.done[0].ranges){gm.done.shift()}}}gm.done.push(gk);gm.generation=++gm.maxGeneration;gm.lastModTime=gm.lastSelTime=gl;gm.lastOp=gm.lastSelOp=gn;gm.lastOrigin=gm.lastSelOrigin=go.origin;if(!gs){aE(gq,"historyAdded")}}function bA(go,gk,gm,gn){var gl=gk.charAt(0);return gl=="*"||gl=="+"&&gm.ranges.length==gn.ranges.length&&gm.somethingSelected()==gn.somethingSelected()&&new Date-go.history.lastSelTime<=(go.cm?go.cm.options.historyEventDelay:500)}function gd(gp,gn,gk,gm){var go=gp.history,gl=gm&&gm.origin;if(gk==go.lastSelOp||(gl&&go.lastSelOrigin==gl&&(go.lastModTime==go.lastSelTime&&go.lastOrigin==gl||bA(gp,gl,fH(go.done),gn)))){go.done[go.done.length-1]=gn}else{cN(gn,go.done)}go.lastSelTime=+new Date;go.lastSelOrigin=gl;go.lastSelOp=gk;if(gm&&gm.clearRedo!==false){fC(go.undone)}}function cN(gl,gk){var gm=fH(gk);if(!(gm&&gm.ranges&&gm.equals(gl))){gk.push(gl)}}function bY(gl,gp,go,gn){var gk=gp["spans_"+gl.id],gm=0;gl.iter(Math.max(gl.first,go),Math.min(gl.first+gl.size,gn),function(gq){if(gq.markedSpans){(gk||(gk=gp["spans_"+gl.id]={}))[gm]=gq.markedSpans}++gm})}function bl(gm){if(!gm){return null}for(var gl=0,gk;gl<gm.length;++gl){if(gm[gl].marker.explicitlyCleared){if(!gk){gk=gm.slice(0,gl)}}else{if(gk){gk.push(gm[gl])}}}return !gk?gm:gk.length?gk:null}function b4(gn,go){var gm=go["spans_"+gn.id];if(!gm){return null}for(var gl=0,gk=[];gl<go.text.length;++gl){gk.push(bl(gm[gl]))}return gk}function bP(gv,gn,gu){for(var gq=0,gl=[];gq<gv.length;++gq){var gm=gv[gq];if(gm.ranges){gl.push(gu?f5.prototype.deepCopy.call(gm):gm);continue}var gs=gm.changes,gt=[];gl.push({changes:gt});for(var gp=0;gp<gs.length;++gp){var gr=gs[gp],go;gt.push({from:gr.from,to:gr.to,text:gr.text});if(gn){for(var gk in gr){if(go=gk.match(/^spans_(\d+)$/)){if(di(gn,Number(go[1]))>-1){fH(gt)[gk]=gr[gk];delete gr[gk]}}}}}}return gl}function I(gn,gm,gl,gk){if(gl<gn.line){gn.line+=gk}else{if(gm<gn.line){gn.line=gm;gn.ch=0}}}function fi(gn,gp,gq,gr){for(var gm=0;gm<gn.length;++gm){var gk=gn[gm],go=true;if(gk.ranges){if(!gk.copied){gk=gn[gm]=gk.deepCopy();gk.copied=true}for(var gl=0;gl<gk.ranges.length;gl++){I(gk.ranges[gl].anchor,gp,gq,gr);I(gk.ranges[gl].head,gp,gq,gr)}continue}for(var gl=0;gl<gk.changes.length;++gl){var gs=gk.changes[gl];if(gq<gs.from.line){gs.from=W(gs.from.line+gr,gs.from.ch);gs.to=W(gs.to.line+gr,gs.to.ch)}else{if(gp<=gs.to.line){go=false;break}}}if(!go){gn.splice(0,gm+1);gm=0}}}function dF(gl,go){var gn=go.from.line,gm=go.to.line,gk=go.text.length-(gm-gn)-1;fi(gl.done,gn,gm,gk);fi(gl.undone,gn,gm,gk)}var cG=H.e_preventDefault=function(gk){if(gk.preventDefault){gk.preventDefault()}else{gk.returnValue=false}};var dr=H.e_stopPropagation=function(gk){if(gk.stopPropagation){gk.stopPropagation()}else{gk.cancelBubble=true}};function bL(gk){return gk.defaultPrevented!=null?gk.defaultPrevented:gk.returnValue==false}var es=H.e_stop=function(gk){cG(gk);dr(gk)};function L(gk){return gk.target||gk.srcElement}function fO(gl){var gk=gl.which;if(gk==null){if(gl.button&1){gk=1}else{if(gl.button&2){gk=3}else{if(gl.button&4){gk=2}}}}if(b7&&gl.ctrlKey&&gk==1){gk=3}return gk}var bX=H.on=function(gn,gl,gm){if(gn.addEventListener){gn.addEventListener(gl,gm,false)}else{if(gn.attachEvent){gn.attachEvent("on"+gl,gm)}else{var go=gn._handlers||(gn._handlers={});var gk=go[gl]||(go[gl]=[]);gk.push(gm)}}};var ee=H.off=function(go,gm,gn){if(go.removeEventListener){go.removeEventListener(gm,gn,false)}else{if(go.detachEvent){go.detachEvent("on"+gm,gn)}else{var gk=go._handlers&&go._handlers[gm];if(!gk){return}for(var gl=0;gl<gk.length;++gl){if(gk[gl]==gn){gk.splice(gl,1);break}}}}};var aE=H.signal=function(go,gn){var gk=go._handlers&&go._handlers[gn];if(!gk){return}var gl=Array.prototype.slice.call(arguments,2);for(var gm=0;gm<gk.length;++gm){gk[gm].apply(null,gl)}};var bz=null;function ae(gq,go){var gk=gq._handlers&&gq._handlers[go];if(!gk){return}var gm=Array.prototype.slice.call(arguments,2),gp;if(bp){gp=bp.delayedCallbacks}else{if(bz){gp=bz}else{gp=bz=[];setTimeout(aM,0)}}function gl(gr){return function(){gr.apply(null,gm)}}for(var gn=0;gn<gk.length;++gn){gp.push(gl(gk[gn]))}}function aM(){var gk=bz;bz=null;for(var gl=0;gl<gk.length;++gl){gk[gl]()}}function aR(gk,gm,gl){if(typeof gm=="string"){gm={type:gm,preventDefault:function(){this.defaultPrevented=true}}}aE(gk,gl||gm.type,gk,gm);return bL(gm)||gm.codemirrorIgnore}function V(gl){var gk=gl._handlers&&gl._handlers.cursorActivity;if(!gk){return}var gn=gl.curOp.cursorActivityHandlers||(gl.curOp.cursorActivityHandlers=[]);for(var gm=0;gm<gk.length;++gm){if(di(gn,gk[gm])==-1){gn.push(gk[gm])}}}function fj(gm,gl){var gk=gm._handlers&&gm._handlers[gl];return gk&&gk.length>0}function by(gk){gk.prototype.on=function(gl,gm){bX(this,gl,gm)};gk.prototype.off=function(gl,gm){ee(this,gl,gm)}}var dK=30;var ca=H.Pass={toString:function(){return"CodeMirror.Pass"}};var Z={scroll:false},M={origin:"*mouse"},cW={origin:"+move"};function gj(){this.id=null}gj.prototype.set=function(gk,gl){clearTimeout(this.id);this.id=setTimeout(gl,gk)};var bT=H.countColumn=function(gn,gl,gp,gq,gm){if(gl==null){gl=gn.search(/[^\s\u00a0]/);if(gl==-1){gl=gn.length}}for(var go=gq||0,gr=gm||0;;){var gk=gn.indexOf("\t",go);if(gk<0||gk>=gl){return gr+(gl-go)}gr+=gk-go;gr+=gp-(gr%gp);go=gk+1}};var er=H.findColumn=function(go,gn,gp){for(var gq=0,gm=0;;){var gl=go.indexOf("\t",gq);if(gl==-1){gl=go.length}var gk=gl-gq;if(gl==go.length||gm+gk>=gn){return gq+Math.min(gk,gn-gm)}gm+=gl-gq;gm+=gp-(gm%gp);gq=gl+1;if(gm>=gn){return gq}}};var a0=[""];function cp(gk){while(a0.length<=gk){a0.push(fH(a0)+" ")}return a0[gk]}function fH(gk){return gk[gk.length-1]}var dM=function(gk){gk.select()};if(e2){dM=function(gk){gk.selectionStart=0;gk.selectionEnd=gk.value.length}}else{if(dL){dM=function(gl){try{gl.select()}catch(gk){}}}}function di(gm,gk){for(var gl=0;gl<gm.length;++gl){if(gm[gl]==gk){return gl}}return -1}function bS(gn,gm){var gk=[];for(var gl=0;gl<gn.length;gl++){gk[gl]=gm(gn[gl],gl)}return gk}function fW(){}function ck(gm,gk){var gl;if(Object.create){gl=Object.create(gm)}else{fW.prototype=gm;gl=new fW()}if(gk){aN(gk,gl)}return gl}function aN(gm,gl,gk){if(!gl){gl={}}for(var gn in gm){if(gm.hasOwnProperty(gn)&&(gk!==false||!gl.hasOwnProperty(gn))){gl[gn]=gm[gn]}}return gl}function cv(gl){var gk=Array.prototype.slice.call(arguments,1);return function(){return gl.apply(null,gk)}}var bc=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fE=H.isWordChar=function(gk){return/\w/.test(gk)||gk>"\x80"&&(gk.toUpperCase()!=gk.toLowerCase()||bc.test(gk))};function cA(gk,gl){if(!gl){return fE(gk)}if(gl.source.indexOf("\\w")>-1&&fE(gk)){return true}return gl.test(gk)}function eV(gk){for(var gl in gk){if(gk.hasOwnProperty(gl)&&gk[gl]){return false}}return true}var eK=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function fq(gk){return gk.charCodeAt(0)>=768&&eK.test(gk)}function f4(gk,go,gn,gm){var gp=document.createElement(gk);if(gn){gp.className=gn}if(gm){gp.style.cssText=gm}if(typeof go=="string"){gp.appendChild(document.createTextNode(go))}else{if(go){for(var gl=0;gl<go.length;++gl){gp.appendChild(go[gl])}}}return gp}var cl;if(document.createRange){cl=function(gn,go,gl,gk){var gm=document.createRange();gm.setEnd(gk||gn,gl);gm.setStart(gn,go);return gm}}else{cl=function(gm,go,gk){var gl=document.body.createTextRange();try{gl.moveToElementText(gm.parentNode)}catch(gn){return gl}gl.collapse(true);gl.moveEnd("character",gk);gl.moveStart("character",go);return gl}}function d2(gl){for(var gk=gl.childNodes.length;gk>0;--gk){gl.removeChild(gl.firstChild)}return gl}function bR(gk,gl){return d2(gk).appendChild(gl)}var gc=H.contains=function(gk,gl){if(gl.nodeType==3){gl=gl.parentNode}if(gk.contains){return gk.contains(gl)}do{if(gl.nodeType==11){gl=gl.host}if(gl==gk){return true}}while(gl=gl.parentNode)};function dP(){var gk=document.activeElement;while(gk&&gk.root&&gk.root.activeElement){gk=gk.root.activeElement}return gk}if(dL&&k<11){dP=function(){try{return document.activeElement}catch(gk){return document.body}}}function S(gk){return new RegExp("(^|\\s)"+gk+"(?:$|\\s)\\s*")}var f=H.rmClass=function(gm,gk){var gn=gm.className;var gl=S(gk).exec(gn);if(gl){var go=gn.slice(gl.index+gl[0].length);gm.className=gn.slice(0,gl.index)+(go?gl[1]+go:"")}};var fB=H.addClass=function(gl,gk){var gm=gl.className;if(!S(gk).test(gm)){gl.className+=(gm?" ":"")+gk}};function fU(gm,gk){var gl=gm.split(" ");for(var gn=0;gn<gl.length;gn++){if(gl[gn]&&!S(gl[gn]).test(gk)){gk+=" "+gl[gn]}}return gk}function aA(gn){if(!document.body.getElementsByClassName){return}var gm=document.body.getElementsByClassName("CodeMirror");for(var gl=0;gl<gm.length;gl++){var gk=gm[gl].CodeMirror;if(gk){gn(gk)}}}var cC=false;function bj(){if(cC){return}fF();cC=true}function fF(){var gk;bX(window,"resize",function(){if(gk==null){gk=setTimeout(function(){gk=null;aA(aT)},100)}});bX(window,"blur",function(){aA(aV)})}var eM=function(){if(dL&&k<9){return false}var gk=f4("div");return"draggable" in gk||"dragDrop" in gk}();var fM;function bn(gk){if(fM==null){var gm=f4("span","\u200b");bR(gk,f4("span",[gm,document.createTextNode("x")]));if(gk.firstChild.offsetHeight!=0){fM=gm.offsetWidth<=1&&gm.offsetHeight>2&&!(dL&&k<8)}}var gl=fM?f4("span","\u200b"):f4("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");gl.setAttribute("cm-text","");return gl}var fL;function bO(gn){if(fL!=null){return fL}var gk=bR(gn,document.createTextNode("A\u062eA"));var gm=cl(gk,0,1).getBoundingClientRect();if(!gm||gm.left==gm.right){return false}var gl=cl(gk,1,2).getBoundingClientRect();return fL=(gl.right-gm.right<3)}var fT=H.splitLines="\n\nb".split(/\n/).length!=3?function(gp){var gq=0,gk=[],go=gp.length;while(gq<=go){var gn=gp.indexOf("\n",gq);if(gn==-1){gn=gp.length}var gm=gp.slice(gq,gp.charAt(gn-1)=="\r"?gn-1:gn);var gl=gm.indexOf("\r");if(gl!=-1){gk.push(gm.slice(0,gl));gq+=gl+1}else{gk.push(gm);gq=gn+1}}return gk}:function(gk){return gk.split(/\r\n?|\n/)};var bs=window.getSelection?function(gl){try{return gl.selectionStart!=gl.selectionEnd}catch(gk){return false}}:function(gm){try{var gk=gm.ownerDocument.selection.createRange()}catch(gl){}if(!gk||gk.parentElement()!=gm){return false}return gk.compareEndPoints("StartToEnd",gk)!=0};var da=(function(){var gk=f4("div");if("oncopy" in gk){return true}gk.setAttribute("oncopy","return;");return typeof gk.oncopy=="function"})();var e7=null;function aK(gl){if(e7!=null){return e7}var gm=bR(gl,f4("span","x"));var gn=gm.getBoundingClientRect();var gk=cl(gm,0,1).getBoundingClientRect();return e7=Math.abs(gn.left-gk.left)>1}var fh=H.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};(function(){for(var gk=0;gk<10;gk++){fh[gk+48]=fh[gk+96]=String(gk)}for(var gk=65;gk<=90;gk++){fh[gk]=String.fromCharCode(gk)}for(var gk=1;gk<=12;gk++){fh[gk+111]=fh[gk+63235]="F"+gk}})();function d5(gk,gq,gp,go){if(!gk){return go(gq,gp,"ltr")}var gn=false;for(var gm=0;gm<gk.length;++gm){var gl=gk[gm];if(gl.from<gp&&gl.to>gq||gq==gp&&gl.to==gq){go(Math.max(gl.from,gq),Math.min(gl.to,gp),gl.level==1?"rtl":"ltr");gn=true}}if(!gn){go(gq,gp,"ltr")}}function dz(gk){return gk.level%2?gk.to:gk.from}function gf(gk){return gk.level%2?gk.from:gk.to}function cE(gl){var gk=a(gl);return gk?dz(gk[0]):0}function cS(gl){var gk=a(gl);if(!gk){return gl.text.length}return gf(fH(gk))}function bt(gl,go){var gm=fg(gl.doc,go);var gp=x(gm);if(gp!=gm){go=bN(gp)}var gk=a(gp);var gn=!gk?0:gk[0].level%2?cS(gp):cE(gp);return W(go,gn)}function dQ(gm,gp){var gl,gn=fg(gm.doc,gp);while(gl=ex(gn)){gn=gl.find(1,true).line;gp=null}var gk=a(gn);var go=!gk?gn.text.length:gk[0].level%2?cE(gn):cS(gn);return W(gp==null?bN(gn):gp,go)}function dJ(gl,gq){var gp=bt(gl,gq.line);var gm=fg(gl.doc,gp.line);var gk=a(gm);if(!gk||gk[0].level==0){var go=Math.max(0,gm.text.search(/\S/));var gn=gq.line==gp.line&&gq.ch<=go&&gq.ch;return W(gp.line,gn?0:go)}return gp}function an(gl,gm,gk){var gn=gl[0].level;if(gm==gn){return true}if(gk==gn){return false}return gm<gk}var e3;function aG(gk,go){e3=null;for(var gl=0,gm;gl<gk.length;++gl){var gn=gk[gl];if(gn.from<go&&gn.to>go){return gl}if((gn.from==go||gn.to==go)){if(gm==null){gm=gl}else{if(an(gk,gn.level,gk[gm].level)){if(gn.from!=gn.to){e3=gm}return gl}else{if(gn.from!=gn.to){e3=gl}return gm}}}}return gm}function ff(gk,gn,gl,gm){if(!gm){return gn+gl}do{gn+=gl}while(gn>0&&fq(gk.text.charAt(gn)));return gn}function u(gk,gr,gm,gn){var go=a(gk);if(!go){return ai(gk,gr,gm,gn)}var gq=aG(go,gr),gl=go[gq];var gp=ff(gk,gr,gl.level%2?-gm:gm,gn);for(;;){if(gp>gl.from&&gp<gl.to){return gp}if(gp==gl.from||gp==gl.to){if(aG(go,gp)==gq){return gp}gl=go[gq+=gm];return(gm>0)==gl.level%2?gl.to:gl.from}else{gl=go[gq+=gm];if(!gl){return null}if((gm>0)==gl.level%2){gp=ff(gk,gl.to,-1,gn)}else{gp=ff(gk,gl.from,1,gn)}}}}function ai(gk,go,gl,gm){var gn=go+gl;if(gm){while(gn>0&&fq(gk.text.charAt(gn))){gn+=gl}}return gn<0||gn>gk.text.length?null:gn}var bh=(function(){var gq="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var go="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function gn(gu){if(gu<=247){return gq.charAt(gu)}else{if(1424<=gu&&gu<=1524){return"R"}else{if(1536<=gu&&gu<=1773){return go.charAt(gu-1536)}else{if(1774<=gu&&gu<=2220){return"r"}else{if(8192<=gu&&gu<=8203){return"w"}else{if(gu==8204){return"b"}else{return"L"}}}}}}}var gk=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var gt=/[stwN]/,gm=/[LRr]/,gl=/[Lb1n]/,gp=/[1n]/;var gs="L";function gr(gw,gv,gu){this.level=gw;this.from=gv;this.to=gu}return function(gE){if(!gk.test(gE)){return false}var gK=gE.length,gA=[];for(var gJ=0,gw;gJ<gK;++gJ){gA.push(gw=gn(gE.charCodeAt(gJ)))}for(var gJ=0,gD=gs;gJ<gK;++gJ){var gw=gA[gJ];if(gw=="m"){gA[gJ]=gD}else{gD=gw}}for(var gJ=0,gu=gs;gJ<gK;++gJ){var gw=gA[gJ];if(gw=="1"&&gu=="r"){gA[gJ]="n"}else{if(gm.test(gw)){gu=gw;if(gw=="r"){gA[gJ]="R"}}}}for(var gJ=1,gD=gA[0];gJ<gK-1;++gJ){var gw=gA[gJ];if(gw=="+"&&gD=="1"&&gA[gJ+1]=="1"){gA[gJ]="1"}else{if(gw==","&&gD==gA[gJ+1]&&(gD=="1"||gD=="n")){gA[gJ]=gD}}gD=gw}for(var gJ=0;gJ<gK;++gJ){var gw=gA[gJ];if(gw==","){gA[gJ]="N"}else{if(gw=="%"){for(var gx=gJ+1;gx<gK&&gA[gx]=="%";++gx){}var gL=(gJ&&gA[gJ-1]=="!")||(gx<gK&&gA[gx]=="1")?"1":"N";for(var gH=gJ;gH<gx;++gH){gA[gH]=gL}gJ=gx-1}}}for(var gJ=0,gu=gs;gJ<gK;++gJ){var gw=gA[gJ];if(gu=="L"&&gw=="1"){gA[gJ]="L"}else{if(gm.test(gw)){gu=gw}}}for(var gJ=0;gJ<gK;++gJ){if(gt.test(gA[gJ])){for(var gx=gJ+1;gx<gK&&gt.test(gA[gx]);++gx){}var gB=(gJ?gA[gJ-1]:gs)=="L";var gv=(gx<gK?gA[gx]:gs)=="L";var gL=gB||gv?"L":"R";for(var gH=gJ;gH<gx;++gH){gA[gH]=gL}gJ=gx-1}}var gI=[],gF;for(var gJ=0;gJ<gK;){if(gl.test(gA[gJ])){var gy=gJ;for(++gJ;gJ<gK&&gl.test(gA[gJ]);++gJ){}gI.push(new gr(0,gy,gJ))}else{var gz=gJ,gC=gI.length;for(++gJ;gJ<gK&&gA[gJ]!="L";++gJ){}for(var gH=gz;gH<gJ;){if(gp.test(gA[gH])){if(gz<gH){gI.splice(gC,0,new gr(1,gz,gH))}var gG=gH;for(++gH;gH<gJ&&gp.test(gA[gH]);++gH){}gI.splice(gC,0,new gr(2,gG,gH));gz=gH}else{++gH}}if(gz<gJ){gI.splice(gC,0,new gr(1,gz,gJ))}}}if(gI[0].level==1&&(gF=gE.match(/^\s+/))){gI[0].from=gF[0].length;gI.unshift(new gr(0,0,gF[0].length))}if(fH(gI).level==1&&(gF=gE.match(/\s+$/))){fH(gI).to-=gF[0].length;gI.push(new gr(0,gK-gF[0].length,gK))}if(gI[0].level==2){gI.unshift(new gr(1,gI[0].to,gI[0].to))}if(gI[0].level!=fH(gI).level){gI.push(new gr(gI[0].level,gK,gK))}return gI}})();H.version="5.7.0";return H});